(window["webpackJsonp_dubhe_web"]=window["webpackJsonp_dubhe_web"]||[]).push([["dataset-classification-components-EditLabels","dataset-classification-components-Actions","dataset-classification-components-Labels"],{"0f17":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("label",{staticClass:"el-form-item__label no-float tl"},[e._v("已选标签")]),e._v(" "),n("InfoTable",{attrs:{columns:e.columns,dataSource:e.editableLabels,showPagination:!1,tableAttrs:{maxHeight:"350px"}}})],1)},r=[],o=n("ed09"),l=n("2ef0"),i=n("3da5"),c=n("ed35"),u=n("c3f2"),s=n("4b4f");function d(e,t){return m(e)||b(e,t)||p(e,t)||f()}function f(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,l,i=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);c=!0);}catch(s){u=!0,r=s}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw r}}return i}}function m(e){if(Array.isArray(e))return e}function v(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=p(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw o}}}}function p(e,t){if(e){if("string"===typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var h=Object(o["c"])({name:"EditLabels",components:{InfoTable:c["a"]},props:{selectedItems:{type:Array,default:function(){return[]}},categoryId2Name:{type:Object,default:function(){return{}}},labelList:{type:Array,default:function(){return[]}}},setup:function(e,t){var n=Object(o["e"])(i["templateTypeSymbol"]),a=Object(o["o"])(new Map),r=Object(o["o"])(Math.random()),c=Object(o["o"])(null),f=function(t){var n;return null===(n=e.categoryId2Name[t.category_id])||void 0===n?void 0:n.name},b=Object(o["a"])((function(){return"multiple-label"===n.value})),m=Object(o["a"])((function(){var e,t=[],n=v(a.value.entries());try{for(n.s();!(e=n.n()).done;){var r=d(e.value,2),o=r[0],l=r[1],i=l.annotations,c=void 0===i?[]:i,u=l.items;t.push({id:o,count:c.length,itemIds:u.map((function(e){return e.id})),label:f(c[0])})}}catch(s){n.e(s)}finally{n.f()}return t})),p=function(e){c.value=e.id},y=function(){c.value=null},h=function(e,n){t.emit("updateLabels",e,n.id)},w=function(e){t.emit("removeLabels",e.id)},g=[{prop:"label",label:"标签名称",width:"100px",render:function(t,n){var a=t.row;return[Object(o["d"])(s["default"],{props:{row:a,actions:n,labelList:e.labelList,editId:c.value,mode:c.value&&c.value===a.id?"edit":"view"},on:{change:h}})]}},{prop:"count",label:"数量"},{label:"操作",align:"left",render:function(e,t){var n=e.row;return[Object(o["d"])(u["default"],{props:{row:n,actions:t,mode:c.value&&c.value===n.id?"edit":"view"},on:{edit:p,delete:w,reset:y}})]}}];return Object(o["r"])((function(){return Object(l["cloneDeep"])(e.selectedItems)}),(function(e){try{a.value=new Map,e.forEach((function(e){var t,n=JSON.parse(e.annotation),o=b.value?n:n.slice(0,1),l=v(o);try{for(l.s();!(t=l.n()).done;){var i=t.value;a.value.has(i.category_id)?a.value.set(i.category_id,{annotations:a.value.get(i.category_id).annotations.concat(i),items:a.value.get(i.category_id).items.concat(e)}):a.value.set(i.category_id,{annotations:[i],items:[e]})}}catch(c){l.e(c)}finally{l.f()}r.value=Math.random()}))}catch(t){a.value=new Map}}),{immediate:!0}),{updateLabelMapKey:r,columns:g,labelMap:a,editableLabels:m}}}),w=h,g=n("2877"),O=Object(g["a"])(w,a,r,!1,null,null,null);t["default"]=O.exports},"4b4f":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",["edit"===e.mode?n("InfoSelect",{staticClass:"labelSelect",attrs:{dataSource:e.labelList,labelKey:"name",valueKey:"id",placeholder:"请选择标签",value:e.row.id,clearable:!1},on:{change:e.handleChange}}):n("span",[e._v(e._s(e.row.label))])],1)},r=[],o=n("ed09"),l=n("ba8f"),i={name:"LabelName",components:{InfoSelect:l["a"]},props:{row:{type:Object,default:function(){return{}}},labelList:{type:Array,default:function(){return[]}},editId:Number,mode:String},setup:function(e,t){var n=Object(o["a"])((function(){return t.attrs})),a=function(n){t.emit("change",n,e.row)};return{attrs:n,handleChange:a}}},c=i,u=n("2877"),s=Object(u["a"])(c,a,r,!1,null,null,null);t["default"]=s.exports},c3f2:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("i",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.onClickOutside,expression:"onClickOutside"}],staticClass:"el-icon-edit cp mr-4",on:{click:function(t){return e.$emit("edit",e.row)}}}),e._v(" "),n("el-popconfirm",{attrs:{title:"确认移除当前标签，不可恢复"},on:{onConfirm:function(t){return e.$emit("delete",e.row)}}},[n("i",{staticClass:"el-icon-delete cp",attrs:{slot:"reference"},slot:"reference"})])],1)},r=[],o=n("c28b"),l=n.n(o),i={name:"EditLabelAction",directives:{clickOutside:l.a.directive},props:{row:Object,mode:String},setup:function(e,t){var n=function(n){n.target.closest(".labelSelect")||"edit"!==e.mode||t.emit("reset")};return{onClickOutside:n}}},c=i,u=n("2877"),s=Object(u["a"])(c,a,r,!1,null,null,null);t["default"]=s.exports}}]);