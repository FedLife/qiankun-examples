(window["webpackJsonp_dubhe_web"]=window["webpackJsonp_dubhe_web"]||[]).push([["system-resources","system-resources-utils"],{"060c":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("ProTable",{ref:"proTableRef",attrs:{"create-title":"创建资源规格",columns:e.columns,"form-items":e.queryFormItems,"list-request":e.list},on:{add:e.doAdd},scopedSlots:e._u([{key:"header-memNum",fn:function(){return[r("span",[e._v("内存容量")]),e._v(" "),r("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[r("div",{attrs:{slot:"content"},slot:"content"},[e._v("内存容量/工作空间单位换算: 1Mi = 1024 x 1024B")]),e._v(" "),r("i",{staticClass:"el-icon-question"})])]},proxy:!0}])}),e._v(" "),r("BaseModal",{attrs:{visible:e.formVisible,title:e.formTitle,loading:e.formSubmitting,width:"700px"},on:{"update:visible":function(t){e.formVisible=t},cancel:function(t){e.formVisible=!1},ok:e.onFormConfirm,close:e.onFormClose}},[r("el-form",{ref:"formRef",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"规格名称",prop:"specsName"}},[r("el-input",{staticClass:"w-200",attrs:{placeholder:"请输入规格名称",maxlength:"32","show-word-limit":""},model:{value:e.form.specsName,callback:function(t){e.$set(e.form,"specsName",t)},expression:"form.specsName"}})],1),e._v(" "),r("el-form-item",{ref:"moduleRef",attrs:{label:"业务场景",prop:"module"}},[r("InfoSelect",{attrs:{width:"200px",placeholder:"请选择业务场景",dataSource:e.moduleList,disabled:"edit"===e.formType,"value-key":"value","label-key":"label"},on:{change:e.onModuleChange},model:{value:e.form.module,callback:function(t){e.$set(e.form,"module",t)},expression:"form.module"}})],1),e._v(" "),r("el-divider"),e._v(" "),r("el-form-item",{staticClass:"dib",attrs:{label:"CPU数量",prop:"cpuNum"}},[r("el-input",{staticClass:"w-200",attrs:{placeholder:"请输入CPU数量"},model:{value:e.form.cpuNum,callback:function(t){e.$set(e.form,"cpuNum",e._n(t))},expression:"form.cpuNum"}},[r("template",{slot:"append"},[e._v("核")])],2)],1),e._v(" "),r("el-form-item",{staticClass:"dib",attrs:{label:"GPU数量",prop:"gpuNum"}},[r("el-input",{staticClass:"w-200",attrs:{placeholder:"请输入GPU数量"},model:{value:e.form.gpuNum,callback:function(t){e.$set(e.form,"gpuNum",e._n(t))},expression:"form.gpuNum"}},[r("template",{slot:"append"},[e._v("核")])],2)],1),e._v(" "),r("el-form-item",{staticClass:"dib",attrs:{label:"内存",prop:"memNum"}},[r("el-input",{staticClass:"w-200",attrs:{placeholder:"请输入内存大小"},model:{value:e.form.memNum,callback:function(t){e.$set(e.form,"memNum",e._n(t))},expression:"form.memNum"}},[r("template",{slot:"append"},[e._v("Mi")])],2)],1),e._v(" "),r("el-form-item",{staticClass:"dib",attrs:{label:"工作空间",prop:"workspaceRequest"}},[r("el-input",{staticClass:"w-200",attrs:{placeholder:"请输入存储配额"},model:{value:e.form.workspaceRequest,callback:function(t){e.$set(e.form,"workspaceRequest",e._n(t))},expression:"form.workspaceRequest"}},[r("template",{slot:"append"},[e._v("Mi")])],2)],1)],1),e._v(" "),r("el-alert",{attrs:{title:"1Mi = 1024 x 1024B",type:"warning","show-icon":"",closable:!1}})],1)],1)},n=[],u=r("ed09"),a=r("5c96"),l=r("f092"),s=r("f109"),i=r("ba8f"),c=r("0c61"),m=r("a218");function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){b(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t,r){return t=g(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g(e){var t=v(e,"string");return"symbol"===p(t)?t:String(t)}function v(e,t){if("object"!==p(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==p(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var y={id:void 0,specsName:null,module:2,cpuNum:null,gpuNum:null,memNum:null,workspaceRequest:null},w={name:"AuthCode",components:{ProTable:l["a"],BaseModal:s["a"],InfoSelect:i["a"]},setup:function(){var e=Object(u["n"])({formVisible:!1,formSubmitting:!1,formType:"add"}),t=Object(u["n"])(d({},y)),r=Object(u["o"])(null),o=Object(u["o"])(null),n=Object(u["o"])(null),l=Object(u["a"])((function(){switch(e.formType){case"edit":return"编辑资源规格";case"add":default:return"创建资源规格"}})),s=Object(u["a"])((function(){return Object.keys(m["moduleMap"]).map((function(e){return{label:m["moduleMap"][e],value:+e}}))})),i=function(){o.value.validate((function(o){if(o){var n,u;switch(e.formSubmitting=!0,e.formType){case"edit":n=c["c"],u="修改";break;case"add":default:n=c["a"],u="创建"}n(t).then((function(){a["Message"].success("".concat(u,"资源成功")),e.formVisible=!1,r.value.query()})).finally((function(){e.formSubmitting=!1}))}}))},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(t).forEach((function(r){t[r]=void 0!==e[r]?e[r]:y[r]}))},f=function(){p(),o.value.clearValidate()},b=function(){e.formType="add",e.formVisible=!0,p()},g=function(t){e.formType="edit",e.formVisible=!0,p(t)},v=function(e){var t=e.id;a["MessageBox"].confirm("此操作将删除该资源","请确认").then((function(){Object(c["b"])([t]).then((function(){a["Message"].success("删除成功"),r.value.refresh()}))}))},w=function(){n.value.validate("manual")},h=Object(u["a"])((function(){return Object(m["getColumns"])({doEdit:g,doDelete:v})}));return d(d({},Object(u["q"])(e)),{},{form:t,rules:m["rules"],proTableRef:r,formRef:o,moduleRef:n,columns:h,queryFormItems:m["queryFormItems"],doAdd:b,formTitle:l,list:c["d"],moduleList:s,onModuleChange:w,onFormConfirm:i,onFormClose:f})}},h=w,O=r("2877"),N=Object(O["a"])(h,o,n,!1,null,null,null);t["default"]=N.exports},"0c61":function(e,t,r){"use strict";r.d(t,"d",(function(){return u})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return s}));var o=r("b775"),n=r("f121");function u(e){return Object(o["a"])({url:"/".concat(n["a"].ADMIN,"/resourceSpecs"),method:"get",params:e})}function a(e){return Object(o["a"])({url:"/".concat(n["a"].ADMIN,"/resourceSpecs"),method:"post",data:e})}function l(e){return Object(o["a"])({url:"/".concat(n["a"].ADMIN,"/resourceSpecs"),method:"delete",data:{ids:e}})}function s(e){return Object(o["a"])({url:"/".concat(n["a"].ADMIN,"/resourceSpecs"),method:"put",data:e})}},a218:function(e,t,r){"use strict";r.r(t),r.d(t,"moduleMap",(function(){return o})),r.d(t,"queryFormItems",(function(){return l})),r.d(t,"getColumns",(function(){return s})),r.d(t,"rules",(function(){return i}));var o={1:"notebook",2:"train",3:"serving",4:"tadl",5:"pointCloud",6:"dataAnnotation",7:"atlas"},n={0:"CPU",1:"GPU"},u=function(e){var t=Object.keys(e).map((function(t){return{label:e[t],value:t}}));return t.unshift({label:"全部",value:null}),t};function a(e,t,r){""===t||null==t?r():/^[^\s]+.*[^\s]+$/.test(t)||/^[^\s]$/.test(t)?/^[\u4E00-\u9FA5A-Za-z0-9_-\s]+$/.test(t)?r():r(new Error("仅支持字母、数字、汉字、空格、英文横杠和下划线")):r(new Error("首尾不能是空格"))}var l=[{prop:"specsName",placeholder:"请输入资源名称",class:"w-300",change:"query"},{type:"button",btnText:"重置",func:"resetQuery"},{type:"button",btnText:"搜索",btnType:"primary",func:"query"}];function s(e){var t=e.doEdit,r=e.doDelete;return[{label:"ID",prop:"id",width:80,sortable:"custom"},{label:"规格名称",prop:"specsName"},{label:"CPU数量",prop:"cpuNum",formatter:function(e){return"".concat(e,"核")}},{label:"GPU数量",prop:"gpuNum",formatter:function(e){return"".concat(e,"核")}},{label:"内存容量",prop:"memNum",formatter:function(e){return"".concat(e,"Mi")}},{label:"工作空间",prop:"workspaceRequest",formatter:function(e){return"".concat(e,"Mi")}},{label:"业务场景",prop:"module",formatter:function(e){return o[e]},dropdownList:u(o)},{label:"规格类型",prop:"resourcesPoolType",formatter:function(e){return n[Number(e)]},dropdownList:u(n)},{label:"操作",type:"operation",operations:[{label:"编辑",func:t},{label:"删除",func:r}]}]}var i={specsName:[{required:!0,message:"请输入规格名称",trigger:"blur"},{validator:a,trigger:["blur","change"]}],module:[{required:!0,message:"请选择业务场景",trigger:"manual"}],cpuNum:[{required:!0,message:"请输入CPU数量",trigger:"blur"},{pattern:/^[+]{0,1}(\d+)$/,message:"数量不能小于0",trigger:"blur"},{type:"number",message:"所填必须为数字"}],gpuNum:[{required:!0,message:"请输入GPU数量",trigger:"blur"},{pattern:/^[+]{0,1}(\d+)$/,message:"数量不能小于0",trigger:"blur"},{type:"number",message:"所填必须为数字"}],memNum:[{required:!0,message:"请输入内存大小",trigger:"blur"},{pattern:/^[+]{0,1}(\d+)$/,message:"内存大小不能小于0",trigger:"blur"},{type:"number",message:"所填必须为数字"}],workspaceRequest:[{required:!0,message:"请定义工作空间的存储配额",trigger:"blur"},{pattern:/^[+]{0,1}(\d+)$/,message:"存储配额不能小于0",trigger:"blur"},{type:"number",message:"所填必须为数字"}]}}}]);