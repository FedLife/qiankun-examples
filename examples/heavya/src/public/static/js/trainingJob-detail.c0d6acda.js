(window["webpackJsonp_dubhe_web"]=window["webpackJsonp_dubhe_web"]||[]).push([["trainingJob-detail","trainingJob~trainingJob-components-jobDrawer~trainingJob-jobParam","development-utils","trainingJob-components-jobDetail","trainingJob-components-jobDrawer"],{"0903":function(t,e,r){"use strict";r.d(e,"e",(function(){return a})),r.d(e,"g",(function(){return i})),r.d(e,"j",(function(){return s})),r.d(e,"f",(function(){return u})),r.d(e,"a",(function(){return l})),r.d(e,"k",(function(){return d})),r.d(e,"n",(function(){return f})),r.d(e,"d",(function(){return p})),r.d(e,"b",(function(){return m})),r.d(e,"m",(function(){return v})),r.d(e,"h",(function(){return g})),r.d(e,"l",(function(){return b})),r.d(e,"i",(function(){return y}));var n=r("b775"),o=r("f121");function a(t){return Object(n["a"])({url:"/".concat(o["a"].DCM,"/datasets/medical/detail/").concat(t),method:"get"})}var i=function(t){return Object(n["a"])({url:"/".concat(o["a"].DCM,"/datasets/medical/getAuto/").concat(t),method:"get"})},s=function(t){return Object(n["a"])({url:"/".concat(o["a"].DCM,"/datasets/medical/getFinished/").concat(t),method:"get"})};function c(t){return Object(n["a"])({url:"/".concat(o["a"].DCM,"/datasets/medical"),method:"get",params:t})}function u(t){return Object(n["a"])({url:"/".concat(o["a"].DCM,"/datasets/medical/list"),method:"get",params:t})}function l(t){return Object(n["a"])({url:"/".concat(o["a"].DCM,"/datasets/medical"),method:"post",data:t})}function d(t){return Object(n["a"])({url:"/".concat(o["a"].DCM,"/datasets/medical/annotation/save"),method:"post",data:t})}function f(t,e){return Object(n["a"])({url:"/".concat(o["a"].DCM,"/datasets/medical/files"),method:"post",data:{id:t,dataMedicineFileCreateList:e}})}function h(t){var e={ids:t};return Object(n["a"])({url:"/".concat(o["a"].DCM,"/datasets/medical"),method:"delete",data:e})}function p(t){return Object(n["a"])({url:"/".concat(o["a"].DCM,"/datasets/medical/").concat(t.medicalId),method:"put",data:t})}function m(t,e){return Object(n["a"])({url:"/".concat(o["a"].DCM,"/datasets/medical/annotation/auto"),method:"post",data:{medicalId:t.id,modelServiceId:e.modelServiceId,fileStatus:e.fileStatus}})}function v(t){return Object(n["a"])({url:"/".concat(o["a"].DCM,"/datasets/medical/task/").concat(t,"/stop"),method:"put"})}function g(t){return Object(n["a"])({url:"/".concat(o["a"].DCM,"/datasets/medical/annotation/schedule"),method:"get",params:t})}function b(t,e){return Object(n["a"])({url:"/".concat(o["a"].DCM,"/datasets/medical/lesion/").concat(t),method:"post",data:e})}function y(t,e){return Object(n["a"])({url:"/".concat(o["a"].DCM,"/datasets/medical/lesion/").concat(t),method:"get",params:e})}e["c"]={list:c,add:l,del:h}},"0be6":function(t,e,r){"use strict";r.d(e,"f",(function(){return a})),r.d(e,"a",(function(){return i})),r.d(e,"d",(function(){return c})),r.d(e,"b",(function(){return u})),r.d(e,"e",(function(){return l}));var n=r("b775"),o=r("f121");function a(t){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelBranch"),method:"get",params:t})}function i(t){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelBranch"),method:"post",data:t})}function s(t){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelBranch"),method:"put",data:t})}function c(t){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelBranch"),method:"delete",data:t})}function u(t){return Object(n["a"])({url:"".concat(o["a"].MODEL,"/ptModelBranch/convertPreset"),method:"post",data:t})}function l(t){return Object(n["a"])({url:"".concat(o["a"].MODEL,"/ptModelBranch/convertOnnx"),method:"post",data:{id:t}})}e["c"]={list:a,add:i,edit:s,del:c}},"0c61":function(t,e,r){"use strict";r.d(e,"d",(function(){return a})),r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return s})),r.d(e,"c",(function(){return c}));var n=r("b775"),o=r("f121");function a(t){return Object(n["a"])({url:"/".concat(o["a"].ADMIN,"/resourceSpecs"),method:"get",params:t})}function i(t){return Object(n["a"])({url:"/".concat(o["a"].ADMIN,"/resourceSpecs"),method:"post",data:t})}function s(t){return Object(n["a"])({url:"/".concat(o["a"].ADMIN,"/resourceSpecs"),method:"delete",data:{ids:t}})}function c(t){return Object(n["a"])({url:"/".concat(o["a"].ADMIN,"/resourceSpecs"),method:"put",data:t})}},"12c9":function(t,e,r){},15407:function(t,e,r){},"1afb":function(t,e,r){"use strict";r.d(e,"b",(function(){return a})),r.d(e,"a",(function(){return i}));var n=r("b775"),o=r("f121");function a(t){return Object(n["a"])({url:"/".concat(o["a"].ALGORITHM,"/algorithmUsage"),method:"get",params:t})}function i(t){return Object(n["a"])({url:"/".concat(o["a"].ALGORITHM,"/algorithmUsage"),method:"post",data:t})}},"1cb5":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-container"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.resumeLoading,expression:"resumeLoading"}],ref:"table",attrs:{data:t.tableList,"highlight-current-row":""},on:{"sort-change":t.handleSortChange,"row-click":t.onRowClick}},[r("el-table-column",{attrs:{prop:"trainVersion",label:"版本",sortable:"custom"}}),t._v(" "),r("el-table-column",{attrs:{prop:"runtime",label:"训练时长",sortable:"custom"}}),t._v(" "),r("el-table-column",{attrs:{prop:"trainStatus",label:"状态"},scopedSlots:t._u([{key:"header",fn:function(){return[r("DropdownHeader",{attrs:{title:"状态",list:t.jobStatusList},on:{command:function(e){return t.filter("trainStatus",e)}}})]},proxy:!0},{key:"default",fn:function(e){return[r("el-tag",{attrs:{type:t.statusTagMap[e.row.trainStatus],effect:"plain"}},[t._v(t._s(t.statusNameMap[e.row.trainStatus]||"--"))]),t._v(" "),r("msg-popover",{attrs:{"status-detail":e.row.statusDetail,show:t.showPopover(e.row.trainStatus),"empty-text":t.messageText(e.row.trainStatus)}})]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"createTime",label:"创建时间",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",[t._v(t._s(t.parseTime(e.row.createTime)))])]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"操作",width:"300px",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return["running"===t.statusFlagMap[e.row.trainStatus]?r("el-button",{attrs:{id:"doStop_"+e.$index,type:"text"},on:{click:function(r){return r.stopPropagation(),t.doStop(e.row.id)}}},[t._v("停止")]):t._e(),t._v(" "),"done"===t.statusFlagMap[e.row.trainStatus]?r("el-button",{attrs:{id:"goEdit_"+e.$index,type:"text"},on:{click:function(r){return r.stopPropagation(),t.goEdit(e.row,"edit")}}},[t._v("修改")]):t._e(),t._v(" "),r("el-button",{attrs:{id:"showLog_"+e.$index,type:"text"},on:{click:function(r){return r.stopPropagation(),t.onShowLog(e.row)}}},[t._v("运行日志")]),t._v(" "),r("el-button",{directives:[{name:"show",rawName:"v-show",value:4!==e.row.trainStatus,expression:"scope.row.trainStatus !== 4"}],attrs:{id:"goSaveModel_"+e.$index,disabled:!e.row.modelPath,type:"text"},on:{click:function(r){return r.stopPropagation(),t.goSaveModel(e.row)}}},[t._v("保存模型")]),t._v(" "),r("el-button",{directives:[{name:"show",rawName:"v-show",value:4===e.row.trainStatus,expression:"scope.row.trainStatus === 4"}],attrs:{id:"doResume_"+e.$index,disabled:!e.row.modelPath,type:"text"},on:{click:function(r){return r.stopPropagation(),t.doResume(e.row)}}},[t._v("断点续训")]),t._v(" "),r("el-dropdown",[r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text"},on:{click:function(t){t.stopPropagation()}}},[t._v("\n            更多"),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{attrs:{id:"goVisual_"+e.$index,disabled:!e.row.visualizedLogPath},nativeOn:{click:function(r){return t.goVisual(e.row)}}},[r("el-button",{attrs:{disabled:!e.row.visualizedLogPath,type:"text"}},[t._v("可视化 "),r("IconFont",{attrs:{type:"externallink"}})],1)],1),t._v(" "),r("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:4===e.row.trainStatus,expression:"scope.row.trainStatus === 4"}],attrs:{id:"goSaveModel_inside_"+e.$index,disabled:!e.row.modelPath},nativeOn:{click:function(r){return t.goSaveModel(e.row)}}},[r("el-button",{attrs:{disabled:!e.row.modelPath,type:"text"}},[t._v("保存模型")])],1),t._v(" "),r("el-dropdown-item",{attrs:{id:"goEditParams_"+e.$index,disabled:"done"!==t.statusFlagMap[e.row.trainStatus]},nativeOn:{click:function(r){return t.goEdit(e.row,"saveParams")}}},[[t.TRAINING_TYPE_ENUM.ATLAS,t.TRAINING_TYPE_ENUM.DDRL].includes(e.row.trainType)?t._e():r("el-button",{attrs:{disabled:"done"!==t.statusFlagMap[e.row.trainStatus],type:"text"}},[t._v("保存任务模板")])],1),t._v(" "),r("el-dropdown-item",{attrs:{id:"doDelete_"+e.$index,disabled:"done"!==t.statusFlagMap[e.row.trainStatus]},nativeOn:{click:function(r){return t.doDelete(e.row.id)}}},[r("el-button",{attrs:{disabled:"done"!==t.statusFlagMap[e.row.trainStatus],type:"text"}},[t._v("删除")])],1)],1)],1)]}}])})],1),t._v(" "),r("BaseModal",{attrs:{visible:t.showDialog,title:t.dialogTitle,okText:["edit","learningEdit"].includes(t.dialogType)?"开始训练":"保存",loading:t.submitLoading,width:"50%"},on:{"update:visible":function(e){t.showDialog=e},cancel:function(e){t.showDialog=!1},ok:t.doEdit}},[t.reFresh&&!t.isAtlas?r("job-form",{ref:"jobFormEdit",attrs:{"width-percent":100,type:t.dialogType},on:{getForm:t.getForm}}):t._e(),t._v(" "),t.reFresh&&t.isAtlas?r("job-form-atlas",{ref:"jobFormAtlasEdit",attrs:{"width-percent":100,type:t.dialogType},on:{getForm:t.getForm}}):t._e()],1),t._v(" "),r("save-model-dialog",{ref:"saveModel",attrs:{type:"training"}}),t._v(" "),r("path-select-dialog",{ref:"pathSelect",attrs:{"class-key":"keepTrainDialog",type:t.pathType},on:{chooseDone:t.chooseDone,chooseModel:t.chooseModel}}),t._v(" "),r("log-dialog",{ref:"logDialog"}),t._v(" "),r("el-drawer",{attrs:{visible:t.drawerVisible,"with-header":!1,direction:"rtl",size:"50%"},on:{"update:visible":function(e){t.drawerVisible=e},close:t.handleDrawerClose}},[r("job-drawer",{ref:"jobDrawer",on:{"show-log":t.onShowLog}})],1)],1)},o=[],a=r("2f62"),i=r("9619"),s=r("c6db"),c=r("ed08"),u=r("cce0"),l=r("eddc"),d=r("f109"),f=r("ea0c"),h=r("9532"),p=r("e6ed"),m=r("4d99"),v=r("aaa4"),g=r("b788"),b=r("79ab"),y=r("79a8"),_=r("03b8");function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function O(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */O=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(P){c=function(t,e,r){return t[e]=r}}function u(t,e,r,o){var a=e&&e.prototype instanceof f?e:f,i=Object.create(a.prototype),s=new j(o||[]);return n(i,"_invoke",{value:L(t,r,s)}),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(P){return{type:"throw",arg:P}}}t.wrap=u;var d={};function f(){}function h(){}function p(){}var m={};c(m,a,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(T([])));g&&g!==e&&r.call(g,a)&&(m=g);var b=p.prototype=f.prototype=Object.create(m);function y(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function o(n,a,i,s){var c=l(t[n],t,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==w(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){o("next",t,i,s)}),(function(t){o("throw",t,i,s)})):e.resolve(d).then((function(t){u.value=t,i(u)}),(function(t){return o("throw",t,i,s)}))}s(c.arg)}var a;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return a=a?a.then(n,n):n()}})}function L(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return E()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var s=N(i,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=l(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function N(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,N(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function T(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:E}}function E(){return{value:void 0,done:!0}}return h.prototype=p,n(b,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:h,configurable:!0}),h.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},y(_.prototype),c(_.prototype,i,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new _(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},y(b),c(b,s,"Generator"),c(b,a,(function(){return this})),c(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=T,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:T(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},t}function L(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(u){return void r(u)}s.done?e(c):Promise.resolve(c).then(n,o)}function N(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){L(a,n,o,i,s,"next",t)}function s(t){L(a,n,o,i,s,"throw",t)}i(void 0)}))}}function x(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function S(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?x(Object(r),!0).forEach((function(e){j(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function j(t,e,r){return e=T(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T(t){var e=E(t,"string");return"symbol"===w(e)?e:String(e)}function E(t,e){if("object"!==w(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var P={name:"JobDetail",components:{BaseModal:d["a"],JobForm:f["a"],JobFormAtlas:h["a"],jobDrawer:b["default"],SaveModelDialog:m["a"],pathSelectDialog:g["default"],LogDialog:y["default"],MsgPopover:p["a"],DropdownHeader:v["a"]},cruds:function(){return Object(s["b"])({crudMethod:S({},u["c"]),optShow:{add:!1,edit:!1,del:!1},queryOnPresenterCreated:!1})},mixins:[Object(s["f"])(),Object(s["d"])(),Object(s["a"])()],data:function(){return{id:null,tableList:[],params:{},pathType:"",keepPool:!0,showDialog:!1,dialogTitle:"",dialogType:"edit",drawerVisible:!1,reFresh:!0,modelList:[],submitLoading:!1,resumeLoading:!1,rules:{parentId:[{required:!0,message:"请选择模型",trigger:"blur"}]},selectedTrain:{},statusNameMap:Object(c["S"])(_["TRAINING_STATUS_MAP"],"name"),statusTagMap:Object(c["S"])(_["TRAINING_STATUS_MAP"],"tagMap"),statusFlagMap:Object(c["S"])(_["TRAINING_STATUS_MAP"],"statusMap"),isAtlas:!1,TRAINING_TYPE_ENUM:_["TRAINING_TYPE_ENUM"]}},beforeRouteEnter:function(t,e,r){t.query.id?r():r("/training/job")},computed:S(S({},Object(a["d"])(["user"])),{},{jobStatusList:function(){var t=this,e=[{label:"全部",value:null}];return Object.keys(this.statusNameMap).forEach((function(r){e.push({label:t.statusNameMap[r],value:r})})),e}}),mounted:function(){this.id=this.$route.query.id,this.refetch=Object(i["debounce"])(1e3,this.getJobList),this.getJobList(),c["J"].on("jumpToTrainingDetail",this.onJumpIn)},beforeDestroy:function(){this.keepPool=!1,c["J"].off("jumpToTrainingDetail",this.onJumpIn)},methods:{onRowClick:function(t){var e=this;this.drawerVisible=!0,this.$nextTick((function(){e.$refs.jobDrawer.onOpen(t.id)}))},onShowLog:function(){var t=N(O().mark((function t(e){return O().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.k8sNamespace){t.next=4;break}this.selectedTrain=e,t.next=6;break;case 4:return t.next=6,this.getJobDetail(e.id);case 6:this.$refs.logDialog.show(this.selectedTrain);case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),handleSortChange:function(t){var e=t.prop,r=t.order,n={sort:r?e:void 0,order:r?c["f"].tableSortMap[r]:void 0};this.params=Object.assign(this.params,n),this.getJobList()},handleDrawerClose:function(){this.$refs.jobDrawer.onClose()},getJobList:function(){var t=N(O().mark((function t(){var e,r,n=this;return O().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=S({trainId:this.id},this.params),t.next=3,Object(u["h"])(e);case 3:r=t.sent,this.tableList=r,this.keepPool&&this.tableList.some((function(t){return 0===t.trainStatus||1===t.trainStatus}))&&setTimeout((function(){n.refetch()}),1e3);case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),refreshList:function(){this.params={},this.getJobList()},getForm:function(){var t=N(O().mark((function t(e){var r=this;return O().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.submitLoading=!0,!["edit","learningEdit"].includes(this.dialogType)){t.next=8;break}return t.next=4,Object(u["e"])(e).finally((function(){r.submitLoading=!1}));case 4:this.refreshList(),this.$message({message:"任务修改成功",type:"success"}),t.next=11;break;case 8:return t.next=10,Object(l["a"])(e).finally((function(){r.submitLoading=!1}));case 10:this.$message({message:"任务模板保存成功",type:"success"});case 11:this.showDialog=!1;case 12:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),filter:function(t,e){this.params[t]=e||void 0,this.getJobList()},goEdit:function(t,e){var r=this;this.reFresh=!1,this.$nextTick((function(){"saveParams"===e&&(t.paramName=t.jobName),r.showDialog=!0,t.trainType===_["TRAINING_TYPE_ENUM"].ATLAS?(r.$nextTick((function(){r.$refs.jobFormAtlasEdit.initForm(t)})),r.isAtlas=!0):t.trainType===_["TRAINING_TYPE_ENUM"].DDRL?("saveParams"!==e&&(e="learningEdit"),r.$nextTick((function(){r.$refs.jobFormEdit.initForm(t)}))):(r.$nextTick((function(){r.$refs.jobFormEdit.initForm(t)})),r.isAtlas=!1),r.dialogTitle=["edit","learningEdit"].includes(e)?"修改任务":"保存任务模板",r.dialogType=e,r.reFresh=!0}))},goVisual:function(t){var e={id:t.createUserId,trainJobName:t.jobName},r=this.$router.resolve({name:"VISUAL",params:e}),n=r.href,o="".concat(n,"?id=").concat(e.id,"&trainJobName=").concat(e.trainJobName);window.open(o,"_blank")},goSaveModel:function(){var t=N(O().mark((function t(e){var r,n=this;return O().wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.pathType="modelSelect",r={algorithmId:e.algorithmId,algorithmName:e.algorithmName,algorithmSource:e.algorithmSource,modelClassName:e.algorithmUsage,modelAddress:e.modelPath},this.getJobDetail(e.id),this.$nextTick((function(){n.$refs.pathSelect.show({resumePath:"".concat(e.modelPath,"/"),id:e.algorithmId,params:r})}));case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),doEdit:function(){this.isAtlas?this.$refs.jobFormAtlasEdit.save():this.$refs.jobFormEdit.save()},doStop:function(t){var e=this;this.$confirm("此操作将停止该任务版本, 是否继续?","请确认").then(N(O().mark((function r(){var n;return O().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n={trainId:e.id,id:t},r.next=3,Object(u["o"])(n);case 3:e.$message({message:"停止成功",type:"success"}),e.refreshList();case 5:case"end":return r.stop()}}),r)}))))},doDelete:function(t){var e=this,r=1===this.tableList.length?"此版本为该训练唯一的版本，如果删除该版本，对应的训练任务将一并删除, 是否继续?":"此操作将删除该任务版本, 是否继续?";this.$confirm(r,"请确认").then(N(O().mark((function r(){var n;return O().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n={trainId:e.id,id:t},r.next=3,Object(u["d"])(n);case 3:e.$message({message:"删除成功",type:"success"}),1===e.tableList.length?e.$router.push({path:"/training/job"}):e.refreshList();case 5:case"end":return r.stop()}}),r)}))))},doResume:function(){var t=N(O().mark((function t(e){var r=this;return O().wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.pathType="jobResume",this.$nextTick((function(){r.$refs.pathSelect.show({resumePath:"".concat(e.modelPath,"/"),id:e.id})}));case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),chooseDone:function(){this.refreshList()},chooseModel:function(t,e){Object.assign(e,{modelAddress:t,frameType:this.selectedTrain.frameType&&String(this.selectedTrain.frameType)}),this.$refs.saveModel.show(e)},getJobDetail:function(){var t=N(O().mark((function t(e){return O().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["g"])(e);case 2:this.selectedTrain=t.sent;case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),showPopover:function(t){return[_["TRAINING_STATUS_ENUM"].PENDING,_["TRAINING_STATUS_ENUM"].UNKNOW,_["TRAINING_STATUS_ENUM"].CREATE_FAILED].includes(t)},messageText:function(t){return t?"暂无提示信息":"容器正在启动中"},onJumpIn:function(){var t=this;this.$nextTick((function(){t.id=t.$route.query.id,t.getJobList()}))}}},M=P,k=r("2877"),C=Object(k["a"])(M,n,o,!1,null,null,null);e["default"]=C.exports},"2e38":function(t,e,r){"use strict";r.d(e,"f",(function(){return a})),r.d(e,"c",(function(){return i})),r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return c})),r.d(e,"e",(function(){return u})),r.d(e,"d",(function(){return l})),r.d(e,"g",(function(){return d}));var n=r("b775"),o=r("f121");function a(t){return Object(n["a"])({url:"/".concat(o["a"].K8S,"/pod/log"),method:"get",params:t})}function i(t){return Object(n["a"])({url:"/".concat(o["a"].K8S,"/pod/log/download"),method:"get",params:t})}function s(t){return Object(n["a"])({url:"/".concat(o["a"].K8S,"/pod/log/download"),method:"post",responseType:"blob",data:t})}function c(t,e){return Object(n["a"])({url:"/".concat(o["a"].K8S,"/pod/log/count"),method:"post",data:{namespace:t,podVOList:e}})}function u(t){return Object(n["a"])({url:"/".concat(o["a"].K8S,"/pod/realtimeMetrics"),method:"get",params:t})}function l(t){return Object(n["a"])({url:"/".concat(o["a"].K8S,"/pod/rangeMetrics"),method:"get",params:t})}function d(t){return Object(n["a"])({url:"/".concat(o["a"].K8S,"/namespace/findNamespace"),method:"get",params:{userId:t}})}},"323b":function(t,e,r){"use strict";r("15407")},"32deb":function(t,e,r){"use strict";r("86da")},"3b75":function(t,e,r){"use strict";r("12c9")},"3f22":function(t,e,r){"use strict";var n;function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function a(t,e,r){return e=i(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t){var e=s(t,"string");return"symbol"===o(e)?e:String(e)}function s(t,e){if("object"!==o(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}r.r(e),r.d(e,"NOTEBOOK_STATUS_ENUM",(function(){return c})),r.d(e,"NOTEBOOK_STATUS_MAP",(function(){return u})),r.d(e,"isNoUrlRunning",(function(){return l})),r.d(e,"isRunning",(function(){return d})),r.d(e,"needPoll",(function(){return f}));var c={RUNNING:0,STOPPED:1,DELETED:2,STARTING:3,STOPPING:4,DELETING:5,ERROR:6},u=(n={},a(n,c.RUNNING,{name:"运行中",tagMap:"success"}),a(n,c.STOPPED,{name:"停止",tagMap:"danger"}),a(n,c.STARTING,{name:"启动中",tagMap:"info"}),a(n,c.STOPPING,{name:"停止中",tagMap:"info"}),a(n,c.DELETING,{name:"删除中",tagMap:"info"}),a(n,c.ERROR,{name:"运行异常",tagMap:"danger"}),n),l=function(t){return t.status===c.RUNNING&&!t.url},d=function(t){return t.status===c.RUNNING&&t.url},f=function(t){return[c.STARTING,c.STOPPING,c.DELETING].includes(t.status)||l(t)}},"54d4":function(t,e,r){"use strict";r.d(e,"m",(function(){return a})),r.d(e,"d",(function(){return i})),r.d(e,"j",(function(){return s})),r.d(e,"h",(function(){return c})),r.d(e,"e",(function(){return u})),r.d(e,"q",(function(){return l})),r.d(e,"p",(function(){return d})),r.d(e,"b",(function(){return f})),r.d(e,"c",(function(){return h})),r.d(e,"o",(function(){return p})),r.d(e,"n",(function(){return m})),r.d(e,"f",(function(){return v})),r.d(e,"k",(function(){return g})),r.d(e,"a",(function(){return b})),r.d(e,"r",(function(){return y})),r.d(e,"g",(function(){return _})),r.d(e,"i",(function(){return w})),r.d(e,"l",(function(){return O}));var n=r("b775"),o=r("f121");function a(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/datasets/pointCloud"),method:"get",params:t})}function i(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/datasets/pointCloud"),method:"post",data:t})}function s(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/datasets/pointCloud"),method:"put",data:t})}function c(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/files/difficult/publish"),method:"post",data:t})}function u(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/datasets/pointCloud"),method:"delete",data:{ids:t}})}function l(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/datasets/pointCloud/queryByIds"),method:"get",params:t})}function d(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/datasets/pointCloud/publish"),method:"post",data:t})}function f(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/datasets/pointCloud/auto"),method:"post",data:t})}function h(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/datasets/pointCloud/stop"),method:"post",data:t})}function p(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/datasets/pointCloud/logs"),method:"get",params:t})}function m(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/datasets/pointCloud/pod/").concat(t),method:"get"})}function v(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/datasets/pointCloud/details/").concat(t),method:"get"})}function g(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/files"),method:"get",params:t})}function b(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/files/info"),method:"get",params:t})}function y(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/files/save"),method:"post",data:t})}function _(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/files/difficult"),method:"post",data:t})}function w(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/files/done"),method:"post",data:t})}function O(t){return Object(n["a"])({url:"/".concat(o["a"].POINT_CLOUD,"/datasets/pointCloud/list"),method:"get",params:t})}},"5fb2":function(t,e,r){},"79a8":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-dialog",{attrs:{visible:t.logVisible,width:"70%",title:"运行日志",top:"50px"},on:{"update:visible":function(e){t.logVisible=e},open:t.onDialogOpen,close:t.onDialogClose}},[r("div",{staticClass:"flex flex-between"},[t.isDistributed&&t.podList.length?r("div",[r("label",[t._v("选择节点")]),t._v(" "),r("InfoSelect",{staticStyle:{display:"inline-block",width:"200px"},attrs:{placeholder:"选择pod节点",dataSource:t.podList,"value-key":"podName","label-key":"displayName",clearable:"","default-first-option":"",filterable:""},on:{change:t.onLogChange},model:{value:t.activeLogTab,callback:function(e){t.activeLogTab=e},expression:"activeLogTab"}})],1):t._e(),t._v(" "),r("div",{staticClass:"btn"},[t.isDistributed&&t.podList.length?r("el-button",{on:{click:function(){return t.doDownloadPodLog()}}},[t._v("下载节点运行日志")]):t._e(),t._v(" "),r("el-button",{attrs:{type:"primary",disabled:!t.podList.length,loading:t.logDownloading},on:{click:t.downloadTrainLog}},[t._v("下载"+t._s(t.isDistributed?"全部":"")+"运行日志")])],1)]),t._v(" "),r("div",{attrs:{id:"log-wrapper"}},[!t.isDistributed&&7!==t.item.trainStatus&&t.logPodName?r("pod-log-container",{ref:"podLogContainer",staticClass:"log single-log",attrs:{pod:t.logPodName}}):t.podList.length?r("div",{attrs:{id:"distributed-log-wrapper"}},[r("keep-alive",[r("pod-log-container",{key:t.activePod.podName,ref:"podLogContainer",staticClass:"log distributed-log",attrs:{pod:t.activePod}})],1)],1):r("div",{staticClass:"log"},[r("p",{staticClass:"log-error-msg"},[t._v("暂无节点值")])])],1)])},o=[],a=r("ed08"),i=r("cce0"),s=r("2e38"),c=r("d32b"),u=r("ba8f");function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function d(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */d=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(P){c=function(t,e,r){return t[e]=r}}function u(t,e,r,o){var a=e&&e.prototype instanceof p?e:p,i=Object.create(a.prototype),s=new j(o||[]);return n(i,"_invoke",{value:L(t,r,s)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(P){return{type:"throw",arg:P}}}t.wrap=u;var h={};function p(){}function m(){}function v(){}var g={};c(g,a,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(T([])));y&&y!==e&&r.call(y,a)&&(g=y);var _=v.prototype=p.prototype=Object.create(g);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function o(n,a,i,s){var c=f(t[n],t,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==l(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){o("next",t,i,s)}),(function(t){o("throw",t,i,s)})):e.resolve(d).then((function(t){u.value=t,i(u)}),(function(t){return o("throw",t,i,s)}))}s(c.arg)}var a;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return a=a?a.then(n,n):n()}})}function L(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return E()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var s=N(i,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=f(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function N(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,N(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var o=f(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,h;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function T(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:E}}function E(){return{value:void 0,done:!0}}return m.prototype=v,n(_,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:m,configurable:!0}),m.displayName=c(v,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,s,"GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},w(O.prototype),c(O.prototype,i,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},w(_),c(_,s,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=T,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:T(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function f(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(u){return void r(u)}s.done?e(c):Promise.resolve(c).then(n,o)}function h(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){f(a,n,o,i,s,"next",t)}function s(t){f(a,n,o,i,s,"throw",t)}i(void 0)}))}}var p=1e5,m={name:"LogDialog",components:{podLogContainer:c["a"],InfoSelect:u["a"]},props:{},data:function(){return{item:{},logVisible:!1,logDownloading:!1,podList:[],activeLogTab:null,podLogLoadTags:{}}},computed:{isDistributed:function(){return 1===this.item.trainType},logPodName:function(){return this.podList[0]},activePod:function(){var t=this;return this.podList.find((function(e){return e.podName===t.activeLogTab}))||{}},podLogOption:function(){return{podName:this.activePod.podName}}},methods:{show:function(t){this.item=t,this.logVisible=!0},downloadTrainLog:function(){var t=h(d().mark((function t(){var e,r,n,o,i,c=this;return d().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.logDownloading=!0,t.next=3,Object(s["b"])(this.item.k8sNamespace,this.podList);case 3:if(e=t.sent,this.isDistributed){t.next=11;break}return r=this.podList[0],t.next=8,this.doDownloadPodLog(r,e[r.podName],!0);case 8:this.logDownloading=!1,t.next=24;break;case 11:if(n=0,this.podList.forEach((function(t){n+=e[t.podName]})),!(n<p)){t.next=20;break}return t.next=16,Object(s["a"])({podVOList:this.podList}).finally((function(){c.logDownloading=!1}));case 16:o=t.sent,Object(a["E"])(o,"".concat(this.item.jobName,"-log.zip")),t.next=24;break;case 20:this.$message.warning("节点日志总行数过多，将以单个节点为单位分别下载日志，请允许多个文件下载"),i=[],this.podList.forEach((function(t){i.push(c.doDownloadPodLog(t,e[t.podName],!1))})),Promise.all(i).then((function(){c.logDownloading=!1}));case 24:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),doDownloadPodLog:function(){var t=h(d().mark((function t(e,r){var n,o,a,i,c,u,l,f,h=arguments;return d().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=!(h.length>2&&void 0!==h[2])||h[2],e=e||this.activePod,o=e,a=o.podName,i=o.namespace,c=this.item.jobName+(this.isDistributed?"-".concat(e.displayName):""),r){t.next=9;break}return t.next=7,Object(s["b"])(i,[e]);case 7:u=t.sent,r=u[a];case 9:if(r<p)this.downloadPodLog({podName:a,namespace:i},"".concat(c,"-log.log"));else{n&&this.$message.warning("目标 ".concat(c," 日志总行数过多，将按行数进行日志分片下载，请允许多个文件下载")),l=1,f=p;while(l<r)this.downloadPodLog({podName:a,namespace:i,startLine:l,lines:f},"".concat(c,"-log-").concat(l,"-").concat(l+f-1,".log")),l+=f,f=r-l>p?f:r-l}case 10:case"end":return t.stop()}}),t,this)})));function e(e,r){return t.apply(this,arguments)}return e}(),downloadPodLog:function(){var t=h(d().mark((function t(e,r){var n;return d().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["c"])(e);case 2:n=t.sent,Object(a["E"])(n,r);case 4:case"end":return t.stop()}}),t)})));function e(e,r){return t.apply(this,arguments)}return e}(),onDialogOpen:function(){var t=h(d().mark((function t(){var e=this;return d().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["j"])(this.item.id);case 2:if(this.podList=t.sent,!this.isDistributed){t.next=6;break}return this.podList.length&&(this.activeLogTab=this.podList[0].podName,this.podLogLoadTags={},this.$nextTick((function(){e.$refs.podLogContainer.reset(),e.podLogLoadTags[e.activeLogTab]=!0}))),t.abrupt("return");case 6:7!==this.item.trainStatus&&this.podList.length&&this.$nextTick((function(){e.$refs.podLogContainer.reset()}));case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onDialogClose:function(){this.$refs.podLogContainer&&this.$refs.podLogContainer.quit()},onLogChange:function(){var t=this;this.activeLogTab||(this.activeLogTab=this.podList[0].podName),this.podLogLoadTags[this.activeLogTab]||this.$nextTick((function(){t.$refs.podLogContainer.reset(),t.podLogLoadTags[t.activeLogTab]=!0}))}}},v=m,g=(r("3b75"),r("2877")),b=Object(g["a"])(v,n,o,!1,null,"014c6474",null);e["default"]=b.exports},"79ab":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"ts-drawer"},[r("div",{staticClass:"title",attrs:{tabindex:"0"}},[t._v("配置信息")]),t._v(" "),r("job-detail",{attrs:{item:t.item}}),t._v(" "),r("div",{staticClass:"title"},[t._v("运行信息")]),t._v(" "),r("el-row",{staticClass:"row"},[r("el-col",{attrs:{span:12}},[r("div",{staticClass:"label"},[t._v("运行时长")]),t._v(" "),r("div",{staticClass:"text"},[t._v(t._s(t.item.runtime))])]),t._v(" "),r("el-col",{attrs:{span:12}},[r("div",{staticClass:"label"},[t._v("运行日志")]),t._v(" "),r("el-button",{on:{click:t.onCheckLog}},[t._v("点击查看")])],1),t._v(" "),1===t.item.trainStatus?r("el-col",{attrs:{span:12}},[r("div",{staticClass:"label"},[t._v("监控信息")]),t._v(" "),r("el-button",{attrs:{size:"mini"},on:{click:t.checkMetrics}},[t._v("查看监控信息")])],1):t._e()],1),t._v(" "),r("el-row",{staticClass:"row"},[t.item.delayCreateCountDown>0?r("el-col",{attrs:{span:12}},[r("div",{staticClass:"label"},[t._v("延迟启动")]),t._v(" "),r("div",{staticClass:"text"},[t._v("剩余 "+t._s(t._f("minute2Time")(t.item.delayCreateCountDown)))])]):t._e(),t._v(" "),t.item.delayDeleteCountDown>0?r("el-col",{attrs:{span:12}},[r("div",{staticClass:"label"},[t._v("训练停止")]),t._v(" "),r("div",{staticClass:"text"},[t._v("剩余 "+t._s(t._f("minute2Time")(t.item.delayDeleteCountDown)))])]):t._e()],1),t._v(" "),r("el-dialog",{attrs:{visible:t.metricsVisible,width:"800px",title:"监控信息","append-to-body":"",top:"5vh","custom-class":"metrics-dialog","close-on-click-modal":!1},on:{"update:visible":function(e){t.metricsVisible=e},opened:t.onMetricsDialogOpened,close:t.onMetricsDialogClose}},[r("label",{staticClass:"pr-20"},[t._v("选择节点")]),t._v(" "),r("el-select",{staticClass:"w-300 mb-20",attrs:{placeholder:"请选择节点",filterable:"",multiple:"","collapse-tags":""},on:{change:t.onSelectedPodChange},model:{value:t.selectedPod,callback:function(e){t.selectedPod=e},expression:"selectedPod"}},t._l(t.podList,(function(t){return r("el-option",{key:t.podName,attrs:{value:t.podName,label:t.displayName}})})),1),t._v(" "),r("PodMonitor",{ref:"podMonitor",attrs:{namespace:t.item.k8sNamespace,"resource-name":t.item.jobName,"pod-name":t.selectedPod,"display-gpu":t.item.resourcesPoolType===t.RESOURCES_POOL_TYPE_ENUM.GPU}})],1)],1)},o=[],a=r("ed08"),i=r("cce0"),s=r("f48d"),c=r("e9e5");function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function l(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */l=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(P){c=function(t,e,r){return t[e]=r}}function d(t,e,r,o){var a=e&&e.prototype instanceof p?e:p,i=Object.create(a.prototype),s=new j(o||[]);return n(i,"_invoke",{value:L(t,r,s)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(P){return{type:"throw",arg:P}}}t.wrap=d;var h={};function p(){}function m(){}function v(){}var g={};c(g,a,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(T([])));y&&y!==e&&r.call(y,a)&&(g=y);var _=v.prototype=p.prototype=Object.create(g);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function o(n,a,i,s){var c=f(t[n],t,a);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==u(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){o("next",t,i,s)}),(function(t){o("throw",t,i,s)})):e.resolve(d).then((function(t){l.value=t,i(l)}),(function(t){return o("throw",t,i,s)}))}s(c.arg)}var a;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return a=a?a.then(n,n):n()}})}function L(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return E()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var s=N(i,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=f(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function N(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,N(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var o=f(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,h;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function T(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:E}}function E(){return{value:void 0,done:!0}}return m.prototype=v,n(_,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:m,configurable:!0}),m.displayName=c(v,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,s,"GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},w(O.prototype),c(O.prototype,i,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(d(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},w(_),c(_,s,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=T,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:T(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function d(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(u){return void r(u)}s.done?e(c):Promise.resolve(c).then(n,o)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){d(a,n,o,i,s,"next",t)}function s(t){d(a,n,o,i,s,"throw",t)}i(void 0)}))}}var h={name:"JobDrawer",components:{JobDetail:c["default"],PodMonitor:s["a"]},filters:{minute2Time:function(t){var e=t||0,r=Math.floor(t/1440);e%=1440;var n=Math.floor(e/60);return e%=60,"".concat(r?r+"天":"").concat(n?n+"小时":"").concat(e,"分钟")}},data:function(){return{RESOURCES_POOL_TYPE_ENUM:a["q"],item:{},podList:[],selectedPod:[],keepCountDown:!1,metricsVisible:!1}},methods:{countDown:function(){var t=this;this.keepCountDown&&setTimeout((function(){t.getJobDetail(t.item.id),t.countDown()}),6e4)},onOpen:function(){var t=f(l().mark((function t(e){return l().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.getPodList(e),t.next=3,this.getJobDetail(e);case 3:(this.item.delayCreateCountDown>0||this.item.delayDeleteCountDown>0)&&(this.keepCountDown=!0,this.countDown());case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getJobDetail:function(){var t=f(l().mark((function t(e){return l().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["g"])(e);case 2:this.item=t.sent;case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getPodList:function(){var t=f(l().mark((function t(e){return l().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["j"])(e);case 2:this.podList=t.sent;case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),onSelectedPodChange:function(){var t=this;this.$nextTick((function(){t.$refs.podMonitor.init()}))},checkMetrics:function(){this.item.k8sNamespace&&this.item.jobName?this.metricsVisible=!0:this.$message.warning("命名空间或资源名称为空，无法查看监控信息")},onMetricsDialogOpened:function(){var t=this;this.podList.length&&(this.selectedPod=[this.podList[0].podName]),this.$nextTick((function(){t.$refs.podMonitor.init()}))},onMetricsDialogClose:function(){this.$refs.podMonitor.stop(),this.selectedPod=[]},onClose:function(){this.keepCountDown=!1},onCheckLog:function(){this.$emit("show-log",this.item)}}},p=h,m=(r("323b"),r("2877")),v=Object(m["a"])(p,n,o,!1,null,"0318687f",null);e["default"]=v.exports},"86da":function(t,e,r){},"8bbd":function(t,e,r){"use strict";r.d(e,"l",(function(){return a})),r.d(e,"a",(function(){return i})),r.d(e,"d",(function(){return c})),r.d(e,"f",(function(){return u})),r.d(e,"m",(function(){return l})),r.d(e,"k",(function(){return d})),r.d(e,"b",(function(){return f})),r.d(e,"j",(function(){return h})),r.d(e,"i",(function(){return p})),r.d(e,"e",(function(){return m})),r.d(e,"h",(function(){return v})),r.d(e,"g",(function(){return g}));var n=r("b775"),o=r("f121");function a(t){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelInfo"),method:"get",params:t})}function i(t){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelInfo"),method:"post",data:t})}function s(t){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelInfo"),method:"put",data:t})}function c(t){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelInfo"),method:"delete",data:t})}function u(t,e){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelInfo/byResource"),method:"get",params:{modelResource:t,packaged:e}})}function l(t){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelInfo/package"),method:"post",data:t})}function d(t){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelInfo/servingModel"),method:"get",params:{modelResource:t}})}function f(t){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelInfo/uploadModel"),method:"post",data:t})}function h(){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelType"),method:"get"})}function p(t){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelSuffix"),method:"get",params:t})}function m(t){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelInfo/byModelId"),method:"get",params:{id:t}})}function v(t){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelStruct"),method:"get",params:t})}function g(t){return Object(n["a"])({url:"/".concat(o["a"].MODEL,"/ptModelInfo/atlasModel"),method:"get",params:t})}e["c"]={list:a,add:i,edit:s,del:c}},9532:function(t,e,r){"use strict";var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-form",{ref:"form",style:"width: "+t.widthPercent+"%; margin-top: 20px;",attrs:{model:t.form,rules:t.rules,"label-width":"150px"}},[r("div",{staticClass:"training-area-title"},[t._v("基本信息")]),t._v(" "),"add"===t.type||"paramsAdd"===t.type?r("el-form-item",{attrs:{label:"任务名称",prop:"trainName"}},[r("el-input",{staticClass:"w-320",model:{value:t.form.trainName,callback:function(e){t.$set(t.form,"trainName",e)},expression:"form.trainName"}})],1):t._e(),t._v(" "),"edit"===t.type?r("el-form-item",{attrs:{label:"任务名称",prop:"jobName"}},[r("div",[t._v(t._s(t.form.jobName))])]):t._e(),t._v(" "),"saveParams"===t.type||"paramsEdit"===t.type?r("el-form-item",{attrs:{label:"任务模板名称",prop:"paramName"}},[r("el-input",{staticClass:"w-320",attrs:{id:"paramName"},model:{value:t.form.paramName,callback:function(e){t.$set(t.form,"paramName",e)},expression:"form.paramName"}})],1):t._e(),t._v(" "),r("el-form-item",{attrs:{label:"任务描述",prop:"description"}},[r("el-input",{staticClass:"w-700",attrs:{id:"description",type:"textarea",autosize:{minRows:4}},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),t._v(" "),"saveParams"!==t.type?[r("div",{staticClass:"training-area-title"},[t._v("任务类型")]),t._v(" "),r("el-form-item",{staticClass:"is-required",attrs:{label:"任务类型"}},[r("el-radio-group",{on:{change:t.onJobTypeChange},model:{value:t.form.jobType,callback:function(e){t.$set(t.form,"jobType",e)},expression:"form.jobType"}},[r("el-radio",{attrs:{id:"jobType_tab_0",label:t.JOB_TYPE_ENUM.SINGLE}},[t._v("单任务")]),t._v(" "),r("el-radio",{attrs:{id:"jobType_tab_1",label:t.JOB_TYPE_ENUM.MULTIPLE}},[t._v("多任务")])],1),t._v(" "),r("el-tooltip",{attrs:{effect:"dark",content:"选择“多任务”模式将匹配使用Task Branching算法，重组后模型支持多任务场景",placement:"top"}},[r("i",{staticClass:"el-icon-warning c-info f18 v-text-top"})])],1),t._v(" "),r("div",{staticClass:"training-area-title"},[t._v("教师模型")]),t._v(" "),t._l(t.baseAtlasParams,(function(e,n){return r("div",{key:e._id},[r("el-form-item",{key:"teacherModel",staticClass:"is-required",attrs:{label:"教师模型"+(n+1),error:t.errorList[n]}},[r("el-select",{staticClass:"w-240",attrs:{clearable:"",filterable:"",placeholder:"请选择教师模型"},on:{change:function(e){return t.onTeacherModelChange(n)}},model:{value:e.teacherModelStruct,callback:function(r){t.$set(e,"teacherModelStruct",r)},expression:"el.teacherModelStruct"}},t._l(t.modelStructList,(function(t,e){return r("el-option",{key:t+e,attrs:{label:t,value:t}})})),1),t._v(" "),r("span",{staticClass:"label-class"},[t._v("数据集"+t._s(n+1))]),t._v(" "),r("el-select",{staticClass:"w-240",attrs:{placeholder:"请选择您挂载的数据集","value-key":"id",filterable:"",clearable:""},on:{change:function(r){return t.onDataSourceChange(r,e,n)}},model:{value:e.datasetId,callback:function(r){t.$set(e,"datasetId",r)},expression:"el.datasetId"}},t._l(t.getDatasetList(t.datasetList),(function(t){return r("el-option",{key:t.id,attrs:{value:t.id,label:t.name,disabled:t.disabled}})})),1),t._v(" "),t.baseAtlasParams.length>2?r("i",{staticClass:"el-icon-circle-close",on:{click:function(e){return t.deleteItem(n)}}}):t._e(),t._v(" "),n===t.baseAtlasParams.length-1?r("el-button",{staticClass:"create-btn ml-5",attrs:{disabled:t.baseAtlasParams.length>=5,type:"primary",icon:"el-icon-plus"},on:{click:t.addDataSource}},[t._v("增加教师模型")]):t._e()],1)],1)})),t._v(" "),r("div",{staticClass:"training-area-title"},[t._v("学生模型")]),t._v(" "),r("el-form-item",{ref:"studentModelStruct",attrs:{label:"学生模型",prop:"studentModelStruct"}},[r("el-select",{staticClass:"w-320",attrs:{clearable:"",filterable:"",placeholder:"请选择学生模型"},on:{change:t.onStudentModelIdsChange},model:{value:t.form.studentModelStruct,callback:function(e){t.$set(t.form,"studentModelStruct",e)},expression:"form.studentModelStruct"}},t._l(t.modelStructList,(function(t,e){return r("el-option",{key:t+e,attrs:{label:t,value:t}})})),1)],1),t._v(" "),r("div",{staticClass:"training-area-title"},[t._v("选择算法")]),t._v(" "),r("el-form-item",{ref:"algorithmName",attrs:{label:"算法名称",prop:"algorithmName"}},[r("el-select",{staticClass:"w-300",attrs:{placeholder:"请选择您使用的算法",filterable:"",disabled:""},model:{value:t.form.algorithmName,callback:function(e){t.$set(t.form,"algorithmName",e)},expression:"form.algorithmName"}})],1),t._v(" "),r("div",{staticClass:"training-area-title"},[t._v("选择镜像")]),t._v(" "),r("el-form-item",{ref:"imageTag",attrs:{label:"选用镜像",prop:"imageTag"}},[r("el-select",{staticClass:"w-240",attrs:{id:"imageName",placeholder:"请选择镜像",clearable:"",filterable:"",disabled:""},model:{value:t.form.imageName,callback:function(e){t.$set(t.form,"imageName",e)},expression:"form.imageName"}}),t._v(" "),r("el-select",{staticClass:"w-240",staticStyle:{width:"305px"},attrs:{id:"imageTag",placeholder:"请选择镜像版本",clearable:"",filterable:"",disabled:""},model:{value:t.form.imageTag,callback:function(e){t.$set(t.form,"imageTag",e)},expression:"form.imageTag"}})],1),t._v(" "),r("div",{staticClass:"training-area-title"},[t._v("运行命令")]),t._v(" "),r("el-form-item",{ref:"runCommand",attrs:{label:"运行命令",prop:"runCommand"}},[r("el-input",{staticClass:"w-700",attrs:{id:"runCommand",placeholder:"例如：python mnist.py",type:"textarea",autosize:{minRows:4}},model:{value:t.form.runCommand,callback:function(e){t.$set(t.form,"runCommand",e)},expression:"form.runCommand"}})],1),t._v(" "),r("div",{staticClass:"training-area-title"},[t._v("资源规格")]),t._v(" "),r("el-form-item",{staticClass:"is-required",attrs:{label:"节点类型"}},[r("el-radio-group",{on:{change:t.onResourcesPoolTypeChange},model:{value:t.form.resourcesPoolType,callback:function(e){t.$set(t.form,"resourcesPoolType",e)},expression:"form.resourcesPoolType"}},[r("el-radio",{attrs:{id:"resourcesPoolType_tab_0",label:0}},[t._v("CPU")]),t._v(" "),r("el-radio",{attrs:{id:"resourcesPoolType_tab_1",label:1}},[t._v("GPU")])],1),t._v(" "),t.form.resourcesPoolType?r("el-tooltip",{attrs:{effect:"dark",content:"后台将自动获取并填充参数 gpu_num_per_node",placement:"top"}},[r("i",{staticClass:"el-icon-warning c-info f18 v-text-top"})]):t._e()],1),t._v(" "),r("el-form-item",{ref:"trainJobSpecs",attrs:{label:"节点规格",prop:"trainJobSpecsName"}},[r("el-select",{staticClass:"w-240",attrs:{id:"trainJobSpecsName",filterable:""},model:{value:t.form.trainJobSpecsName,callback:function(e){t.$set(t.form,"trainJobSpecsName",e)},expression:"form.trainJobSpecsName"}},t._l(t.specsList,(function(t){return r("el-option",{key:t.id,attrs:{label:t.specsName,value:t.specsName}})})),1),t._v(" "),t.form.trainType?r("el-tooltip",{attrs:{effect:"dark",content:"每个节点的节点规格",placement:"top"}},[r("i",{staticClass:"el-icon-warning c-info f18 v-text-top"})]):t._e()],1),t._v(" "),r("div",{staticClass:"training-area-title"},[t._v("运行命令预览")]),t._v(" "),r("div",{staticClass:"command-preview mb-40"},[t._v("\n        "+t._s(t.preview)+"\n      ")])]:t._e(),t._v(" "),"saveParams"===t.type?[r("el-form-item",{attrs:{label:"教师模型"}},[t._v("\n        "+t._s(t.teacherModelNames)+"\n      ")]),t._v(" "),r("el-form-item",{attrs:{label:"学生模型"}},[t._v("\n        "+t._s(t.studentModelNames)+"\n      ")]),t._v(" "),r("el-form-item",{attrs:{label:"训练数据集"}},[t._v("\n        "+t._s(t.form.atlasDatasetNames)+"\n      ")]),t._v(" "),r("el-form-item",{attrs:{label:"算法名称"}},[t._v("\n        "+t._s(t.form.algorithmName)+"\n      ")]),t._v(" "),r("el-form-item",{attrs:{label:"选用镜像"}},[t._v("\n        "+t._s(t.form.imageName)+"\n      ")]),t._v(" "),r("el-form-item",{attrs:{label:"运行命令"}},[t._v("\n        "+t._s(t.form.runCommand)+"\n      ")]),t._v(" "),r("el-form-item",{attrs:{label:"节点类型"}},[t._v("\n        "+t._s(t.form.resourcesPoolType)+"\n      ")]),t._v(" "),r("el-form-item",{attrs:{label:"节点规格"}},[t._v("\n        "+t._s(t.formSpecs&&t.formSpecs.specsName)+"\n      ")]),t._v(" "),r("el-form-item",{attrs:{label:"运行命令预览"}},[r("div",{staticClass:"command-preview"},[t._v("\n          "+t._s(t.preview)+"\n        ")])])]:t._e()],2)],1)},o=[],a=r("ed08"),i=r("03b8"),s=r("f121"),c=r("8bbd"),u=r("9eb2"),l=r("0c61"),d=r("141b"),f=r("2ef0");function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function p(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */p=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(P){c=function(t,e,r){return t[e]=r}}function u(t,e,r,o){var a=e&&e.prototype instanceof f?e:f,i=Object.create(a.prototype),s=new j(o||[]);return n(i,"_invoke",{value:L(t,r,s)}),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(P){return{type:"throw",arg:P}}}t.wrap=u;var d={};function f(){}function m(){}function v(){}var g={};c(g,a,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(T([])));y&&y!==e&&r.call(y,a)&&(g=y);var _=v.prototype=f.prototype=Object.create(g);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function o(n,a,i,s){var c=l(t[n],t,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==h(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){o("next",t,i,s)}),(function(t){o("throw",t,i,s)})):e.resolve(d).then((function(t){u.value=t,i(u)}),(function(t){return o("throw",t,i,s)}))}s(c.arg)}var a;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return a=a?a.then(n,n):n()}})}function L(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return E()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var s=N(i,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=l(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function N(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,N(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,d;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function T(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:E}}function E(){return{value:void 0,done:!0}}return m.prototype=v,n(_,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:m,configurable:!0}),m.displayName=c(v,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,s,"GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},w(O.prototype),c(O.prototype,i,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},w(_),c(_,s,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=T,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:T(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},t}function m(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(u){return void r(u)}s.done?e(c):Promise.resolve(c).then(n,o)}function v(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){m(a,n,o,i,s,"next",t)}function s(t){m(a,n,o,i,s,"throw",t)}i(void 0)}))}}function g(t,e){return _(t)||y(t,e)||O(t,e)||b()}function b(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function y(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,s=[],c=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(l){u=!0,o=l}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return s}}function _(t){if(Array.isArray(t))return t}function w(t,e){var r="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=O(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){s=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function O(t,e){if(t){if("string"===typeof t)return L(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(t,e):void 0}}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function N(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function x(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?N(Object(r),!0).forEach((function(e){S(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function S(t,e,r){return e=j(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j(t){var e=T(t,"string");return"symbol"===h(e)?e:String(e)}function T(t,e){if("object"!==h(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var E={dataSourceName:null,dataSourcePath:null,datasetId:null,datasetType:a["c"].NORMAL,teacherModelName:null,teacherModelPath:null,teacherModelStruct:null,trainJobId:null,datasetVersion:null},P={algorithmId:null,id:null,trainName:"",jobName:"",paramName:"",description:"",jobType:i["JOB_TYPE_ENUM"].SINGLE,algorithmSource:a["b"].CUSTOM,algorithmName:null,datasetType:a["c"].NORMAL,valDatasetType:null,imageTag:null,imageName:null,notebookId:null,dataSourceName:null,dataSourcePath:null,atlasDatasetNames:null,atlasDatasetPaths:null,valDataSourceName:null,valDataSourcePath:null,atlasValDatasetNames:null,atlasValDatasetPaths:null,runCommand:"",runParams:{},trainType:i["TRAINING_TYPE_ENUM"].ATLAS,valType:0,resourcesPoolNode:1,resourcesPoolType:1,trainJobSpecsName:null,outPath:"/home/result/",logPath:"/home/log/",delayCreateTime:0,delayDeleteTime:0,modelResource:a["k"].ATLAS,studentModelStruct:null,modelId:null,modelBranchId:null,baseAtlasParams:[]},M=0,k={props:{type:{type:String,default:"add"},widthPercent:{type:Number,default:100}},data:function(){return{form:JSON.parse(JSON.stringify(P)),rules:{trainName:[{required:!0,message:"请输入任务名称",trigger:"blur"},{max:32,message:"长度控制在32个字符",trigger:"blur"},{validator:a["ac"],trigger:["blur","change"]}],paramName:[{required:!0,message:"请输入任务参数名称",trigger:"blur"},{max:32,message:"长度控制在32个字符",trigger:"blur"},{validator:a["ac"],trigger:["blur","change"]}],algorithmSource:[{required:!0,message:"请选择算法",trigger:"change"}],algorithmName:[{required:!0,message:"请选择算法",trigger:"change"}],studentModelStruct:[{required:!0,message:"请选择学生模型结构",trigger:"change"}],imageTag:[{required:!0,message:"请选择镜像",trigger:"change"}],trainJobSpecsName:[{required:!0,message:"请选择节点规格",trigger:"change"}],runCommand:[{required:!0,message:"请输入运行命令",trigger:["blur","change"]}]},modelStructList:[],algorithmIdList:["common-feature-learning","layerwise-amalgamation"],trainConfig:s["i"],specsList:[],ALGORITHM_SCESE_ENUM:a["c"],MODEL_RESOURCE_ENUM:a["k"],baseAtlasParams:[x(x({},Object(f["cloneDeep"])(E)),{},{_id:M++}),x(x({},Object(f["cloneDeep"])(E)),{},{_id:M++})],currentAlgPage:1,teacherModelList:[],studentModelList:[],datasetList:[],errorList:["",""],JOB_TYPE_ENUM:i["JOB_TYPE_ENUM"]}},computed:{formSpecs:function(){var t=this;return this.specsList.find((function(e){return e.specsName===t.form.trainJobSpecsName}))},preview:function(){var t=this.form.runCommand;return t+="  --teacher_path_list=${teacher_path_1,teacher_path_2,...}",t+="  --student_path_list=${student_path}",t+=" --atlas_dataset_paths=${atlas_dataset_path_1,atlas_dataset_path_2,...)}",this.form.resourcesPoolType&&(t+=" --gpu_num_per_node=${gpu_num}"),this.form.resourcesPoolNode>1&&(t+=" --num_nodes=".concat(this.form.resourcesPoolNode," --node_ips=${node_ips}")),t},teacherModelNames:function(){return this.teacherModelList.map((function(t){return t.name})).join(", ")},studentModelNames:function(){return this.studentModelList.map((function(t){return t.name})).join(", ")}},watch:{"form.algorithmName":{handler:function(t){t?this.getAlgorithmInfo(t):(this.form.imageName=null,this.form.imageTag=null,this.form.runCommand="")}}},methods:{deleteItem:function(t){this.baseAtlasParams.splice(t,1),this.errorList.splice(t,1)},getDatasetList:function(t){if(this.form.jobType===i["JOB_TYPE_ENUM"].MULTIPLE)return t;for(var e=Object(f["cloneDeep"])(t),r=[],n=0;n<this.baseAtlasParams.length;n+=1){var o;null!==(o=this.baseAtlasParams[n])&&void 0!==o&&o.datasetId&&r.push(this.baseAtlasParams[n].datasetId)}if(r.length){var a,s=w(e);try{var c=function(){var t=a.value;r.find((function(e){return e===t.id}))?t.disabled=!0:t.disabled=!1};for(s.s();!(a=s.n()).done;)c()}catch(u){s.e(u)}finally{s.f()}}return e},getAlgorithmName:function(){if(this.form.jobType===i["JOB_TYPE_ENUM"].SINGLE){var t,e=[],r=w(this.baseAtlasParams);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.teacherModelStruct&&e.push(n.teacherModelStruct)}}catch(d){r.e(d)}finally{r.f()}if(e.length>=2&&this.form.studentModelStruct){var o,a="",s=w(e);try{for(s.s();!(o=s.n()).done;){var c=o.value;if(c!==this.form.studentModelStruct){var u=g(this.algorithmIdList,1);a=u[0];break}var l=g(this.algorithmIdList,2);a=l[1]}}catch(d){s.e(d)}finally{s.f()}this.form.algorithmName=a}else this.form.algorithmName=null}},getAlgorithmInfo:function(){var t=v(p().mark((function t(e){var r,n,o,a,i,s;return p().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["d"])({name:e});case 2:if(r=t.sent,n=r||{},o=n.id,a=n.imageName,i=n.imageTag,s=n.runCommand,o){t.next=7;break}return this.$message.warning("该算法不存在"),t.abrupt("return");case 7:if(a&&i){t.next=10;break}return this.$message.warning("该算法未配置镜像"),t.abrupt("return");case 10:this.form.algorithmId=o,this.form.imageName=a,this.form.imageTag=i,this.form.runCommand=s;case 14:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),initForm:function(){var t=v(p().mark((function t(e){var r,n,o,a,i,s,c,u,l=this;return p().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=Object(f["cloneDeep"])(e)||{},Object.keys(this.form).forEach((function(t){Object(f["isNil"])(r[t])||(l.form[t]=r[t])})),null!==r&&void 0!==r&&r.baseAtlasParams&&(this.baseAtlasParams=[],this.errorList=[],r.baseAtlasParams.forEach(function(){var t=v(p().mark((function t(e){return p().wrap((function(t){while(1)switch(t.prev=t.next){case 0:l.baseAtlasParams.push(x(x({},e),{},{_id:M++})),l.errorList.push("");case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.checkModelValid()),"saveParams"===this.type&&(this.studentModelList=[],n=[],this.studentModelList.push({name:r.studentModelStruct}),null!==r&&void 0!==r&&r.baseAtlasParams)){this.teacherModelList=[],this.dataSourceNameList=[],o=w(r.baseAtlasParams);try{for(o.s();!(a=o.n()).done;)i=a.value,i.teacherModelStruct&&this.teacherModelList.push({name:i.teacherModelStruct}),i.datasetVersion?n.push("".concat(i.dataSourceName,":").concat(i.datasetVersion)):n.push(i.dataSourceName)}catch(d){o.e(d)}finally{o.f()}this.form.atlasDatasetNames=n.join(", ")}return t.next=6,this.getDatasetIdOriList();case 6:if(!this.datasetList.length){s=w(this.baseAtlasParams);try{for(s.s();!(c=s.n()).done;)u=c.value,u.datasetId=null}catch(d){s.e(d)}finally{s.f()}}return t.next=9,this.getModelSturctNameList();case 9:this.checkItemExist(this.baseAtlasParams,this.datasetList,"数据集"),this.checkItemExist(this.baseAtlasParams,this.modelStructList,"教师模型"),this.onResourcesPoolTypeChange(!["add"].includes(this.type)),this.clearValidate();case 13:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),checkItemExist:function(t,e,r){var n,o=[],i=w(t);try{for(i.s();!(n=i.n()).done;){var s=n.value;"数据集"===r&&s.datasetId&&o.push(s.datasetId),"教师模型"===r&&s.teacherModelStruct&&o.push(s.teacherModelStruct)}}catch(l){i.e(l)}finally{i.f()}if(o.length){var c=new Set;if(o.forEach((function(t){"数据集"===r?e.find((function(e){return e.id===t}))||c.add(t):"教师模型"===r&&(e.find((function(e){return e===t}))||c.add(t))})),c.size>0){var u="数据集"===r?"以下 id 的数据集不存在: ".concat(Array.from(c).join("、")):"以下教师模型不存在: ".concat(Array.from(c).join("、"));Object(a["X"])({message:u,type:"warning"})}}},validate:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.$refs.form.validate.apply(this,e)},clearValidate:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.$refs.form.clearValidate.apply(this,e)},validateField:function(t){this.$refs[t].validate("manual")},clearFieldValidate:function(t){this.$refs[t].clearValidate()},checkModelValid:function(){for(var t=0;t<this.baseAtlasParams.length;t+=1)this.checkModelItem(t);var e,r=!0,n=w(this.errorList);try{for(n.s();!(e=n.n()).done;){var o=e.value;o&&(r=!1)}}catch(a){n.e(a)}finally{n.f()}return r||this.$message.warning("请检查任务参数"),r},checkModelSize:function(){var t=v(p().mark((function t(){var e,r,n,o,a,i,s,u,l,d;return p().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=[],r=[],n=w(this.baseAtlasParams);try{for(n.s();!(o=n.n()).done;)a=o.value,a.dataSourceName&&a.teacherModelStruct&&r.push("".concat(a.dataSourceName,"_").concat(a.teacherModelStruct))}catch(f){n.e(f)}finally{n.f()}i=0;case 5:if(!(i<r.length)){t.next=19;break}return t.next=8,Object(c["g"])({name:r[i]});case 8:if(s=t.sent,u=Object.values(s).filter((function(t){return null!==t})),0!==u.length){t.next=13;break}return this.$message.warning("模型不存在"),t.abrupt("return",!1);case 13:l=s.modelAddress,d=s.modelSize,e.push(d),this.$set(this.baseAtlasParams[i],"teacherModelPath",l);case 16:i+=1,t.next=5;break;case 19:if(!(Math.max.apply(Math,e)/Math.min.apply(Math,e)>1.5)){t.next=22;break}return this.$message.warning("重组模型尺寸超限"),t.abrupt("return",!1);case 22:return t.abrupt("return",!0);case 23:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),checkModelItem:function(t){var e="";this.baseAtlasParams[t].teacherModelStruct||(e="请选择教师模型"),this.baseAtlasParams[t].datasetId||(e="请选择数据集"),this.baseAtlasParams[t].teacherModelStruct||this.baseAtlasParams[t].datasetId||(e="请选择教师模型和数据集"),e?this.errorList[t]=e:this.errorList.splice(t,1,"")},onTeacherModelChange:function(t){this.errorList[t]&&this.checkModelItem(t),this.getAlgorithmName()},onStudentModelIdsChange:function(){this.getAlgorithmName()},onResourcesPoolTypeChange:function(){var t=v(p().mark((function t(){var e,r=arguments;return p().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]&&r[0],t.next=3,Object(l["d"])({module:a["p"].ATLAS,resourcesPoolType:this.form.resourcesPoolType,current:1,size:500});case 3:this.specsList=t.sent.result,!0!==e&&this.specsList.length&&(this.form.trainJobSpecsName=this.specsList[0].specsName);case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onJobTypeChange:function(){var t=this;this.baseAtlasParams=[x(x({},Object(f["cloneDeep"])(E)),{},{_id:M++}),x(x({},Object(f["cloneDeep"])(E)),{},{_id:M++})],this.getDatasetIdOriList(),this.getModelSturctNameList(),this.form.studentModelStruct=null,this.form.algorithmName=null,setTimeout((function(){t.$refs.form.clearValidate(["studentModelStruct","algorithmName","imageTag","runCommand"])}),0),this.form.jobType===i["JOB_TYPE_ENUM"].MULTIPLE&&(this.form.algorithmName="task-branching")},getDatasetIdOriList:function(){var t=v(p().mark((function t(){var e,r,n;return p().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.form.jobType,r={size:1e3,annotateType:null,module:e},t.next=4,Object(d["p"])(r);case 4:n=t.sent,this.datasetList=n.result;case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getModelSturctNameList:function(){var t=v(p().mark((function t(){return p().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["h"])({jobType:this.form.jobType});case 2:this.modelStructList=t.sent;case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onDataSourceChange:function(){var t=v(p().mark((function t(e,r,n){var o,a;return p().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.errorList[n]&&this.checkModelItem(n),!e){t.next=12;break}return o=this.datasetList.find((function(t){return t.id===e})),r.dataSourceName=o.name,r.dataSourcePath=null===o||void 0===o?void 0:o.url,t.next=7,Object(d["l"])(e);case 7:a=t.sent,r.dataSourcePath=a[0].versionUrl,r.datasetVersion=a[0].versionName,t.next=16;break;case 12:r.dataSourceName=null,r.dataSourcePath=null,r.dataSourcePath=null,r.datasetVersion=null;case 16:case"end":return t.stop()}}),t,this)})));function e(e,r,n){return t.apply(this,arguments)}return e}(),addDataSource:function(){this.baseAtlasParams.length<5&&(this.baseAtlasParams.push(x(x({},Object(f["cloneDeep"])(E)),{},{_id:M++})),this.errorList.push(""))},reset:function(){var t=this;this.form=x({},P),this.form.runParams={},this.errorList=[].push("",""),this.$message({message:"数据已重置",type:"success"}),setTimeout((function(){t.onResourcesPoolTypeChange(),t.$refs.form.clearValidate()}),0)},save:function(){var t=v(p().mark((function t(){var e=this;return p().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.loading){t.next=2;break}return t.abrupt("return");case 2:if(this.isSaveParams||this.checkModelValid()){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,this.checkModelSize();case 6:if(t.sent){t.next=8;break}return t.abrupt("return");case 8:this.form.baseAtlasParams=this.baseAtlasParams,this.$refs.form.validate(function(){var t=v(p().mark((function t(r){var n,o,a,i,s,c;return p().wrap((function(t){while(1)switch(t.prev=t.next){case 0:r?(n=x({},e.form),e.formSpecs&&(o=e.formSpecs,a=o.cpuNum,i=o.gpuNum,s=o.memNum,c=o.workspaceRequest,Object.assign(n,{cpuNum:a,gpuNum:i,memNum:s,workspaceRequest:c})),n.valDataSourceName=n.valDataSourcePath=n.valDatasetType=null,e.$emit("getForm",n)):e.$message({message:"请仔细检查任务参数",type:"warning"});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},C=k,D=(r("9a3b"),r("2877")),I=Object(D["a"])(C,n,o,!1,null,"2d1077de",null);e["a"]=I.exports},"9a3b":function(t,e,r){"use strict";r("5fb2")},"9eb2":function(t,e,r){"use strict";r.d(e,"f",(function(){return a})),r.d(e,"g",(function(){return i})),r.d(e,"a",(function(){return s})),r.d(e,"c",(function(){return c})),r.d(e,"b",(function(){return u})),r.d(e,"h",(function(){return l})),r.d(e,"e",(function(){return d})),r.d(e,"d",(function(){return f}));var n=r("b775"),o=r("f121");function a(t){return Object(n["a"])({url:"/".concat(o["a"].ALGORITHM,"/algorithms"),method:"get",params:t})}function i(t){return Object(n["a"])({url:"/".concat(o["a"].ALGORITHM,"/algorithms/getAll"),method:"get",params:t})}function s(t){return Object(n["a"])({url:"/".concat(o["a"].ALGORITHM,"/algorithms"),method:"post",data:t})}function c(t){return Object(n["a"])({url:"/".concat(o["a"].ALGORITHM,"/algorithms"),method:"put",data:t})}function u(t){return Object(n["a"])({url:"/".concat(o["a"].ALGORITHM,"/algorithms"),method:"delete",data:t})}function l(){return Object(n["a"])({url:"/".concat(o["a"].ALGORITHM,"/algorithms/myAlgorithmCount"),method:"get"})}function d(){return Object(n["a"])({url:"/".concat(o["a"].ALGORITHM,"/algorithms/getInferenceAlgorithm"),method:"get"})}function f(t){return Object(n["a"])({url:"/".concat(o["a"].ALGORITHM,"/algorithms/findAlgorithmByName"),method:"get",params:t})}},a40c:function(t,e,r){"use strict";r.d(e,"b",(function(){return c})),r.d(e,"d",(function(){return u})),r.d(e,"e",(function(){return l})),r.d(e,"c",(function(){return d})),r.d(e,"g",(function(){return f})),r.d(e,"f",(function(){return h}));var n=r("b775"),o=r("f121");function a(t){return Object(n["a"])({url:"/".concat(o["a"].IMAGE,"/ptImage/list"),method:"get",params:t})}function i(t){return Object(n["a"])({url:"/".concat(o["a"].IMAGE,"/ptImage"),method:"post",data:t})}function s(t){return Object(n["a"])({url:"/".concat(o["a"].IMAGE,"/ptImage"),method:"put",data:t})}function c(t){return Object(n["a"])({url:"/".concat(o["a"].IMAGE,"/ptImage"),method:"delete",data:t})}function u(t){return Object(n["a"])({url:"/".concat(o["a"].IMAGE,"/ptImage/imageNameList"),method:"get",params:t})}function l(t){return Object(n["a"])({url:"/".concat(o["a"].IMAGE,"/ptImage"),method:"get",params:t})}function d(t){return Object(n["a"])({url:"/".concat(o["a"].IMAGE,"/ptImage/imageDefault"),method:"get",params:t})}function f(t){return Object(n["a"])({url:"/".concat(o["a"].IMAGE,"/ptImage/imageDefault"),method:"put",params:t})}function h(){return Object(n["a"])({url:"/".concat(o["a"].IMAGE,"/ptImage/terminalImageList"),method:"get"})}e["a"]={list:a,add:i,edit:s}},e659:function(t,e,r){"use strict";r.d(e,"g",(function(){return a})),r.d(e,"a",(function(){return i})),r.d(e,"j",(function(){return c})),r.d(e,"k",(function(){return u})),r.d(e,"i",(function(){return l})),r.d(e,"h",(function(){return d})),r.d(e,"c",(function(){return f})),r.d(e,"f",(function(){return h})),r.d(e,"e",(function(){return p})),r.d(e,"b",(function(){return m}));var n=r("b775"),o=r("f121");function a(t){return Object(n["a"])({url:"/".concat(o["a"].NOTEBOOK,"/notebooks"),method:"get",params:t})}function i(t){return Object(n["a"])({url:"/".concat(o["a"].NOTEBOOK,"/notebooks"),method:"post",data:t})}function s(t){return Object(n["a"])({url:"/".concat(o["a"].NOTEBOOK,"/notebooks"),method:"delete",data:t})}function c(t){return Object(n["a"])({url:"/".concat(o["a"].NOTEBOOK,"/notebooks/start"),method:"put",params:t})}function u(t){return Object(n["a"])({url:"/".concat(o["a"].NOTEBOOK,"/notebooks/stop"),method:"put",params:t})}function l(t){return Object(n["a"])({url:"/".concat(o["a"].NOTEBOOK,"/notebooks/").concat(t),method:"get"})}function d(){return Object(n["a"])({url:"/".concat(o["a"].NOTEBOOK,"/notebooks/run-number"),method:"get"})}function f(t,e){return Object(n["a"])({url:"/".concat(o["a"].NOTEBOOK,"/notebooks/create/").concat(t),method:"post",data:e})}function h(t){return Object(n["a"])({url:"/".concat(o["a"].NOTEBOOK,"/notebooks/").concat(t,"/get-address"),method:"get"})}function p(t){return Object(n["a"])({url:"/".concat(o["a"].NOTEBOOK,"/notebooks/detail"),method:"post",data:t})}function m(){return Object(n["a"])({url:"/".concat(o["a"].NOTEBOOK,"/notebooks/batchStop"),method:"put"})}e["d"]={list:a,add:i,del:s,start:c,stop:u,open:l,detail:p}},e9e5:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"job-detail-container"},[r("el-row",{staticClass:"row"},[r("el-col",{attrs:{xl:t.isJob?12:24,span:24}},[r("div",{staticClass:"label"},[t._v("名称")]),t._v(" "),r("div",{staticClass:"text"},[t._v(t._s(t.isJob?t.item.trainName:t.item.paramName))])]),t._v(" "),t.isJob?r("el-col",{attrs:{xl:12,span:24}},[r("div",{staticClass:"label"},[t._v("版本")]),t._v(" "),r("div",{staticClass:"text"},[t._v(t._s(t.item.trainVersion))])]):t._e(),t._v(" "),t.isJob&&t.item.parentTrainVersion?r("el-col",{attrs:{xl:12,span:24}},[r("div",{staticClass:"label"},[t._v("父版本")]),t._v(" "),r("div",{staticClass:"text"},[t._v(t._s(t.item.parentTrainVersion))])]):t._e(),t._v(" "),r("el-col",{attrs:{span:24}},[r("div",{staticClass:"label"},[t._v("描述")]),t._v(" "),r("div",{staticClass:"text"},[t._v(t._s(t.item.description))])]),t._v(" "),r("el-col",{attrs:{xl:12,span:24}},[r("div",{staticClass:"label"},[t._v("训练数据集")]),t._v(" "),t.item.modelResource!==t.MODEL_RESOURCE_ENUM.ATLAS?r("div",{staticClass:"text"},[t._v("\n        "+t._s(t.item.dataSourceName)+"\n      ")]):r("div",{staticClass:"text"},[t._v(t._s(t.item.dataSourceNameList))])]),t._v(" "),t.item.modelResource!==t.MODEL_RESOURCE_ENUM.ATLAS?r("el-col",{attrs:{xl:12,span:24}},[r("div",{staticClass:"label"},[t._v("验证数据集")]),t._v(" "),r("div",{staticClass:"text"},[t._v(t._s(t.item.valDataSourceName))])]):t._e(),t._v(" "),t.useNotebook?t._e():r("el-col",{attrs:{xl:12,span:24}},[r("div",{staticClass:"label"},[t._v("算法")]),t._v(" "),r("div",{staticClass:"text"},[r("div",{staticClass:"dib"},[t._v(t._s(t.item.algorithmName))]),t._v(" "),t.isParam?t._e():r("el-tooltip",{attrs:{content:t.algorithmEditTooltip,placement:"top"}},[r("div",{staticClass:"dib"},[t.item.algorithmCodeDir?r("i",{staticClass:"el-icon-edit primary",class:{cp:!t.editLoading},on:{click:function(e){return t.goEditAlgorithm(t.item.algorithmId,t.item.algorithmCodeDir)}}}):r("i",{staticClass:"el-icon-question primary"})])]),t._v(" "),t.editLoading?r("i",{staticClass:"el-icon-loading"}):t._e()],1)]),t._v(" "),t.useNotebook?t._e():r("el-col",{attrs:{xl:12,span:24}},[r("div",{staticClass:"label"},[t._v("镜像名称")]),t._v(" "),r("div",{staticClass:"text"},[t._v(t._s(t.item.imageName))])]),t._v(" "),t.useNotebook?t._e():r("el-col",{attrs:{xl:12,span:24}},[r("div",{staticClass:"label"},[t._v("镜像版本")]),t._v(" "),r("div",{staticClass:"text"},[t._v(t._s(t.item.imageTag))])]),t._v(" "),t.useNotebook?r("el-col",{attrs:{xl:12,span:24}},[r("div",{staticClass:"label"},[t._v("Notebook 信息")]),t._v(" "),r("div",{staticClass:"text"},[t._v(t._s(t.item.notebookName))])]):t._e(),t._v(" "),[t.MODEL_RESOURCE_ENUM.CUSTOM,t.MODEL_RESOURCE_ENUM.PRESET].includes(t.item.modelResource)?r("el-col",{attrs:{xl:12,span:24}},[r("div",{staticClass:"label"},[t._v("模型名称")]),t._v(" "),r("div",{staticClass:"text"},[t._v(t._s(t.trainModel.name))])]):t._e(),t._v(" "),t.item.modelResource===t.MODEL_RESOURCE_ENUM.ATLAS?[r("el-col",{attrs:{xl:12,span:24}},[r("div",{staticClass:"label"},[t._v("教师模型列表")]),t._v(" "),r("div",{staticClass:"text"},[t._v(t._s(t.teacherModelNames))])]),t._v(" "),r("el-col",{attrs:{xl:12,span:24}},[r("div",{staticClass:"label"},[t._v("学生模型列表")]),t._v(" "),r("div",{staticClass:"text"},[t._v(t._s(t.studentModelNames))])])]:t._e()],2),t._v(" "),r("el-row",{staticClass:"row mt-0"},[t.isParam?t._e():r("el-col",{attrs:{span:12}},[r("div",{staticClass:"label"},[t._v("输出下载")]),t._v(" "),r("div",{staticClass:"text"},[r("el-tooltip",{attrs:{effect:"dark",content:t.outputDisableTooltip,disabled:!t.outputDownloadDisable,placement:"top"}},[r("div",[r("el-button",{attrs:{size:"mini",disabled:t.outputDownloadDisable},on:{click:function(){return t.download(t.item.outPath,t.item.jobName+"_out.zip")}}},[t._v("下载")])],1)])],1)]),t._v(" "),t.isParam?t._e():r("el-col",{attrs:{span:12}},[r("div",{staticClass:"label"},[t._v("模型下载")]),t._v(" "),r("div",{staticClass:"text"},[r("el-tooltip",{attrs:{effect:"dark",content:"训练选择的算法没有包含模型输出参数，无法下载模型",disabled:Boolean(t.item.modelPath),placement:"top"}},[r("div",[r("el-button",{attrs:{size:"mini",disabled:!t.item.modelPath},on:{click:function(){return t.choosePath(t.item)}}},[t._v("下载")])],1)])],1)]),t._v(" "),r("el-col",{staticStyle:{display:"flex"},attrs:{span:24}},[r("div",{staticClass:"label"},[t._v("运行命令")]),t._v(" "),r("div",{staticClass:"text long-text"},[t._v(t._s(t.preview))])]),t._v(" "),r("el-col",{attrs:{xl:12,span:24}},[r("div",{staticClass:"label"},[t._v("训练类型")]),t._v(" "),r("div",{staticClass:"text"},[t._v(t._s(t.TRAINING_TYPE_MAP[t.item.trainType]))])]),t._v(" "),r("el-col",{attrs:{xl:12,span:24}},[r("div",{staticClass:"label"},[t._v("节点数")]),t._v(" "),r("div",{staticClass:"text"},[t._v(t._s(t.item.resourcesPoolNode))])]),t._v(" "),r("el-col",{attrs:{span:24}},[r("div",{staticClass:"label"},[t._v("节点规格")]),t._v(" "),r("div",{staticClass:"text"},[t._v("\n        "+t._s(t.item.trainJobSpecsName)+"\n      ")])])],1),t._v(" "),r("path-select-dialog",{ref:"pathSelect",attrs:{"class-key":"ModelDownload",type:"modelDownload"},on:{chooseDone:t.chooseDone}})],1)},o=[],a=r("2ef0"),i=r("ed08"),s=r("e659"),c=r("cce0"),u=r("b788"),l=r("03b8");function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function f(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */f=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(P){c=function(t,e,r){return t[e]=r}}function u(t,e,r,o){var a=e&&e.prototype instanceof p?e:p,i=Object.create(a.prototype),s=new j(o||[]);return n(i,"_invoke",{value:L(t,r,s)}),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(P){return{type:"throw",arg:P}}}t.wrap=u;var h={};function p(){}function m(){}function v(){}var g={};c(g,a,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(T([])));y&&y!==e&&r.call(y,a)&&(g=y);var _=v.prototype=p.prototype=Object.create(g);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function o(n,a,i,s){var c=l(t[n],t,a);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"==d(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,i,s)}),(function(t){o("throw",t,i,s)})):e.resolve(f).then((function(t){u.value=t,i(u)}),(function(t){return o("throw",t,i,s)}))}s(c.arg)}var a;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return a=a?a.then(n,n):n()}})}function L(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return E()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var s=N(i,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=l(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function N(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,N(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,h;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function T(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:E}}function E(){return{value:void 0,done:!0}}return m.prototype=v,n(_,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:m,configurable:!0}),m.displayName=c(v,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,s,"GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},w(O.prototype),c(O.prototype,i,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},w(_),c(_,s,"Generator"),c(_,a,(function(){return this})),c(_,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=T,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:T(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function h(t,e){var r="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=p(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){s=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function p(t,e){if(t){if("string"===typeof t)return m(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function v(t,e,r,n,o,a,i){try{var s=t[a](i),c=s.value}catch(u){return void r(u)}s.done?e(c):Promise.resolve(c).then(n,o)}function g(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){v(a,n,o,i,s,"next",t)}function s(t){v(a,n,o,i,s,"throw",t)}i(void 0)}))}}var b={name:"JobDetail",components:{pathSelectDialog:u["default"]},props:{item:{type:Object,default:function(){return{}}},type:{type:String,default:"job"}},data:function(){return{MODEL_RESOURCE_ENUM:i["k"],runParamsList:[],editLoading:!1,TRAINING_TYPE_MAP:l["TRAINING_TYPE_MAP"],modelList:[],teacherModelList:[],studentModelList:[],notifyInstance:null}},computed:{preview:function(){var t=this.item;if(t.modelResource===i["k"].ATLAS){var e=t.runCommand;return e+="  --teacher_path_list=${teacher_path_1,teacher_path_2,...}",e+="  --student_path_list=${student_path}",e+=" --atlas_dataset_paths=${atlas_dataset_path_1,atlas_dataset_path_2,...)}",t.resourcesPoolType&&(e+=" --gpu_num_per_node=${gpu_num}"),t.resourcesPoolNode>1&&(e+=" --num_nodes=".concat(t.resourcesPoolNode," --node_ips=${node_ips}")),e}var r=t.runCommand,n=t.runParamsNameMap,o=null!==n&&void 0!==n&&n.dataUrl?"  --".concat(n.dataUrl,"=/dataset "):"  --data_url=/dataset",a=null!==n&&void 0!==n&&n.valDataUrl?"  --".concat(n.valDataUrl,"=/valdataset "):"  --val_data_url=/valdataset",s=null!==n&&void 0!==n&&n.modelLoadDir?"  --".concat(n.modelLoadDir,"=/modeldir "):"  --model_load_dir=/modeldir",c=null!==n&&void 0!==n&&n.trainModelOut?"  --".concat(n.trainModelOut,"=/workspace/model-out "):"  --train_model_out=/workspace/model-out";return r+=t.dataSourceName&&t.dataSourcePath?o:"",r+=t.valDataSourceName&&t.valDataSourcePath?a:"",r+=t.modelId&&t.modelBranchId?s:"",r+=c,r+="  --train_out=/workspace/out",t.resourcesPoolType&&(r+=" --gpu_num_per_node=${gpu_num}"),t.resourcesPoolNode>1&&(r+=" --num_nodes=".concat(t.resourcesPoolNode," --node_ips=${node_ips}")),r},outputDisableTooltip:function(){switch(this.item.trainStatus){case l["TRAINING_STATUS_ENUM"].PENDING:return"训练尚未开始，无法下载训练输出";case l["TRAINING_STATUS_ENUM"].CREATE_FAILED:return"训练创建失败，无法下载训练输出"}return this.item.outPath?null:"算法没有指定输出路径，无法下载训练输出"},algorithmEditTooltip:function(){return this.item.algorithmCodeDir?"算法在线编辑":"算法不存在或不可编辑"},outputDownloadDisable:function(){return[l["TRAINING_STATUS_ENUM"].PENDING,l["TRAINING_STATUS_ENUM"].CREATE_FAILED].includes(this.item.trainStatus)||!this.item.outPath},isJob:function(){return"job"===this.type},isParam:function(){return"param"===this.type},trainModel:function(){return this.modelList.length?this.modelList[0]:{}},teacherModelNames:function(){return this.teacherModelList.map((function(t){return t.name})).join(", ")},studentModelNames:function(){return this.studentModelList.map((function(t){return t.name})).join(", ")},useNotebook:function(){return Boolean(this.item.notebookId)}},watch:{item:{handler:function(){var t=g(f().mark((function t(e){var r,n,o,s,u,l,d,p;return f().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.runParamsList=Object(i["B"])(e.runParams),!Object(a["isNil"])(e.modelResource)){t.next=3;break}return t.abrupt("return");case 3:if(e.modelResource!==i["k"].ATLAS){t.next=9;break}if(this.studentModelList=[],this.studentModelList.push({name:e.studentModelStruct}),null!==e&&void 0!==e&&e.baseAtlasParams){this.teacherModelList=[],r=[],n=h(e.baseAtlasParams);try{for(n.s();!(o=n.n()).done;)s=o.value,s.teacherModelStruct&&this.teacherModelList.push({name:s.teacherModelStruct}),s.datasetVersion?r.push("".concat(s.dataSourceName,":").concat(s.datasetVersion)):r.push(s.dataSourceName)}catch(f){n.e(f)}finally{n.f()}e.dataSourceNameList=r.join(",")}t.next=18;break;case 9:return t.next=11,Object(c["k"])({modelResource:e.modelResource,modelId:e.modelId||void 0,modelBranchId:e.modelBranchId||void 0,teacherModelIds:e.teacherModelIds||void 0,studentModelIds:e.studentModelIds||void 0});case 11:u=t.sent,l=u.modelList,d=u.teacherModelList,p=u.studentModelList,this.modelList=l||[],this.teacherModelList=d||[],this.studentModelList=p||[];case 18:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),immediate:!0}},beforeDestroy:function(){this.editLoading=!1,this.notifyInstance&&this.notifyInstance.close()},methods:{choosePath:function(t){this.$refs.pathSelect.show({resumePath:"".concat(t.modelPath,"/"),fileName:"".concat(t.jobName,"_model.zip")})},chooseDone:function(t,e){this.download(t.path,t.fileName,e)},download:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Object(i["G"])(t,e,{flat:!0,filter:r.length?function(e){return e.filter((function(e){return r.some((function(r){return e.name.startsWith("".concat(t,"/").concat(r,"/"))||e.name==="".concat(t,"/").concat(r)}))}))}:null}),this.$message({message:"请查看下载文件",type:"success"})},goEditAlgorithm:function(){var t=g(f().mark((function t(e,r){var n,o=this;return f().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.editLoading){t.next=2;break}return t.abrupt("return");case 2:return this.editLoading=!0,this.notifyInstance=this.$notify({title:"正在启动 Notebook",message:"正在启动 Notebook，请稍等",iconClass:"el-icon-loading",duration:0}),t.next=6,Object(s["c"])(1,{sourceId:e,sourceFilePath:r}).finally((function(){o.editLoading=!1}));case 6:n=t.sent,0===n.status&&n.url?this.openNotebook(n.url,n.noteBookName):(this.editLoading=!0,this.getNotebookAddress(n.id,n.noteBookName));case 8:case"end":return t.stop()}}),t,this)})));function e(e,r){return t.apply(this,arguments)}return e}(),getNotebookAddress:function(t,e){var r=this;this.editLoading&&Object(s["f"])(t).then((function(n){n?r.openNotebook(n,e):setTimeout((function(){r.getNotebookAddress(t,e)}),1e3)})).catch((function(t){throw r.editLoading=!1,new Error(t)}))},openNotebook:function(t,e){window.open(t),this.$message.success("Notebook已启动."),this.editLoading=!1,this.$router.push({name:"Notebook",params:{noteBookName:e}})}}},y=b,_=(r("32deb"),r("2877")),w=Object(_["a"])(y,n,o,!1,null,"6d97f8eb",null);e["default"]=w.exports},eddc:function(t,e,r){"use strict";r.d(e,"a",(function(){return i})),r.d(e,"d",(function(){return s})),r.d(e,"c",(function(){return c}));var n=r("b775"),o=r("f121");function a(t){return Object(n["a"])({url:"/".concat(o["a"].TRAIN,"/trainParams"),method:"get",params:t})}function i(t){return Object(n["a"])({url:"/".concat(o["a"].TRAIN,"/trainParams"),method:"post",data:t})}function s(t){return Object(n["a"])({url:"/".concat(o["a"].TRAIN,"/trainParams"),method:"put",data:t})}function c(t){return Object(n["a"])({url:"/".concat(o["a"].TRAIN,"/trainParams"),method:"delete",data:t})}e["b"]={list:a,add:i,edit:s,del:c}}}]);