(window["webpackJsonp_dubhe_web"]=window["webpackJsonp_dubhe_web"]||[]).push([["vendors~dataset-pointCloud-editor~dataset-pointCloud-editor-core-editor~dataset-pointCloud-editor-co~fdf70f1b"],{a550:function(t,e,s){"use strict";s.d(e,"a",(function(){return K}));
/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */
const i={LEFT:1,RIGHT:2,MIDDLE:4},n=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768});function o(t){return t.isPerspectiveCamera}function r(t){return t.isOrthographicCamera}const a=2*Math.PI,h=Math.PI/2,l=1e-5;function c(t,e=l){return Math.abs(t)<e}function d(t,e,s=l){return c(t-e,s)}function _(t,e){return Math.round(t/e)*e}function m(t){return isFinite(t)?t:t<0?-Number.MAX_VALUE:Number.MAX_VALUE}function p(t){return Math.abs(t)<Number.MAX_VALUE?t:t*(1/0)}function u(t,e){e.set(0,0),t.forEach(t=>{e.x+=t.clientX,e.y+=t.clientY}),e.x/=t.length,e.y/=t.length}function f(t,e){return!!r(t)&&(console.warn(e+" is not supported in OrthographicCamera"),!0)}function E(t){return t.invert?t.invert():t.inverse(),t}class y{constructor(){this._listeners={}}addEventListener(t,e){const s=this._listeners;void 0===s[t]&&(s[t]=[]),-1===s[t].indexOf(e)&&s[t].push(e)}hasEventListener(t,e){const s=this._listeners;return void 0!==s[t]&&-1!==s[t].indexOf(e)}removeEventListener(t,e){const s=this._listeners,i=s[t];if(void 0!==i){const t=i.indexOf(e);-1!==t&&i.splice(t,1)}}removeAllEventListeners(t){t?Array.isArray(this._listeners[t])&&(this._listeners[t].length=0):this._listeners={}}dispatchEvent(t){const e=this._listeners,s=e[t.type];if(void 0!==s){t.target=this;const e=s.slice(0);for(let s=0,i=e.length;s<i;s++)e[s].call(this,t)}}}const O="1.38.1",g=1/8,T="undefined"!==typeof window,v=T&&/Mac/.test(navigator.platform),x=!(T&&"PointerEvent"in window);let w,C,A,L,U,F,z,b,D,S,R,P,M,I,H,Y,V,k,B,N,Z,X;class K extends y{static install(t){w=t.THREE,C=Object.freeze(new w.Vector3(0,0,0)),A=Object.freeze(new w.Vector3(0,1,0)),L=Object.freeze(new w.Vector3(0,0,1)),U=new w.Vector2,F=new w.Vector3,z=new w.Vector3,b=new w.Vector3,D=new w.Vector3,S=new w.Vector3,R=new w.Vector3,P=new w.Vector3,M=new w.Vector3,I=new w.Spherical,H=new w.Spherical,Y=new w.Box3,V=new w.Box3,k=new w.Sphere,B=new w.Quaternion,N=new w.Quaternion,Z=new w.Matrix4,X=new w.Raycaster}static get ACTION(){return n}constructor(t,e){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=0,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.dampingFactor=.05,this.draggingDampingFactor=.25,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=n.NONE,this._viewport=null,this._affectOffset=!1,this._dollyControlAmount=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._activePointers=[],this._truckInternal=(t,e,s)=>{if(o(this._camera)){const i=F.copy(this._camera.position).sub(this._target),n=this._camera.getEffectiveFOV()*w.MathUtils.DEG2RAD,o=i.length()*Math.tan(.5*n),r=this.truckSpeed*t*o/this._elementRect.height,a=this.truckSpeed*e*o/this._elementRect.height;this.verticalDragToForward?(s?this.setFocalOffset(this._focalOffsetEnd.x+r,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(r,0,!0),this.forward(-a,!0)):s?this.setFocalOffset(this._focalOffsetEnd.x+r,this._focalOffsetEnd.y+a,this._focalOffsetEnd.z,!0):this.truck(r,a,!0)}else if(r(this._camera)){const i=this._camera,n=t*(i.right-i.left)/i.zoom/this._elementRect.width,o=e*(i.top-i.bottom)/i.zoom/this._elementRect.height;s?this.setFocalOffset(this._focalOffsetEnd.x+n,this._focalOffsetEnd.y+o,this._focalOffsetEnd.z,!0):this.truck(n,o,!0)}},this._rotateInternal=(t,e)=>{const s=a*this.azimuthRotateSpeed*t/this._elementRect.height,i=a*this.polarRotateSpeed*e/this._elementRect.height;this.rotate(s,i,!0)},this._dollyInternal=(t,e,s)=>{const i=Math.pow(.95,-t*this.dollySpeed),n=this._sphericalEnd.radius*i,o=this._sphericalEnd.radius,r=o*(t>=0?-1:1);this.dollyTo(n),this.infinityDolly&&(n<this.minDistance||this.maxDistance===this.minDistance)&&(this._camera.getWorldDirection(F),this._targetEnd.add(F.normalize().multiplyScalar(r)),this._target.add(F.normalize().multiplyScalar(r))),this.dollyToCursor&&(this._dollyControlAmount+=this._sphericalEnd.radius-o,this.infinityDolly&&(n<this.minDistance||this.maxDistance===this.minDistance)&&(this._dollyControlAmount-=r),this._dollyControlCoord.set(e,s))},this._zoomInternal=(t,e,s)=>{const i=Math.pow(.95,t*this.dollySpeed),n=this._zoomEnd;this.zoomTo(this._zoom*i),this.dollyToCursor&&(this._dollyControlAmount+=this._zoomEnd-n,this._dollyControlCoord.set(e,s))},"undefined"===typeof w&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=t,this._yAxisUpSpace=(new w.Quaternion).setFromUnitVectors(this._camera.up,A),this._yAxisUpSpaceInverse=E(this._yAxisUpSpace.clone()),this._state=n.NONE,this._target=new w.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new w.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=(new w.Spherical).setFromVector3(F.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._nearPlaneCorners=[new w.Vector3,new w.Vector3,new w.Vector3,new w.Vector3],this._updateNearPlaneCorners(),this._boundary=new w.Box3(new w.Vector3(-1/0,-1/0,-1/0),new w.Vector3(1/0,1/0,1/0)),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlAmount=0,this._dollyControlCoord=new w.Vector2,this.mouseButtons={left:n.ROTATE,middle:n.DOLLY,right:n.TRUCK,wheel:o(this._camera)?n.DOLLY:r(this._camera)?n.ZOOM:n.NONE},this.touches={one:n.TOUCH_ROTATE,two:o(this._camera)?n.TOUCH_DOLLY_TRUCK:r(this._camera)?n.TOUCH_ZOOM_TRUCK:n.NONE,three:n.TOUCH_TRUCK};const s=new w.Vector2,h=new w.Vector2,l=new w.Vector2,c=t=>{if(!this._enabled||!this._domElement)return;const e={pointerId:t.pointerId,clientX:t.clientX,clientY:t.clientY,deltaX:0,deltaY:0};this._activePointers.push(e),this._domElement.ownerDocument.removeEventListener("pointermove",m,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",y),this._domElement.ownerDocument.addEventListener("pointermove",m,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",y),b(t)},d=t=>{if(!this._enabled||!this._domElement)return;const e={pointerId:0,clientX:t.clientX,clientY:t.clientY,deltaX:0,deltaY:0};this._activePointers.push(e),this._domElement.ownerDocument.removeEventListener("mousemove",p),this._domElement.ownerDocument.removeEventListener("mouseup",O),this._domElement.ownerDocument.addEventListener("mousemove",p),this._domElement.ownerDocument.addEventListener("mouseup",O),b(t)},_=t=>{this._enabled&&this._domElement&&(t.preventDefault(),Array.prototype.forEach.call(t.changedTouches,t=>{const e={pointerId:t.identifier,clientX:t.clientX,clientY:t.clientY,deltaX:0,deltaY:0};this._activePointers.push(e)}),this._domElement.ownerDocument.removeEventListener("touchmove",f,{passive:!1}),this._domElement.ownerDocument.removeEventListener("touchend",T),this._domElement.ownerDocument.addEventListener("touchmove",f,{passive:!1}),this._domElement.ownerDocument.addEventListener("touchend",T),b(t))},m=t=>{t.cancelable&&t.preventDefault();const e=t.pointerId,s=this._findPointerById(e);if(s){if(s.clientX=t.clientX,s.clientY=t.clientY,s.deltaX=t.movementX,s.deltaY=t.movementY,"touch"===t.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=0,(t.buttons&i.LEFT)===i.LEFT&&(this._state=this._state|this.mouseButtons.left),(t.buttons&i.MIDDLE)===i.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(t.buttons&i.RIGHT)===i.RIGHT&&(this._state=this._state|this.mouseButtons.right);D()}},p=t=>{const e=this._findPointerById(0);e&&(e.clientX=t.clientX,e.clientY=t.clientY,e.deltaX=t.movementX,e.deltaY=t.movementY,this._state=0,(t.buttons&i.LEFT)===i.LEFT&&(this._state=this._state|this.mouseButtons.left),(t.buttons&i.MIDDLE)===i.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(t.buttons&i.RIGHT)===i.RIGHT&&(this._state=this._state|this.mouseButtons.right),D())},f=t=>{t.cancelable&&t.preventDefault(),Array.prototype.forEach.call(t.changedTouches,t=>{const e=t.identifier,s=this._findPointerById(e);s&&(s.clientX=t.clientX,s.clientY=t.clientY)}),D()},y=t=>{const e=t.pointerId,s=this._findPointerById(e);if(s&&this._activePointers.splice(this._activePointers.indexOf(s),1),"touch"===t.pointerType)switch(this._activePointers.length){case 0:this._state=n.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=n.NONE;S()},O=()=>{const t=this._findPointerById(0);t&&this._activePointers.splice(this._activePointers.indexOf(t),1),this._state=n.NONE,S()},T=t=>{switch(Array.prototype.forEach.call(t.changedTouches,t=>{const e=t.identifier,s=this._findPointerById(e);s&&this._activePointers.splice(this._activePointers.indexOf(s),1)}),this._activePointers.length){case 0:this._state=n.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}S()};let C=-1;const L=t=>{if(!this._enabled||this.mouseButtons.wheel===n.NONE)return;if(t.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===n.ROTATE||this.mouseButtons.wheel===n.TRUCK){const t=performance.now();C-t<1e3&&this._getClientRect(this._elementRect),C=t}const e=v?-1:-3,s=1===t.deltaMode?t.deltaY/e:t.deltaY/(10*e),i=this.dollyToCursor?(t.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,o=this.dollyToCursor?(t.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case n.ROTATE:this._rotateInternal(t.deltaX,t.deltaY);break;case n.TRUCK:this._truckInternal(t.deltaX,t.deltaY,!1);break;case n.OFFSET:this._truckInternal(t.deltaX,t.deltaY,!0);break;case n.DOLLY:this._dollyInternal(-s,i,o);break;case n.ZOOM:this._zoomInternal(-s,i,o);break}this.dispatchEvent({type:"control"})},z=t=>{this._enabled&&t.preventDefault()},b=t=>{if(!this._enabled)return;u(this._activePointers,U),this._getClientRect(this._elementRect),s.copy(U),h.copy(U);const e=this._activePointers.length>=2;if(e){const t=U.x-this._activePointers[1].clientX,e=U.y-this._activePointers[1].clientY,s=Math.sqrt(t*t+e*e);l.set(0,s);const i=.5*(this._activePointers[0].clientX+this._activePointers[1].clientX),n=.5*(this._activePointers[0].clientY+this._activePointers[1].clientY);h.set(i,n)}if("touches"in t||"pointerType"in t&&"touch"===t.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=0,(t.buttons&i.LEFT)===i.LEFT&&(this._state=this._state|this.mouseButtons.left),(t.buttons&i.MIDDLE)===i.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(t.buttons&i.RIGHT)===i.RIGHT&&(this._state=this._state|this.mouseButtons.right);this.dispatchEvent({type:"controlstart"})},D=()=>{if(!this._enabled)return;u(this._activePointers,U);const t=this._domElement&&document.pointerLockElement===this._domElement,e=t?-this._activePointers[0].deltaX:h.x-U.x,i=t?-this._activePointers[0].deltaY:h.y-U.y;if(h.copy(U),(this._state&n.ROTATE)!==n.ROTATE&&(this._state&n.TOUCH_ROTATE)!==n.TOUCH_ROTATE&&(this._state&n.TOUCH_DOLLY_ROTATE)!==n.TOUCH_DOLLY_ROTATE&&(this._state&n.TOUCH_ZOOM_ROTATE)!==n.TOUCH_ZOOM_ROTATE||this._rotateInternal(e,i),(this._state&n.DOLLY)===n.DOLLY||(this._state&n.ZOOM)===n.ZOOM){const t=this.dollyToCursor?(s.x-this._elementRect.x)/this._elementRect.width*2-1:0,e=this.dollyToCursor?(s.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&n.DOLLY)===n.DOLLY?this._dollyInternal(i*g,t,e):this._zoomInternal(i*g,t,e)}if((this._state&n.TOUCH_DOLLY)===n.TOUCH_DOLLY||(this._state&n.TOUCH_ZOOM)===n.TOUCH_ZOOM||(this._state&n.TOUCH_DOLLY_TRUCK)===n.TOUCH_DOLLY_TRUCK||(this._state&n.TOUCH_ZOOM_TRUCK)===n.TOUCH_ZOOM_TRUCK||(this._state&n.TOUCH_DOLLY_OFFSET)===n.TOUCH_DOLLY_OFFSET||(this._state&n.TOUCH_ZOOM_OFFSET)===n.TOUCH_ZOOM_OFFSET||(this._state&n.TOUCH_DOLLY_ROTATE)===n.TOUCH_DOLLY_ROTATE||(this._state&n.TOUCH_ZOOM_ROTATE)===n.TOUCH_ZOOM_ROTATE){const t=U.x-this._activePointers[1].clientX,e=U.y-this._activePointers[1].clientY,s=Math.sqrt(t*t+e*e),i=l.y-s;l.set(0,s);const o=this.dollyToCursor?(h.x-this._elementRect.x)/this._elementRect.width*2-1:0,r=this.dollyToCursor?(h.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&n.TOUCH_DOLLY)===n.TOUCH_DOLLY||(this._state&n.TOUCH_DOLLY_ROTATE)===n.TOUCH_DOLLY_ROTATE||(this._state&n.TOUCH_DOLLY_TRUCK)===n.TOUCH_DOLLY_TRUCK||(this._state&n.TOUCH_DOLLY_OFFSET)===n.TOUCH_DOLLY_OFFSET?this._dollyInternal(i*g,o,r):this._zoomInternal(i*g,o,r)}(this._state&n.TRUCK)!==n.TRUCK&&(this._state&n.TOUCH_TRUCK)!==n.TOUCH_TRUCK&&(this._state&n.TOUCH_DOLLY_TRUCK)!==n.TOUCH_DOLLY_TRUCK&&(this._state&n.TOUCH_ZOOM_TRUCK)!==n.TOUCH_ZOOM_TRUCK||this._truckInternal(e,i,!1),(this._state&n.OFFSET)!==n.OFFSET&&(this._state&n.TOUCH_OFFSET)!==n.TOUCH_OFFSET&&(this._state&n.TOUCH_DOLLY_OFFSET)!==n.TOUCH_DOLLY_OFFSET&&(this._state&n.TOUCH_ZOOM_OFFSET)!==n.TOUCH_ZOOM_OFFSET||this._truckInternal(e,i,!0),this.dispatchEvent({type:"control"})},S=()=>{u(this._activePointers,U),h.copy(U),0===this._activePointers.length&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",m,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",y),this._domElement.ownerDocument.removeEventListener("touchmove",f,{passive:!1}),this._domElement.ownerDocument.removeEventListener("touchend",T),this.dispatchEvent({type:"controlend"}))};this._addAllEventListeners=t=>{this._domElement=t,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",c),x&&this._domElement.addEventListener("mousedown",d),x&&this._domElement.addEventListener("touchstart",_),this._domElement.addEventListener("pointercancel",y),this._domElement.addEventListener("wheel",L,{passive:!1}),this._domElement.addEventListener("contextmenu",z)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.removeEventListener("pointerdown",c),this._domElement.removeEventListener("mousedown",d),this._domElement.removeEventListener("touchstart",_),this._domElement.removeEventListener("pointercancel",y),this._domElement.removeEventListener("wheel",L,{passive:!1}),this._domElement.removeEventListener("contextmenu",z),this._domElement.ownerDocument.removeEventListener("pointermove",m,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",p),this._domElement.ownerDocument.removeEventListener("touchmove",f,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",y),this._domElement.ownerDocument.removeEventListener("mouseup",O),this._domElement.ownerDocument.removeEventListener("touchend",T))},this.cancel=()=>{this._state!==n.NONE&&(this._state=n.NONE,this._activePointers.length=0,S())},e&&this.connect(e),this.update(0)}get camera(){return this._camera}set camera(t){this._camera=t,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(t){this._domElement&&(this._enabled=t,t?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(t){this._spherical.radius===t&&this._sphericalEnd.radius===t||(this._spherical.radius=t,this._sphericalEnd.radius=t,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(t){this._spherical.theta===t&&this._sphericalEnd.theta===t||(this._spherical.theta=t,this._sphericalEnd.theta=t,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(t){this._spherical.phi===t&&this._sphericalEnd.phi===t||(this._spherical.phi=t,this._sphericalEnd.phi=t,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(t){this._boundaryEnclosesCamera=t,this._needsUpdate=!0}addEventListener(t,e){super.addEventListener(t,e)}removeEventListener(t,e){super.removeEventListener(t,e)}rotate(t,e,s=!1){return this.rotateTo(this._sphericalEnd.theta+t,this._sphericalEnd.phi+e,s)}rotateAzimuthTo(t,e=!1){return this.rotateTo(t,this._sphericalEnd.phi,e)}rotatePolarTo(t,e=!1){return this.rotateTo(this._sphericalEnd.theta,t,e)}rotateTo(t,e,s=!1){const i=w.MathUtils.clamp(t,this.minAzimuthAngle,this.maxAzimuthAngle),n=w.MathUtils.clamp(e,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=i,this._sphericalEnd.phi=n,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,s||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const o=!s||d(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&d(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(o)}dolly(t,e=!1){return this.dollyTo(this._sphericalEnd.radius-t,e)}dollyTo(t,e=!1){const s=this._sphericalEnd.radius,i=w.MathUtils.clamp(t,this.minDistance,this.maxDistance),n=this.colliderMeshes.length>=1;if(n){const t=this._collisionTest(),e=d(t,this._spherical.radius),n=s>i;if(!n&&e)return Promise.resolve();this._sphericalEnd.radius=Math.min(i,t)}else this._sphericalEnd.radius=i;this._needsUpdate=!0,e||(this._spherical.radius=this._sphericalEnd.radius);const o=!e||d(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(o)}zoom(t,e=!1){return this.zoomTo(this._zoomEnd+t,e)}zoomTo(t,e=!1){this._zoomEnd=w.MathUtils.clamp(t,this.minZoom,this.maxZoom),this._needsUpdate=!0,e||(this._zoom=this._zoomEnd);const s=!e||d(this._zoom,this._zoomEnd,this.restThreshold);return this._createOnRestPromise(s)}pan(t,e,s=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(t,e,s)}truck(t,e,s=!1){this._camera.updateMatrix(),D.setFromMatrixColumn(this._camera.matrix,0),S.setFromMatrixColumn(this._camera.matrix,1),D.multiplyScalar(t),S.multiplyScalar(-e);const i=F.copy(D).add(S),n=z.copy(this._targetEnd).add(i);return this.moveTo(n.x,n.y,n.z,s)}forward(t,e=!1){F.setFromMatrixColumn(this._camera.matrix,0),F.crossVectors(this._camera.up,F),F.multiplyScalar(t);const s=z.copy(this._targetEnd).add(F);return this.moveTo(s.x,s.y,s.z,e)}moveTo(t,e,s,i=!1){const n=F.set(t,e,s).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,n,this.boundaryFriction),this._needsUpdate=!0,i||this._target.copy(this._targetEnd);const o=!i||d(this._target.x,this._targetEnd.x,this.restThreshold)&&d(this._target.y,this._targetEnd.y,this.restThreshold)&&d(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}fitToBox(t,e,{cover:s=!1,paddingLeft:i=0,paddingRight:n=0,paddingBottom:a=0,paddingTop:l=0}={}){const c=[],m=t.isBox3?Y.copy(t):Y.setFromObject(t);m.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const p=_(this._sphericalEnd.theta,h),u=_(this._sphericalEnd.phi,h);c.push(this.rotateTo(p,u,e));const f=F.setFromSpherical(this._sphericalEnd).normalize(),E=B.setFromUnitVectors(f,L),y=d(Math.abs(f.y),1);y&&E.multiply(N.setFromAxisAngle(A,p)),E.multiply(this._yAxisUpSpaceInverse);const O=V.makeEmpty();z.copy(m.min).applyQuaternion(E),O.expandByPoint(z),z.copy(m.min).setX(m.max.x).applyQuaternion(E),O.expandByPoint(z),z.copy(m.min).setY(m.max.y).applyQuaternion(E),O.expandByPoint(z),z.copy(m.max).setZ(m.min.z).applyQuaternion(E),O.expandByPoint(z),z.copy(m.min).setZ(m.max.z).applyQuaternion(E),O.expandByPoint(z),z.copy(m.max).setY(m.min.y).applyQuaternion(E),O.expandByPoint(z),z.copy(m.max).setX(m.min.x).applyQuaternion(E),O.expandByPoint(z),z.copy(m.max).applyQuaternion(E),O.expandByPoint(z),O.min.x-=i,O.min.y-=a,O.max.x+=n,O.max.y+=l,E.setFromUnitVectors(L,f),y&&E.premultiply(N.invert()),E.premultiply(this._yAxisUpSpace);const g=O.getSize(F),T=O.getCenter(z).applyQuaternion(E);if(o(this._camera)){const t=this.getDistanceToFitBox(g.x,g.y,g.z,s);c.push(this.moveTo(T.x,T.y,T.z,e)),c.push(this.dollyTo(t,e)),c.push(this.setFocalOffset(0,0,0,e))}else if(r(this._camera)){const t=this._camera,i=t.right-t.left,n=t.top-t.bottom,o=s?Math.max(i/g.x,n/g.y):Math.min(i/g.x,n/g.y);c.push(this.moveTo(T.x,T.y,T.z,e)),c.push(this.zoomTo(o,e)),c.push(this.setFocalOffset(0,0,0,e))}return Promise.all(c)}fitToSphere(t,e){const s=[],i=t instanceof w.Sphere,n=i?k.copy(t):Q(t,k);if(s.push(this.moveTo(n.center.x,n.center.y,n.center.z,e)),o(this._camera)){const t=this.getDistanceToFitSphere(n.radius);s.push(this.dollyTo(t,e))}else if(r(this._camera)){const t=this._camera.right-this._camera.left,i=this._camera.top-this._camera.bottom,o=2*n.radius,r=Math.min(t/o,i/o);s.push(this.zoomTo(r,e))}return s.push(this.setFocalOffset(0,0,0,e)),Promise.all(s)}setLookAt(t,e,s,i,n,o,r=!1){const a=z.set(i,n,o),h=F.set(t,e,s);this._targetEnd.copy(a),this._sphericalEnd.setFromVector3(h.sub(a).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,r||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const l=!r||d(this._target.x,this._targetEnd.x,this.restThreshold)&&d(this._target.y,this._targetEnd.y,this.restThreshold)&&d(this._target.z,this._targetEnd.z,this.restThreshold)&&d(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&d(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&d(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(l)}lerpLookAt(t,e,s,i,n,o,r,a,h,l,c,_,m,p=!1){const u=F.set(i,n,o),f=z.set(t,e,s);I.setFromVector3(f.sub(u).applyQuaternion(this._yAxisUpSpace));const E=b.set(l,c,_),y=z.set(r,a,h);H.setFromVector3(y.sub(E).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(u.lerp(E,m));const O=H.theta-I.theta,g=H.phi-I.phi,T=H.radius-I.radius;this._sphericalEnd.set(I.radius+T*m,I.phi+g*m,I.theta+O*m),this.normalizeRotations(),this._needsUpdate=!0,p||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const v=!p||d(this._target.x,this._targetEnd.x,this.restThreshold)&&d(this._target.y,this._targetEnd.y,this.restThreshold)&&d(this._target.z,this._targetEnd.z,this.restThreshold)&&d(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&d(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&d(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(v)}setPosition(t,e,s,i=!1){return this.setLookAt(t,e,s,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,i)}setTarget(t,e,s,i=!1){const n=this.getPosition(F),o=this.setLookAt(n.x,n.y,n.z,t,e,s,i);return this._sphericalEnd.phi=w.MathUtils.clamp(this.polarAngle,this.minPolarAngle,this.maxPolarAngle),o}setFocalOffset(t,e,s,i=!1){this._focalOffsetEnd.set(t,e,s),this._needsUpdate=!0,i||this._focalOffset.copy(this._focalOffsetEnd),this._affectOffset=!c(t)||!c(e)||!c(s);const n=!i||d(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&d(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&d(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}setOrbitPoint(t,e,s){this._camera.updateMatrixWorld(),D.setFromMatrixColumn(this._camera.matrixWorldInverse,0),S.setFromMatrixColumn(this._camera.matrixWorldInverse,1),R.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const i=F.set(t,e,s),n=i.distanceTo(this._camera.position),o=i.sub(this._camera.position);D.multiplyScalar(o.x),S.multiplyScalar(o.y),R.multiplyScalar(o.z),F.copy(D).add(S).add(R),F.z=F.z+n,this.dollyTo(n,!1),this.setFocalOffset(-F.x,F.y,-F.z,!1),this.moveTo(t,e,s,!1)}setBoundary(t){if(!t)return this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),void(this._needsUpdate=!0);this._boundary.copy(t),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(t,e,s,i){null!==t?(this._viewport=this._viewport||new w.Vector4,"number"===typeof t?this._viewport.set(t,e,s,i):this._viewport.copy(t)):this._viewport=null}getDistanceToFitBox(t,e,s,i=!1){if(f(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const n=t/e,o=this._camera.getEffectiveFOV()*w.MathUtils.DEG2RAD,r=this._camera.aspect,a=(i?n>r:n<r)?e:t/r;return.5*a/Math.tan(.5*o)+.5*s}getDistanceToFitSphere(t){if(f(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const e=this._camera.getEffectiveFOV()*w.MathUtils.DEG2RAD,s=2*Math.atan(Math.tan(.5*e)*this._camera.aspect),i=1<this._camera.aspect?e:s;return t/Math.sin(.5*i)}getTarget(t){const e=t&&t.isVector3?t:new w.Vector3;return e.copy(this._targetEnd)}getPosition(t){const e=t&&t.isVector3?t:new w.Vector3;return e.setFromSpherical(this._sphericalEnd).applyQuaternion(this._yAxisUpSpaceInverse).add(this._targetEnd)}getFocalOffset(t){const e=t&&t.isVector3?t:new w.Vector3;return e.copy(this._focalOffsetEnd)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%a,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=a),this._spherical.theta+=a*Math.round((this._sphericalEnd.theta-this._spherical.theta)/a)}reset(t=!1){const e=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,t),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,t),this.zoomTo(this._zoom0,t)];return Promise.all(e)}saveState(){this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,A),E(this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace))}update(t){const e=this._state===n.NONE?this.dampingFactor:this.draggingDampingFactor,s=Math.min(e*t*60,1),i=this._sphericalEnd.theta-this._spherical.theta,a=this._sphericalEnd.phi-this._spherical.phi,h=this._sphericalEnd.radius-this._spherical.radius,l=P.subVectors(this._targetEnd,this._target),d=M.subVectors(this._focalOffsetEnd,this._focalOffset);if(c(i)&&c(a)&&c(h)&&c(l.x)&&c(l.y)&&c(l.z)&&c(d.x)&&c(d.y)&&c(d.z)?(this._spherical.copy(this._sphericalEnd),this._target.copy(this._targetEnd),this._focalOffset.copy(this._focalOffsetEnd)):(this._spherical.set(this._spherical.radius+h*s,this._spherical.phi+a*s,this._spherical.theta+i*s),this._target.add(l.multiplyScalar(s)),this._focalOffset.add(d.multiplyScalar(s)),this._needsUpdate=!0),0!==this._dollyControlAmount){if(o(this._camera)){const t=this._camera,e=F.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).normalize().negate(),s=z.copy(e).cross(t.up).normalize();0===s.lengthSq()&&(s.x=1);const i=b.crossVectors(s,e),n=this._sphericalEnd.radius*Math.tan(t.getEffectiveFOV()*w.MathUtils.DEG2RAD*.5),o=this._sphericalEnd.radius-this._dollyControlAmount,r=(o-this._sphericalEnd.radius)/this._sphericalEnd.radius,a=F.copy(this._targetEnd).add(s.multiplyScalar(this._dollyControlCoord.x*n*t.aspect)).add(i.multiplyScalar(this._dollyControlCoord.y*n));this._targetEnd.lerp(a,r)}else if(r(this._camera)){const t=this._camera,e=F.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(t.near+t.far)/(t.near-t.far)).unproject(t),s=z.set(0,0,-1).applyQuaternion(t.quaternion),i=b.copy(e).add(s.multiplyScalar(-e.dot(t.up))),n=this._zoom-this._dollyControlAmount,o=-(n-this._zoomEnd)/this._zoom,r=F.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).normalize().negate(),a=this._targetEnd.dot(r);this._targetEnd.lerp(i,o);const h=this._targetEnd.dot(r),l=r.multiplyScalar(h-a);this._targetEnd.sub(l)}this._target.copy(this._targetEnd),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._dollyControlAmount=0}const _=this._zoomEnd-this._zoom;this._zoom+=_*s,this._camera.zoom!==this._zoom&&(c(_)&&(this._zoom=this._zoomEnd),this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0);const m=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,m),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),this._affectOffset&&(this._camera.updateMatrixWorld(),D.setFromMatrixColumn(this._camera.matrix,0),S.setFromMatrixColumn(this._camera.matrix,1),R.setFromMatrixColumn(this._camera.matrix,2),D.multiplyScalar(this._focalOffset.x),S.multiplyScalar(-this._focalOffset.y),R.multiplyScalar(this._focalOffset.z),F.copy(D).add(S).add(R),this._camera.position.add(F)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),F.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const p=this._needsUpdate;return p&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):p?(this.dispatchEvent({type:"update"}),c(i,this.restThreshold)&&c(a,this.restThreshold)&&c(h,this.restThreshold)&&c(l.x,this.restThreshold)&&c(l.y,this.restThreshold)&&c(l.z,this.restThreshold)&&c(d.x,this.restThreshold)&&c(d.y,this.restThreshold)&&c(d.z,this.restThreshold)&&c(_,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!p&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._updatedLastTime=p,this._needsUpdate=!1,p}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:m(this.maxDistance),minZoom:this.minZoom,maxZoom:m(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:m(this.maxPolarAngle),minAzimuthAngle:m(this.minAzimuthAngle),maxAzimuthAngle:m(this.maxAzimuthAngle),dampingFactor:this.dampingFactor,draggingDampingFactor:this.draggingDampingFactor,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:F.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(t,e=!1){const s=JSON.parse(t),i=F.fromArray(s.position);this.enabled=s.enabled,this.minDistance=s.minDistance,this.maxDistance=p(s.maxDistance),this.minZoom=s.minZoom,this.maxZoom=p(s.maxZoom),this.minPolarAngle=s.minPolarAngle,this.maxPolarAngle=p(s.maxPolarAngle),this.minAzimuthAngle=p(s.minAzimuthAngle),this.maxAzimuthAngle=p(s.maxAzimuthAngle),this.dampingFactor=s.dampingFactor,this.draggingDampingFactor=s.draggingDampingFactor,this.dollySpeed=s.dollySpeed,this.truckSpeed=s.truckSpeed,this.dollyToCursor=s.dollyToCursor,this.verticalDragToForward=s.verticalDragToForward,this._target0.fromArray(s.target0),this._position0.fromArray(s.position0),this._zoom0=s.zoom0,this._focalOffset0.fromArray(s.focalOffset0),this.moveTo(s.target[0],s.target[1],s.target[2],e),I.setFromVector3(i.sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(I.theta,I.phi,e),this.zoomTo(s.zoom,e),this.setFocalOffset(s.focalOffset[0],s.focalOffset[1],s.focalOffset[2],e),this._needsUpdate=!0}connect(t){this._domElement?console.warn("camera-controls is already connected."):(t.setAttribute("data-camera-controls-version",O),this._addAllEventListeners(t))}disconnect(){this._removeAllEventListeners(),this._domElement=void 0}dispose(){this.disconnect(),this._domElement&&"setAttribute"in this._domElement&&this._domElement.removeAttribute("data-camera-controls-version")}_findPointerById(t){let e=null;return this._activePointers.some(s=>s.pointerId===t&&(e=s,!0)),e}_encloseToBoundary(t,e,s){const i=e.lengthSq();if(0===i)return t;const n=z.copy(e).add(t),o=this._boundary.clampPoint(n,b),r=o.sub(n),a=r.lengthSq();if(0===a)return t.add(e);if(a===i)return t;if(0===s)return t.add(e).add(r);{const i=1+s*a/e.dot(r);return t.add(z.copy(e).multiplyScalar(i)).add(r.multiplyScalar(1-s))}}_updateNearPlaneCorners(){if(o(this._camera)){const t=this._camera,e=t.near,s=t.getEffectiveFOV()*w.MathUtils.DEG2RAD,i=Math.tan(.5*s)*e,n=i*t.aspect;this._nearPlaneCorners[0].set(-n,-i,0),this._nearPlaneCorners[1].set(n,-i,0),this._nearPlaneCorners[2].set(n,i,0),this._nearPlaneCorners[3].set(-n,i,0)}else if(r(this._camera)){const t=this._camera,e=1/t.zoom,s=t.left*e,i=t.right*e,n=t.top*e,o=t.bottom*e;this._nearPlaneCorners[0].set(s,n,0),this._nearPlaneCorners[1].set(i,n,0),this._nearPlaneCorners[2].set(i,o,0),this._nearPlaneCorners[3].set(s,o,0)}}_collisionTest(){let t=1/0;const e=this.colliderMeshes.length>=1;if(!e)return t;if(f(this._camera,"_collisionTest"))return t;const s=F.setFromSpherical(this._spherical).divideScalar(this._spherical.radius);Z.lookAt(C,s,this._camera.up);for(let i=0;i<4;i++){const e=z.copy(this._nearPlaneCorners[i]);e.applyMatrix4(Z);const n=b.addVectors(this._target,e);X.set(n,s),X.far=this._spherical.radius+1;const o=X.intersectObjects(this.colliderMeshes);0!==o.length&&o[0].distance<t&&(t=o[0].distance)}return t}_getClientRect(t){if(!this._domElement)return;const e=this._domElement.getBoundingClientRect();return t.x=e.left,t.y=e.top,this._viewport?(t.x+=this._viewport.x,t.y+=e.height-this._viewport.w-this._viewport.y,t.width=this._viewport.z,t.height=this._viewport.w):(t.width=e.width,t.height=e.height),t}_createOnRestPromise(t){return t?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(t=>{const e=()=>{this.removeEventListener("rest",e),t()};this.addEventListener("rest",e)}))}_addAllEventListeners(t){}_removeAllEventListeners(){}}function Q(t,e){const s=e,i=s.center;Y.makeEmpty(),t.traverseVisible(t=>{t.isMesh&&Y.expandByObject(t)}),Y.getCenter(i);let n=0;return t.traverseVisible(t=>{if(!t.isMesh)return;const e=t,s=e.geometry.clone();if(s.applyMatrix4(e.matrixWorld),s.isBufferGeometry){const t=s,e=t.attributes.position;for(let s=0,o=e.count;s<o;s++)F.fromBufferAttribute(e,s),n=Math.max(n,i.distanceToSquared(F))}else{const t=s.attributes.position,e=new w.Vector3;for(let s=0,o=t.count;s<o;s++)e.fromBufferAttribute(t,s),n=Math.max(n,i.distanceToSquared(e))}}),s.radius=Math.sqrt(n),s}},edd4:function(t,e,s){"use strict";s.d(e,"a",(function(){return n}));var i=s("5a89");class n extends i["Loader"]{constructor(t){super(t),this.littleEndian=!0}load(t,e,s,n){const o=this,r=new i["FileLoader"](o.manager);r.setPath(o.path),r.setResponseType("arraybuffer"),r.setRequestHeader(o.requestHeader),r.setWithCredentials(o.withCredentials),r.load(t,(function(s){try{e(o.parse(s,t))}catch(i){n?n(i):console.error(i),o.manager.itemError(t)}}),s,n)}parse(t,e){function s(t,e){const s=t.length,i=new Uint8Array(e);let n,o,r,a=0,h=0;do{if(n=t[a++],n<32){if(n++,h+n>e)throw new Error("Output buffer is not large enough");if(a+n>s)throw new Error("Invalid compressed data");do{i[h++]=t[a++]}while(--n)}else{if(o=n>>5,r=h-((31&n)<<8)-1,a>=s)throw new Error("Invalid compressed data");if(7===o&&(o+=t[a++],a>=s))throw new Error("Invalid compressed data");if(r-=t[a++],h+o+2>e)throw new Error("Output buffer is not large enough");if(r<0)throw new Error("Invalid compressed data");if(r>=h)throw new Error("Invalid compressed data");do{i[h++]=i[r++]}while(2+--o)}}while(a<s);return i}function n(t){const e={},s=t.search(/[\r\n]DATA\s(\S*)\s/i),i=/[\r\n]DATA\s(\S*)\s/i.exec(t.substr(s-1));if(e.data=i[1],e.headerLen=i[0].length+s,e.str=t.substr(0,e.headerLen),e.str=e.str.replace(/\#.*/gi,""),e.version=/VERSION (.*)/i.exec(e.str),e.fields=/FIELDS (.*)/i.exec(e.str),e.size=/SIZE (.*)/i.exec(e.str),e.type=/TYPE (.*)/i.exec(e.str),e.count=/COUNT (.*)/i.exec(e.str),e.width=/WIDTH (.*)/i.exec(e.str),e.height=/HEIGHT (.*)/i.exec(e.str),e.viewpoint=/VIEWPOINT (.*)/i.exec(e.str),e.points=/POINTS (.*)/i.exec(e.str),null!==e.version&&(e.version=parseFloat(e.version[1])),null!==e.fields&&(e.fields=e.fields[1].split(" ")),null!==e.type&&(e.type=e.type[1].split(" ")),null!==e.width&&(e.width=parseInt(e.width[1])),null!==e.height&&(e.height=parseInt(e.height[1])),null!==e.viewpoint&&(e.viewpoint=e.viewpoint[1]),null!==e.points&&(e.points=parseInt(e.points[1],10)),null===e.points&&(e.points=e.width*e.height),null!==e.size&&(e.size=e.size[1].split(" ").map((function(t){return parseInt(t,10)}))),null!==e.count)e.count=e.count[1].split(" ").map((function(t){return parseInt(t,10)}));else{e.count=[];for(let t=0,s=e.fields.length;t<s;t++)e.count.push(1)}e.offset={};let n=0;for(let o=0,r=e.fields.length;o<r;o++)"ascii"===e.data?e.offset[e.fields[o]]=o:(e.offset[e.fields[o]]=n,n+=e.size[o]*e.count[o]);return e.rowSize=n,e}const o=i["LoaderUtils"].decodeText(new Uint8Array(t)),r=n(o),a=[],h=[],l=[];if("ascii"===r.data){const t=r.offset,e=o.substr(r.headerLen),s=e.split("\n");for(let i=0,n=s.length;i<n;i++){if(""===s[i])continue;const e=s[i].split(" ");if(void 0!==t.x&&(a.push(parseFloat(e[t.x])),a.push(parseFloat(e[t.y])),a.push(parseFloat(e[t.z]))),void 0!==t.rgb){const s=parseFloat(e[t.rgb]),i=s>>16&255,n=s>>8&255,o=s>>0&255;l.push(i/255,n/255,o/255)}void 0!==t.normal_x&&(h.push(parseFloat(e[t.normal_x])),h.push(parseFloat(e[t.normal_y])),h.push(parseFloat(e[t.normal_z])))}}if("binary_compressed"===r.data){const e=new Uint32Array(t.slice(r.headerLen,r.headerLen+8)),i=e[0],n=e[1],o=s(new Uint8Array(t,r.headerLen+8,i),n),c=new DataView(o.buffer),d=r.offset;for(let t=0;t<r.points;t++)void 0!==d.x&&(a.push(c.getFloat32(r.points*d.x+r.size[0]*t,this.littleEndian)),a.push(c.getFloat32(r.points*d.y+r.size[1]*t,this.littleEndian)),a.push(c.getFloat32(r.points*d.z+r.size[2]*t,this.littleEndian))),void 0!==d.rgb&&(l.push(c.getUint8(r.points*d.rgb+r.size[3]*t+0)/255),l.push(c.getUint8(r.points*d.rgb+r.size[3]*t+1)/255),l.push(c.getUint8(r.points*d.rgb+r.size[3]*t+2)/255)),void 0!==d.normal_x&&(h.push(c.getFloat32(r.points*d.normal_x+r.size[4]*t,this.littleEndian)),h.push(c.getFloat32(r.points*d.normal_y+r.size[5]*t,this.littleEndian)),h.push(c.getFloat32(r.points*d.normal_z+r.size[6]*t,this.littleEndian)))}if("binary"===r.data){const e=new DataView(t,r.headerLen),s=r.offset;for(let t=0,i=0;t<r.points;t++,i+=r.rowSize)void 0!==s.x&&(a.push(e.getFloat32(i+s.x,this.littleEndian)),a.push(e.getFloat32(i+s.y,this.littleEndian)),a.push(e.getFloat32(i+s.z,this.littleEndian))),void 0!==s.rgb&&(l.push(e.getUint8(i+s.rgb+2)/255),l.push(e.getUint8(i+s.rgb+1)/255),l.push(e.getUint8(i+s.rgb+0)/255)),void 0!==s.normal_x&&(h.push(e.getFloat32(i+s.normal_x,this.littleEndian)),h.push(e.getFloat32(i+s.normal_y,this.littleEndian)),h.push(e.getFloat32(i+s.normal_z,this.littleEndian)))}const c=new i["BufferGeometry"];a.length>0&&c.setAttribute("position",new i["Float32BufferAttribute"](a,3)),h.length>0&&c.setAttribute("normal",new i["Float32BufferAttribute"](h,3)),l.length>0&&c.setAttribute("color",new i["Float32BufferAttribute"](l,3)),c.computeBoundingSphere();const d=new i["PointsMaterial"]({size:.005});l.length>0?d.vertexColors=!0:d.color.setHex(16777215*Math.random());const _=new i["Points"](c,d);let m=e.split("").reverse().join("");return m=/([^\/]*)/.exec(m),m=m[1].split("").reverse().join(""),_.name=m,_}}}}]);