(window["webpackJsonp_dubhe_web"]=window["webpackJsonp_dubhe_web"]||[]).push([["dataset-pointCloud-editor-core-pointCloudView","dataset-pointCloud-editor-core-boundingBox","dataset-pointCloud-editor-core-consts"],{"6eb8":function(e,t,i){"use strict";i.r(t),i.d(t,"Planes",(function(){return g})),i.d(t,"PointCloudView",(function(){return V}));var a=i("ed09"),r=i("5a89"),s=i("edd4"),o=i("a550"),n=i("5c96"),c=i("2ef0"),l=i("88be"),h=i("d0bd"),u=i("6b42"),d=i("7966");function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function m(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function p(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?m(Object(i),!0).forEach((function(t){b(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,O(a.key),a)}}function w(e,t,i){return t&&y(e.prototype,t),i&&y(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function b(e,t,i){return t=O(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function O(e){var t=T(e,"string");return"symbol"===v(t)?t:String(t)}function T(e,t){if("object"!==v(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,t||"default");if("object"!==v(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var g={TOP:"topPlane",SIDE:"sidePlane",FRONT:"frontPlane",MAIN:"mainPlane"},E=7,S=window.innerWidth/window.innerHeight,V=function(){function e(t){var i=this;f(this,e),b(this,"renderRayCaster",(function(){if(i.state.toolType===u["ToolType"].ANNOTATION){var e=i.views.main.rayCaster.renderer.intersectObjects(i.views.main.scene.children,!1);if(e.length>0){i.views.main.scene.children[0].add(i.moveBox);var t=e[0];i.moveBox.position.copy(t.point)}}else if(i.views.main.scene.children[0].remove(i.moveBox),i.state.toolType===u["ToolType"].SELECT){if(!i.state.multiView)return;var a=i.views.main.scene.children[0].children,r=i.views.main.rayCaster.renderer,s=r.intersectObjects(a,!1);if(0!==s.length){if(!s[0].object.visible)return;var o=s[0].object.name;if(!o)return;i.changeSelected(o,!1)}}})),this.state=t,this.views={main:{renderer:new r["WebGLRenderer"]({antialias:!0}),scene:new r["Scene"],rayCaster:{renderer:new r["Raycaster"],mouseVector:new r["Vector2"]}},top:{renderer:new r["WebGLRenderer"]({antialias:!0}),scene:new r["Scene"],rayCaster:{renderer:new r["Raycaster"],mouseVector:new r["Vector2"]}},side:{renderer:new r["WebGLRenderer"]({antialias:!0}),scene:new r["Scene"],rayCaster:{renderer:new r["Raycaster"],mouseVector:new r["Vector2"]}},front:{renderer:new r["WebGLRenderer"]({antialias:!0}),scene:new r["Scene"],rayCaster:{renderer:new r["Raycaster"],mouseVector:new r["Vector2"]}}},this.loadSuccess=!1,this.selected=null,this.active={frameCoordinates:{x:0,y:0,z:0},scan:null,detachCam:!1,selectable:!0,detected:!1,translation:{status:!1,helper:null,coordinates:null,offset:new r["Vector3"],inverseMatrix:new r["Matrix4"]},rotation:{status:!1,helper:null,recentMouseVector:new r["Vector2"](0,0),screenInit:{x:0,y:0},screenMove:{x:0,y:0}},resize:{status:!1,helper:null,recentMouseVector:new r["Vector2"](0,0),initScales:{x:1,y:1,z:1},memScales:{x:1,y:1,z:1},resizeVector:new r["Vector3"](0,0,0)}},this.moveBox=e.createVirtualBox(),this.globalHelpers={top:{resize:[],rotate:[]},side:{resize:[],rotate:[]},front:{resize:[],rotate:[]}},this.clock=new r["Clock"],Object.keys(this.views).forEach((function(e){i.views[e].scene.background=new r["Color"](d["default"].MAIN_VIEW_BG)})),o["a"].install({THREE:r}),this.initCameraConfig(),this.initCameraContorl(),this.views.main.renderer.domElement.addEventListener("mousemove",(function(e){if(e.preventDefault(),i.state.toolType!==u["ToolType"].SHIFT){var t=i.views.main.renderer.domElement,a=t.getBoundingClientRect(),r=i.views.main.rayCaster.mouseVector;r.set((e.clientX-(t.offsetLeft+a.left))/t.clientWidth*2-1,-(e.clientY-(t.offsetTop+a.top))/t.clientHeight*2+1)}})),this.views.main.renderer.domElement.addEventListener("mousedown",(function(e){if(e.preventDefault(),i.state.toolType!==u["ToolType"].SHIFT&&!i.loadSuccess){if(i.state.toolType===u["ToolType"].ANNOTATION){var t=i.moveBox.clone(),a=t.position,r=a.x,s=a.y,o=a.z,n=t.scale,c=n.x,l=n.y,h=n.z,d=t.rotation.z,v=[0,0,0,0,0,0,0,h,l,c,r,s,o,d].join(" ");i.dispatchEvent(new CustomEvent("annodown",{bubbles:!1,cancelable:!0,detail:{boxInfo:v,clientX:e.clientX,clientY:e.clientY}}))}if(i.state.toolType===u["ToolType"].SELECT){var m=i.views.main;m.rayCaster.renderer.setFromCamera(m.rayCaster.mouseVector,m.camera);var p=m.rayCaster.renderer.intersectObjects(m.scene.children[0].children,!1);0===p.length&&(i.selected&&(i.selected.setOpacity(i.state.meshOpacity),i.selected.setOtherVisible(!1)),i.setHelperVisible(!1),i.selected=null)}}})),[u["ViewType"].TOP,u["ViewType"].SIDE,u["ViewType"].FRONT].forEach((function(e){var t=i.views[e].renderer.domElement;t.addEventListener("mousedown",i.startAction.bind(i,e)),t.addEventListener("mousemove",i.moveAction.bind(i,e)),t.addEventListener("mouseup",i.completeActions.bind(i)),t.addEventListener("mouseleave",i.completeActions.bind(i)),t.addEventListener("wheel",(function(t){t.preventDefault();var a=i.views[e].camera;t.deltaY<d["default"].FOV_MIN&&a.zoom<d["default"].FOV_MAX?a.zoom+=d["default"].FOV_INC:t.deltaY>d["default"].FOV_MIN&&a.zoom>d["default"].FOV_MIN+.1&&(a.zoom-=d["default"].FOV_INC),i.setHelperSize(e)}),{passive:!1})}))}return w(e,[{key:"initCameraConfig",value:function(){this.views.main.camera=new r["PerspectiveCamera"](50,S,1,500),this.views.main.camera.position.set(-15,0,4),this.views.main.camera.up.set(0,0,1),this.views.main.camera.lookAt(0,0,10),this.views.main.camera.name="cameramain",this.views.top.camera=new r["OrthographicCamera"](-S*E/2-2,S*E/2+2,E/2+2,-E/2-2,-50,50),this.views.top.camera.position.set(0,0,5),this.views.top.camera.lookAt(0,0,0),this.views.top.camera.up.set(0,0,1),this.views.top.camera.name="cameraTop",this.views.side.camera=new r["OrthographicCamera"](-S*E/2,S*E/2,E/2,-E/2,-50,50),this.views.side.camera.position.set(0,5,0),this.views.side.camera.lookAt(0,0,0),this.views.side.camera.up.set(0,0,1),this.views.side.camera.name="cameraSide",this.views.front.camera=new r["OrthographicCamera"](-S*E/2,S*E/2,E/2,-E/2,-50,50),this.views.front.camera.position.set(3,0,0),this.views.front.camera.up.set(0,0,1),this.views.front.camera.lookAt(0,0,0),this.views.front.camera.name="cameraFront"}},{key:"initCameraContorl",value:function(){var e=this;Object.keys(this.views).forEach((function(t){var i=e.views[t];i.camera&&(t!==u["ViewType"].MAIN?(i.controls=new o["a"](i.camera,i.renderer.domElement),i.controls.mouseButtons.left=o["a"].ACTION.NONE,i.controls.mouseButtons.right=o["a"].ACTION.NONE,i.controls.enabled=!1):(i.controls=new o["a"](i.camera,i.renderer.domElement),i.controls.mouseButtons.left=o["a"].ACTION.NONE,i.controls.mouseButtons.right=o["a"].ACTION.NONE,i.controls.mouseButtons.wheel=o["a"].ACTION.NONE,i.controls.touches.one=o["a"].ACTION.NONE,i.controls.touches.two=o["a"].ACTION.NONE,i.controls.touches.three=o["a"].ACTION.NONE))}))}},{key:"dispatchEvent",value:function(e){this.views.main.renderer.domElement.dispatchEvent(e)}},{key:"resetView",value:function(){var e;null===(e=this.views.main.controls)||void 0===e||e.reset(!1),this.loadPointCloud(),this.changeCameraContorl(),this.resetActives(),this.selected=null}},{key:"startAction",value:function(e,t){if(1===t.detail&&this.state.toolType!==u["ToolType"].SHIFT&&!this.state.isCheck){var i=this.views[e].renderer.domElement,a=i.getBoundingClientRect(),r=this.views[e].rayCaster.mouseVector,s=t.clientX-a.left,o=t.clientY-a.top;r.x=s/i.clientWidth*2-1,r.y=-o/i.clientHeight*2+1,this.active.rotation.screenInit={x:s,y:o},this.active.rotation.screenMove={x:s,y:o},this.selected&&(this.active.scan=e,this.active.selectable=!1)}}},{key:"moveAction",value:function(e,t){if(t.preventDefault(),this.state.toolType!==u["ToolType"].SHIFT&&!this.state.isCheck){var i=this.views[e].renderer.domElement,a=i.getBoundingClientRect(),r=this.views[e].rayCaster.mouseVector,s=t.clientX-a.left,o=t.clientY-a.top;r.x=s/i.clientWidth*2-1,r.y=-o/i.clientHeight*2+1,this.active.rotation.screenMove={x:s,y:o}}}},{key:"completeActions",value:function(){var e=this.active,t=e.scan,i=e.detected;if(this.state.toolType!==u["ToolType"].SHIFT&&!this.state.isCheck)if(i){this.active.rotation.status&&this.detachCamera(t),this.adjustPerspectiveCameras();var a=this.selected[t].position,s=a.x,o=a.y,n=a.z;this.translateReferencePlane(new r["Vector3"](s,o,n)),this.resetActives()}else this.resetActives()}},{key:"resetActives",value:function(){this.active=p(p({},this.active),{},{scan:null,detected:!1,translation:{status:!1,helper:null},rotation:{status:!1,helper:null,recentMouseVector:new r["Vector2"](0,0)},resize:p(p({},this.active.resize),{},{status:!1,helper:null,recentMouseVector:new r["Vector2"](0,0)})}),this.active.selectable=!0}},{key:"adjustPerspectiveCameras",value:function(){var e=this.selected.getReferenceCoordinates(u["ViewType"].TOP),t=new r["Spherical"];t.setFromVector3(e),this.views.top.camera.position.setFromSpherical(t),this.views.top.camera.updateProjectionMatrix();var i=this.selected.getReferenceCoordinates(u["ViewType"].SIDE),a=new r["Spherical"];a.setFromVector3(i),this.views.side.camera.position.setFromSpherical(a),this.views.side.camera.updateProjectionMatrix();var s=this.selected.getReferenceCoordinates(u["ViewType"].FRONT),o=new r["Spherical"];o.setFromVector3(s),this.views.front.camera.position.setFromSpherical(o),this.views.front.camera.updateProjectionMatrix()}},{key:"loadPointCloud",value:function(){var e,t=this;if(this.clearScene(),this.loadSuccess=!1,null!==(e=this.state.currentFile)&&void 0!==e&&e.url){var i="".concat(l["b"].minioBaseUrl,"/").concat(this.state.currentFile.url),a=new s["a"];a.load(i,this.addScene.bind(this),(function(){}),(function(e){t.loadSuccess=!0,n["Notification"].error({title:"解析错误",message:e.message})}))}}},{key:"addScene",value:function(t){var i=this;t.material.size=.05,t.material.color.set("#fff");var a=t.material.clone(),s=t.geometry.boundingSphere.center,o=t.geometry.boundingSphere||{radius:0},n=o.radius;if(this.views.main.camera){var c=-n/2<this.views.main.camera.position.x-s.x&&n/2>this.views.main.camera.position.x-s.x,l=-n/2<this.views.main.camera.position.y-s.y&&n/2>this.views.main.camera.position.y-s.y,h=-n/2<this.views.main.camera.position.z-s.z&&n/2>this.views.main.camera.position.z-s.z,d=0,v=0,m=0;c||(d=s.x),l||(v=s.y),h||(m=s.z),(d||v||m)&&(this.active.frameCoordinates={x:d,y:v,z:m},this.positionAllViews(d,v,m,!1)),[u["ViewType"].TOP,u["ViewType"].SIDE,u["ViewType"].FRONT].forEach((function(e){i.globalHelpers[e].resize=[],i.globalHelpers[e].rotation=[]})),this.views.main.scene.add(t.clone());var p=new r["Shape"],f=this.state.distanceRange,y=f.front,w=f.behind,b=f.left,O=f.right;p.moveTo(y,b,0),p.lineTo(y,O,0),p.lineTo(w,O,0),p.lineTo(w,b,0),p.autoClose=!0;var T=p.getPoints(),E=(new r["BufferGeometry"]).setFromPoints(T),S=new r["Line"](E,new r["LineBasicMaterial"]({color:13421772,linewidth:30}));this.views.main.scene.add(S);var V=new r["AxesHelper"];this.views.main.scene.add(V);var C=this.views.top.renderer.domElement,x=new r["Mesh"](new r["PlaneBufferGeometry"](C.offsetHeight,C.offsetWidth,C.offsetHeight,C.offsetWidth),new r["MeshBasicMaterial"]({color:16777215,alphaTest:0,visible:!1,transparent:!0,opacity:0}));x.position.set(0,0,0),x.name=g.TOP,x.material.side=r["DoubleSide"],x.verticesNeedUpdate=!0,t.material=a,a.size=.5,this.views.top.scene.add(t.clone()),this.views.top.scene.add(x);var R=e.setupRotationHelper();this.globalHelpers.top.rotation.push(R),this.views.top.scene.add(R),this.setupResizeHelper(u["ViewType"].TOP);var N=this.views.side.renderer.domElement,P=new r["Mesh"](new r["PlaneBufferGeometry"](N.offsetHeight,N.offsetWidth,N.offsetHeight,N.offsetWidth),new r["MeshBasicMaterial"]({color:16777215,alphaTest:0,visible:!1,transparent:!0,opacity:0}));P.position.set(0,0,0),P.rotation.set(-Math.PI/2,Math.PI/2e3,Math.PI),P.name=g.SIDE,P.material.side=r["DoubleSide"],P.verticesNeedUpdate=!0,this.views.side.scene.add(t.clone()),this.views.side.scene.add(P),this.setupResizeHelper(u["ViewType"].SIDE);var z=this.views.front.renderer.domElement,M=new r["Mesh"](new r["PlaneBufferGeometry"](z.offsetHeight,z.offsetWidth,z.offsetHeight,z.offsetWidth),new r["MeshBasicMaterial"]({color:16777215,alphaTest:0,visible:!1,transparent:!0,opacity:0}));M.position.set(0,0,0),M.rotation.set(0,Math.PI/2,0),M.name=g.FRONT,M.material.side=r["DoubleSide"],M.verticesNeedUpdate=!0,this.views.front.scene.add(t.clone()),this.views.front.scene.add(M),this.setupResizeHelper(u["ViewType"].FRONT),this.setHelperVisible(!1),Array.isArray(this.state.oldAnnotatedInfo)&&this.state.oldAnnotatedInfo.length&&this.createBoundingBoxs()}}},{key:"createBoundingBoxs",value:function(){var e,t=this;this.views.main.scene.children[0]&&(this.clearSceneObjects(),this.setHelperVisible(!1),null===(e=this.state.oldAnnotatedInfo)||void 0===e||e.forEach((function(e){t.createBoundingBox(e,!1)})))}},{key:"createBoundingBox",value:function(e,t){var i=this;this.selected&&this.selected.setOtherVisible(!1);var s=e.split(" ").map((function(e,t){return 0===t?e:parseFloat(e)})),o=new h["BoundingBox"],n=o.main.uuid;o.setName(n);var c=this.state.labelGroup.find((function(e){return s[0]===e.name})),l=c||{name:s[0],color:"#58d1c9"};o.setOriginalColor(l.color),o.setColor(l.color),o.setOpacity(this.state.meshOpacity),o.setMainLine(l.color),Object.assign(o.main.userData,{labelInfo:p({},l)}),Object(h["createRotationHelper"])(o.top,u["ViewType"].TOP),Object(h["setTranslationHelper"])(o.top),Object(h["setTranslationHelper"])(o.side),Object(h["setTranslationHelper"])(o.front),Object(h["setEdges"])(o.top),Object(h["setEdges"])(o.side),Object(h["setEdges"])(o.front),this.translateReferencePlane(new r["Vector3"](s[11],s[12],s[13])),o.setPosition(s[11],s[12],s[13]),o.setScale(s[10],s[9],s[8]),o.setRotation(s[14]),Object(h["setText"])(o.main),t?(this.selected=o,o.attachCameraReference(),Object(a["g"])((function(){return i.rotatePlane(0,null)})),this.active.detachCam=!0,this.setSelectedChildScale(1/o.top.scale.x,1/o.top.scale.y,1/o.top.scale.z),this.setHelperVisible(!0),this.updateRotationHelperPos(),this.updateResizeHelperPos()):(o.setOtherVisible(!1),this.setHelperVisible(!1)),this.addSceneChildren(o),this.state.cuboidStroage.push(o)}},{key:"addSceneChildren",value:function(e){this.views.main.scene.children[0].add(e.main),this.views.top.scene.children[0].add(e.top),this.views.side.scene.children[0].add(e.side),this.views.front.scene.children[0].add(e.front)}},{key:"clearScene",value:function(){var e=this;Object.keys(this.views).forEach((function(t){e.views[t].scene.children=[]}))}},{key:"clearSceneObjects",value:function(){var e=this;Object.keys(this.views).forEach((function(t){e.views[t].scene.children[0].children=[]}))}},{key:"changeCameraContorl",value:function(){var e=this.views.main.controls,t=this.state.toolType===u["ToolType"].SHIFT;e.mouseButtons.left=t?o["a"].ACTION.ROTATE:o["a"].ACTION.NONE,e.mouseButtons.right=t?o["a"].ACTION.TRUCK:o["a"].ACTION.NONE,e.mouseButtons.wheel=t?o["a"].ACTION.DOLLY:o["a"].ACTION.NONE}},{key:"positionAllViews",value:function(e,t,i,a){this.views.main.controls&&this.views.top.controls&&this.views.side.controls&&this.views.front.controls&&(this.views.main.controls.setLookAt(e-8,t-8,i+3,e,t,i,a),this.views.top.camera.position.set(e,t,i+8),this.views.top.camera.lookAt(e,t,i),this.views.top.camera.zoom=1,this.views.side.camera.position.set(e,t+8,i),this.views.side.camera.lookAt(e,t,i),this.views.side.camera.zoom=1,this.views.front.camera.position.set(e+8,t,i),this.views.front.camera.lookAt(e,t,i),this.views.front.camera.zoom=1)}},{key:"setDefaultZoom",value:function(){var e=this.views.top.renderer.domElement,t=(new r["Box3"]).setFromObject(this.selected.top),i=.4*Math.min(e.offsetWidth/(t.max.x-t.min.x),e.offsetHeight/(t.max.y-t.min.y));this.views.top.camera.zoom=i/100,this.views.top.camera.updateProjectionMatrix(),this.views.top.camera.updateMatrix(),this.setHelperSize(u["ViewType"].TOP);var a=this.views.front.renderer.domElement,s=(new r["Box3"]).setFromObject(this.selected.front),o=.4*Math.min(a.offsetWidth/(s.max.y-s.min.y),a.offsetHeight/(s.max.z-s.min.z));this.views.front.camera.zoom=o/100,this.views.front.camera.updateProjectionMatrix(),this.views.front.camera.updateMatrix(),this.setHelperSize(u["ViewType"].FRONT);var n=this.views.side.renderer.domElement,c=(new r["Box3"]).setFromObject(this.selected.side),l=.4*Math.min(n.offsetWidth/(c.max.x-c.min.x),n.offsetHeight/(c.max.z-c.min.z));this.views.side.camera.zoom=l/100,this.views.side.camera.updateProjectionMatrix(),this.views.side.camera.updateMatrix(),this.setHelperSize(u["ViewType"].SIDE)}},{key:"detachCamera",value:function(e){var t=this.selected.getReferenceCoordinates(u["ViewType"].TOP),i=new r["Spherical"];i.setFromVector3(t);var a=this.selected.getReferenceCoordinates(u["ViewType"].SIDE),s=new r["Spherical"];s.setFromVector3(a);var o=this.selected.getReferenceCoordinates(u["ViewType"].FRONT),n=new r["Spherical"];n.setFromVector3(o);var c=this.selected,l=c.side,h=c.front,d=c.top,v=this.views.side.camera,m=this.views.front.camera,p=this.views.top.camera;switch(e){case u["ViewType"].TOP:var f=l.getObjectByName("cameraSide").getWorldQuaternion(new r["Quaternion"]);l.remove(v),v.position.setFromSpherical(s),v.lookAt(l.position.x,l.position.y,l.position.z),v.setRotationFromQuaternion(f),v.scale.set(1,1,1);var y=h.getObjectByName("cameraFront").getWorldQuaternion(new r["Quaternion"]);h.remove(m),m.position.setFromSpherical(n),m.lookAt(h.position.x,h.position.y,h.position.z),m.setRotationFromQuaternion(y),m.scale.set(1,1,1);break;case u["ViewType"].SIDE:var w=h.getObjectByName("cameraFront").getWorldQuaternion(new r["Quaternion"]);h.remove(m),m.position.setFromSpherical(n),m.lookAt(h.position.x,h.position.y,h.position.z),m.setRotationFromQuaternion(w),m.scale.set(1,1,1),d.remove(p),p.position.setFromSpherical(i),p.lookAt(d.position.x,d.position.y,d.position.z),p.setRotationFromEuler(d.rotation),p.scale.set(1,1,1);break;case u["ViewType"].FRONT:var b=l.getObjectByName("cameraSide").getWorldQuaternion(new r["Quaternion"]);l.remove(v),v.position.setFromSpherical(s),v.lookAt(l.position.x,l.position.y,l.position.z),v.setRotationFromQuaternion(b),v.scale.set(1,1,1),d.remove(p),p.position.setFromSpherical(i),p.lookAt(d.position.x,d.position.y,d.position.z),p.setRotationFromEuler(d.rotation),p.scale.set(1,1,1);break;default:v.position.setFromSpherical(s),v.lookAt(l.position.x,l.position.y,l.position.z),v.rotation.z=this.views.side.scene.getObjectByName(g.SIDE).rotation.z,v.scale.set(1,1,1),p.position.setFromSpherical(i),p.lookAt(d.position.x,d.position.y,d.position.z),p.setRotationFromEuler(d.rotation),p.scale.set(1,1,1);var O=h.getObjectByName("camRefRot").getWorldQuaternion(new r["Quaternion"]);m.position.setFromSpherical(n),m.lookAt(h.position.x,h.position.y,h.position.z),m.setRotationFromQuaternion(O),m.scale.set(1,1,1)}}},{key:"attachCamera",value:function(e){switch(e){case u["ViewType"].TOP:this.selected.side.attach(this.views.side.camera),this.selected.front.attach(this.views.front.camera);break;case u["ViewType"].SIDE:this.selected.front.attach(this.views.front.camera),this.selected.top.attach(this.views.top.camera);break;case u["ViewType"].FRONT:this.selected.side.attach(this.views.side.camera),this.selected.top.attach(this.views.top.camera);break;default:}}},{key:"setupResizeHelper",value:function(e){for(var t=new r["SphereGeometry"](.15),i=new r["MeshBasicMaterial"]({color:"#ffffff",opacity:1,visible:!0}),a=[],s=0;s<8;s+=1)a[s]=new r["Mesh"](t.clone(),i.clone()),a[s].name="globalResizeHelper".concat(s),this.globalHelpers[e].resize.push(a[s]),this.views[e].scene.add(a[s])}},{key:"setHelperSize",value:function(e){if([u["ViewType"].TOP,u["ViewType"].SIDE,u["ViewType"].FRONT].includes(e)){var t=this.views[e].camera;if(!t||t instanceof r["PerspectiveCamera"])return;var i=(t.top-t.bottom)/t.zoom,a=this.views[e].scene.getObjectByName("globalRotationHelper");a&&a.scale.set(1,1,1).multiplyScalar(i/10);for(var s=0;s<8;s+=1){var o=this.views[e].scene.getObjectByName("globalResizeHelper".concat(s));o&&o.scale.set(1,1,1).multiplyScalar(i/10)}}}},{key:"updateRotationHelperPos",value:function(){var e=new r["Vector3"](0,0,0);this.selected.top.getObjectByName("rotationHelper").getWorldPosition(e);var t=this.views.top.scene.getObjectByName("globalRotationHelper");t&&t.position.set(e.x,e.y,e.z)}},{key:"updateResizeHelperPos",value:function(){var e=this;[u["ViewType"].TOP,u["ViewType"].SIDE,u["ViewType"].FRONT].forEach((function(t){var i=0;e.selected[t].children.forEach((function(a){if("resizeHelper"===a.name){var s=new r["Vector3"](0,0,0);a.getWorldPosition(s);var o="globalResizeHelper".concat(i),n=e.views[t].scene.getObjectByName(o);n&&n.position.set(s.x,s.y,s.z),i+=1}}))}))}},{key:"setHelperVisible",value:function(e){var t=this;[u["ViewType"].TOP,u["ViewType"].SIDE,u["ViewType"].FRONT].forEach((function(i){var a=t.views[i].scene.getObjectByName("globalRotationHelper");a&&(a.visible=e);for(var r=0;r<8;r+=1){var s=t.views[i].scene.getObjectByName("globalResizeHelper".concat(r));s&&(s.visible=e)}}))}},{key:"setSelectedChildScale",value:function(e,t,i){var a=this;[u["ViewType"].TOP,u["ViewType"].SIDE,u["ViewType"].FRONT].forEach((function(r){a.selected[r].children.forEach((function(a){a.name!==d["default"].CUBOID_EDGE_NAME&&a.scale.set(null==e?a.scale.x:e,null==t?a.scale.y:t,null==i?a.scale.z:i)}))}))}},{key:"changeSelected",value:function(e,t){var i=this.state.cuboidStroage.find((function(t){return e===t.main.name})),a=null===i||void 0===i?void 0:i.main.position,r=a.x,s=a.y;if(!(Object(c["isNil"])(r)&&Object(c["isNil"])(s)||null===i||void 0===i)&&i.main.visible&&i){var o;if((null===(o=this.selected)||void 0===o?void 0:o.main.name)===i.main.name)return;this.selected&&(this.selected.setOpacity(this.state.meshOpacity),this.selected.setOtherVisible(!1)),this.selected=i;var n=this.state.meshOpacity;if(this.selected.setOpacity(n>50?n-30:n+30),this.selected.setOtherVisible(!0),this.selected.attachCameraReference(),this.setSelectedChildScale(1/this.selected.top.scale.x,1/this.selected.top.scale.y,1/this.selected.top.scale.z),this.rotatePlane(0,null),this.setHelperVisible(!0),this.updateRotationHelperPos(),this.updateResizeHelperPos(),this.active.detachCam=!0,t){var l=this.views.main.controls,h=this.selected.main.position,u=h.x,d=h.y,v=h.z;l.moveTo(u,d,v,!0)}}}},{key:"initiateAction",value:function(e,t){var i=t.rayCaster.renderer.intersectObjects(this.globalHelpers[e].resize,!1);if(0!==i.length){this.active.resize.helper=t.rayCaster.mouseVector.clone(),this.active.resize.status=!0,this.active.detected=!0;var a=this.selected[e].scale,s=a.x,o=a.y,n=a.z;return this.active.resize.initScales={x:s,y:o,z:n},this.active.resize.memScales={x:s,y:o,z:n},this.active.resize.frontBool=!1,void(this.active.resize.resizeVector=new r["Vector3"](0,0,0))}var c=t.rayCaster.renderer.intersectObjects(this.globalHelpers[e].rotation,!1);if(0!==c.length)return this.active.rotation.helper=t.rayCaster.mouseVector.clone(),this.active.rotation.status=!0,this.active.detected=!0,void this.attachCamera(e);var l,h,u=t.rayCaster.renderer.intersectObject(this.selected[e],!1),d=t.rayCaster.renderer.intersectObjects([t.scene.getObjectByName("".concat(e,"Plane"))]);0!==u.length&&(this.active.translation.helper=t.rayCaster.mouseVector.clone(),this.active.translation.inverseMatrix=u[0].object.parent.matrixWorld.invert(),this.active.translation.offset=null===(l=d[0])||void 0===l||null===(h=l.point)||void 0===h?void 0:h.sub((new r["Vector3"]).setFromMatrixPosition(u[0].object.matrixWorld)),this.active.translation.status=!0,this.active.detected=!0)}},{key:"renderTranslateAction",value:function(e,t){if(this.active.translation.helper.x!==this.views[e].rayCaster.mouseVector.x||this.active.translation.helper.y!==this.views[e].rayCaster.mouseVector.y){var i=t.rayCaster.renderer.intersectObjects([t.scene.getObjectByName("".concat(e,"Plane"))]);if(0!==i.length&&i[0].point){var a=i[0].point;this.active.translation.coordinates=a,this.moveObject(a)}}}},{key:"renderResizeAction",value:function(e,t){var i=t.rayCaster.renderer.intersectObjects([t.scene.getObjectByName("".concat(e,"Plane"))]);if(0!==i.length){var a=this.active.resize.initScales,r=a.x,s=a.y,o=a.z,n=this.active.resize.memScales,c=n.x,l=n.y,h=n.z,d=this.active.resize.helper,v=d.x,m=d.y,f=t.rayCaster.mouseVector,y=f.x,w=f.y,b=this.active.resize.resizeVector;if((this.active.resize.helper.x!==y||this.active.resize.helper.y!==w)&&(this.active.resize.recentMouseVector.x!==y||this.active.resize.recentMouseVector.y!==w)){switch(this.active.resize.recentMouseVector=t.rayCaster.mouseVector.clone(),e){case u["ViewType"].TOP:var O=r*(y/v),T=s*(w/m);T<0&&(T=.2),O<0&&(O=.2),this.selected.setScale(O,T,this.selected.top.scale.z),this.setSelectedChildScale(1/O,1/T,null);var g=O/2-c/2,E=T/2-l/2;y>0&&w<0?(b.x+=g,b.y-=E):y>0&&w>0?(b.x+=g,b.y+=E):y<0&&w<0?(b.x-=g,b.y-=E):y<0&&w>0&&(b.x-=g,b.y+=E),this.active.resize.memScales.x=O,this.active.resize.memScales.y=T;break;case u["ViewType"].SIDE:var S=r*(y/v),V=o*(w/m);S<0&&(S=.2),V<0&&(V=.2),this.selected.setScale(S,this.selected.top.scale.y,V),this.setSelectedChildScale(1/S,null,1/V);var C=S/2-c/2,x=V/2-h/2;y>0&&w<0?(b.x+=C,b.y-=x):y>0&&w>0?(b.x+=C,b.y+=x):y<0&&w<0?(b.x-=C,b.y-=x):y<0&&w>0&&(b.x-=C,b.y+=x),this.active.resize.memScales=p(p({},this.active.resize.memScales),{},{x:S,z:V});break;case u["ViewType"].FRONT:var R,N,P=s*(y/v),z=o*(w/m);P<0&&(P=.2),z<0&&(z=.2),this.selected.setScale(this.selected.top.scale.x,P,z),this.setSelectedChildScale(null,1/P,1/z),this.active.resize.frontBool?(R=z/2-l/2,N=P/2-h/2):(R=z/2-h/2,N=P/2-l/2,this.active.resize.frontBool=!0),y>0&&w<0?(b.x+=R,b.y+=N):y>0&&w>0?(b.x-=R,b.y+=N):y<0&&w<0?(b.x+=R,b.y-=N):y<0&&w>0&&(b.x-=R,b.y-=N),this.active.resize.memScales.y=z,this.active.resize.memScales.z=P;break;default:}var M=b.clone();i[0].object.localToWorld(M),this.moveObject(M),this.adjustPerspectiveCameras()}}}},{key:"renderRotateAction",value:function(t,i){var a=Math.PI/d["default"].ROTATION_SPEED,r=i.renderer,s=r.domElement;if(s){var o={x:s.offsetLeft+s.offsetWidth/2,y:s.offsetTop+s.offsetHeight/2};this.active.rotation.screenInit.x===this.active.rotation.screenMove.x&&this.active.rotation.screenInit.y===this.active.rotation.screenMove.y||this.active.rotation.recentMouseVector.x===this.views[t].rayCaster.mouseVector.x&&this.active.rotation.recentMouseVector.y===this.views[t].rayCaster.mouseVector.y||(this.active.rotation.recentMouseVector=this.views[t].rayCaster.mouseVector.clone(),e.isLeft(o,this.active.rotation.screenInit,this.active.rotation.screenMove)?(this.rotateCube(this.selected,-a,t),this.rotatePlane(-a,t)):(this.rotateCube(this.selected,a,t),this.rotatePlane(a,t)),this.active.rotation.screenInit.x=this.active.rotation.screenMove.x,this.active.rotation.screenInit.y=this.active.rotation.screenMove.y)}}},{key:"rotateCube",value:function(e,t,i){switch(i){case u["ViewType"].TOP:e.main.rotateZ(t),e.top.rotateZ(t),e.side.rotateZ(t),e.front.rotateZ(t),this.rotateCamera(t,i);break;case u["ViewType"].FRONT:e.main.rotateX(t),e.top.rotateX(t),e.side.rotateX(t),e.front.rotateX(t),this.rotateCamera(t,i);break;case u["ViewType"].SIDE:e.main.rotateY(t),e.top.rotateY(t),e.side.rotateY(t),e.front.rotateY(t),this.rotateCamera(t,i);break;default:}}},{key:"rotateCamera",value:function(e,t){switch(t){case u["ViewType"].TOP:this.views.top.camera.rotateZ(e);break;case u["ViewType"].FRONT:this.views.front.camera.rotateZ(e);break;case u["ViewType"].SIDE:this.views.side.camera.rotateZ(e);break;default:}}},{key:"rotatePlane",value:function(e,t){var i=this.views.top.scene.getObjectByName(g.TOP),a=this.views.side.scene.getObjectByName(g.SIDE),s=this.views.front.scene.getObjectByName(g.FRONT);switch(t){case u["ViewType"].TOP:i.rotateZ(e),a.rotateY(e),s.rotateX(-e);break;case u["ViewType"].SIDE:i.rotateY(e),a.rotateZ(e),s.rotateY(e);break;case u["ViewType"].FRONT:i.rotateX(e),a.rotateX(-e),s.rotateZ(e);break;default:var o=this.selected,n=o.top,c=o.side,l=o.front;n.add(i),c.add(a),l.add(s),n.getObjectByName(g.TOP).rotation.set(0,0,0),c.getObjectByName(g.SIDE).rotation.set(-Math.PI/2,Math.PI/2e3,Math.PI),l.getObjectByName(g.FRONT).rotation.set(0,Math.PI/2,0);var h=new r["Quaternion"];c.getObjectByName(g.SIDE).getWorldQuaternion(h);var d=new r["Euler"];d.setFromQuaternion(h);var v=new r["Quaternion"];l.getObjectByName(g.FRONT).getWorldQuaternion(v);var m=new r["Euler"];m.setFromQuaternion(v);var p=new r["Quaternion"];n.getObjectByName(g.TOP).getWorldQuaternion(p);var f=new r["Euler"];f.setFromQuaternion(p),n.remove(i),c.remove(a),l.remove(s);var y=this.views.top.renderer.domElement,w=new r["Mesh"](new r["PlaneBufferGeometry"](y.offsetHeight,y.offsetWidth),new r["MeshBasicMaterial"]({color:16711680,alphaTest:0,visible:!1,transparent:!0,opacity:.1}));w.name=g.TOP,w.material.side=r["DoubleSide"];var b=this.views.side.renderer.domElement,O=new r["Mesh"](new r["PlaneBufferGeometry"](b.offsetHeight,b.offsetWidth),new r["MeshBasicMaterial"]({color:65280,alphaTest:0,visible:!1,transparent:!0,opacity:.1}));O.name=g.SIDE,O.material.side=r["DoubleSide"];var T=this.views.front.renderer.domElement,E=new r["Mesh"](new r["PlaneBufferGeometry"](T.offsetHeight,T.offsetWidth),new r["MeshBasicMaterial"]({color:255,alphaTest:0,visible:!1,transparent:!0,opacity:.5}));E.name=g.FRONT,E.material.side=r["DoubleSide"];var S={x:n.position.x,y:n.position.y,z:n.position.z};w.rotation.set(f.x,f.y,f.z),O.rotation.set(d.x,d.y,d.z),E.rotation.set(m.x,m.y,m.z),this.views.top.scene.add(w),this.views.side.scene.add(O),this.views.front.scene.add(E),this.translateReferencePlane(S)}}},{key:"translateReferencePlane",value:function(e){var t=this.views.top.scene.getObjectByName(g.TOP);t&&(t.position.x=e.x,t.position.y=e.y,t.position.z=e.z);var i=this.views.side.scene.getObjectByName(g.SIDE);i&&(i.position.x=e.x,i.position.y=e.y,i.position.z=e.z);var a=this.views.front.scene.getObjectByName(g.FRONT);a&&(a.position.x=e.x,a.position.y=e.y,a.position.z=e.z)}},{key:"moveObject",value:function(e){var t=this.selected,i=t.main,a=t.top,r=t.side,s=t.front,o=e;this.active.translation.status&&(o=e.clone().sub(this.active.translation.offset).applyMatrix4(this.active.translation.inverseMatrix)),i.position.copy(o.clone()),a.position.copy(o.clone()),r.position.copy(o.clone()),s.position.copy(o.clone())}},{key:"animationRender",value:function(){var t=this;if(Object.keys(this.views).forEach((function(i){var a,r=t.views[i];r.controls&&r.camera&&r.rayCaster&&(r.rayCaster.renderer.setFromCamera(r.rayCaster.mouseVector,r.camera),e.resizeRendererSize(r),null!==(a=r.controls)&&void 0!==a&&a.enabled?r.controls.update(t.clock.getDelta()):r.camera.updateProjectionMatrix(),r.renderer.render(r.scene,r.camera),i===u["ViewType"].MAIN&&0!==r.scene.children.length&&t.renderRayCaster(),i!==u["ViewType"].MAIN&&t.active.scan===i&&(t.active.translation.status||t.active.resize.status||t.active.rotation.status||t.initiateAction(i,r),t.active.detected?(t.active.translation.status?t.renderTranslateAction(i,r):t.active.resize.status?t.renderResizeAction(i,r):t.renderRotateAction(i,r),t.updateResizeHelperPos(),t.updateRotationHelperPos()):t.resetActives()))})),this.active.detachCam)try{this.detachCamera(null)}finally{this.active.detachCam=!1}}},{key:"canvasDom",value:function(){return{main:this.views.main.renderer.domElement,top:this.views.top.renderer.domElement,side:this.views.side.renderer.domElement,front:this.views.front.renderer.domElement}}}],[{key:"setupRotationHelper",value:function(){var e=new r["SphereGeometry"](.15),t=new r["MeshBasicMaterial"]({color:"#ffffff",opacity:1,visible:!0}),i=new r["Mesh"](e,t);return i.name="globalRotationHelper",i}},{key:"resizeRendererSize",value:function(e){var t=e.camera,i=e.renderer,a=i.domElement;if(a.parentElement){var s=a.parentElement.clientWidth,o=a.parentElement.clientHeight,n=a.clientWidth!==s||a.clientHeight!==o;if(n&&t&&e.camera){if(t instanceof r["PerspectiveCamera"])t.aspect=s/o;else{var c=0,l=7,h=s/o;t instanceof r["PerspectiveCamera"]||(t.left=-h*l/2-c,t.right=h*l/2+c,t.top=l/2+c,t.bottom=-l/2-c),t.near=-50,t.far=50}e.renderer.setSize(s,o),e.camera.updateProjectionMatrix()}}}},{key:"createVirtualBox",value:function(){var e=new r["BoxGeometry"](1,1,1),t=new r["MeshBasicMaterial"]({color:d["default"].PRIMARY,wireframe:!1,transparent:!0,opacity:.4}),i=new r["Mesh"](e,t);i.name="virtual";var a=new r["LineSegments"](new r["EdgesGeometry"](i.geometry),new r["LineBasicMaterial"]({color:d["default"].PRIMARY,linewidth:3}));return a.computeLineDistances(),a.renderOrder=1,i.add(a),i}},{key:"isLeft",value:function(e,t,i){return(t.x-e.x)*(i.y-e.y)-(t.y-e.y)*(i.x-e.x)>0}}]),e}()},7966:function(e,t,i){"use strict";i.r(t),t["default"]={CAMERA_REFERENCE:"camRef",CUBOID_EDGE_NAME:"edges",ROTATION_HELPER:"rotationHelper",ROTATION_HELPER_OFFSET:.1,ROTATION_SPEED:80,FOV_MAX:2,FOV_MIN:0,FOV_INC:.08,MAIN_VIEW_BG:0,PRIMARY:5820873}},d0bd:function(e,t,i){"use strict";i.r(t),i.d(t,"BoundingBox",(function(){return g})),i.d(t,"setEdges",(function(){return E})),i.d(t,"setTranslationHelper",(function(){return S})),i.d(t,"createRotationHelper",(function(){return V})),i.d(t,"getTextCanvas",(function(){return x})),i.d(t,"setText",(function(){return R}));var a=i("5a89"),r=i("9037"),s=i("6b42"),o=i("7966");function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function c(e,t){return v(e)||d(e,t)||h(e,t)||l()}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(e,t){if(e){if("string"===typeof e)return u(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function d(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var a,r,s,o,n=[],c=!0,l=!1;try{if(s=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;c=!1}else for(;!(c=(a=s.call(i)).done)&&(n.push(a.value),n.length!==t);c=!0);}catch(h){l=!0,r=h}finally{try{if(!c&&null!=i.return&&(o=i.return(),Object(o)!==o))return}finally{if(l)throw r}}return n}}function v(e){if(Array.isArray(e))return e}function m(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function p(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?m(Object(i),!0).forEach((function(t){f(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function f(e,t,i){return t=O(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,O(a.key),a)}}function b(e,t,i){return t&&w(e.prototype,t),i&&w(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function O(e){var t=T(e,"string");return"symbol"===n(t)?t:String(t)}function T(e,t){if("object"!==n(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,t||"default");if("object"!==n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var g=function(){function e(){y(this,e);var t=new a["BoxGeometry"](1,1,1),i=new a["MeshBasicMaterial"]({color:5820873,wireframe:!1,transparent:!0});this.main=new a["Mesh"](t,i),this.top=new a["Mesh"](t,i),this.side=new a["Mesh"](t,i),this.front=new a["Mesh"](t,i);var r=new a["Object3D"];r.translateX(-2),r.name="camRefRot",r.up=new a["Vector3"](0,0,1),r.lookAt(new a["Vector3"](0,0,0)),this.front.add(r.clone())}return b(e,[{key:"setMainLine",value:function(e){var t=new a["LineSegments"](new a["EdgesGeometry"](this.main.geometry),new a["LineBasicMaterial"]({color:e,linewidth:4}));t.computeLineDistances(),t.renderOrder=1,t.name="mainLine",this.main.add(t)}},{key:"setPosition",value:function(e,t,i){var a=this;[s["ViewType"].MAIN,s["ViewType"].TOP,s["ViewType"].SIDE,s["ViewType"].FRONT].forEach((function(r){a[r].position.set(e,t,i)}))}},{key:"setScale",value:function(e,t,i){var a=this;[s["ViewType"].MAIN,s["ViewType"].TOP,s["ViewType"].SIDE,s["ViewType"].FRONT].forEach((function(r){a[r].scale.set(e,t,i)}))}},{key:"setRotation",value:function(e){var t=this;[s["ViewType"].MAIN,s["ViewType"].TOP,s["ViewType"].SIDE,s["ViewType"].FRONT].forEach((function(i){t[i].rotation.set(0,0,e)}))}},{key:"attachCameraReference",value:function(){var e=new a["Object3D"];e.translateZ(2),e.name=o["default"].CAMERA_REFERENCE,this.top.add(e),this.top.userData=p(p({},this.top.userData),{},{camReference:e});var t=new a["Object3D"];t.translateY(2),t.name=o["default"].CAMERA_REFERENCE,this.side.add(t),this.side.userData=p(p({},this.side.userData),{},{camReference:t});var i=new a["Object3D"];i.translateX(2),i.name=o["default"].CAMERA_REFERENCE,this.front.add(i),this.front.userData=p(p({},this.front.userData),{},{camReference:i})}},{key:"setName",value:function(e){var t=this;[s["ViewType"].MAIN,s["ViewType"].TOP,s["ViewType"].SIDE,s["ViewType"].FRONT].forEach((function(i){t[i].name=e}))}},{key:"setOriginalColor",value:function(e){var t=this;[s["ViewType"].MAIN,s["ViewType"].TOP,s["ViewType"].SIDE,s["ViewType"].FRONT].forEach((function(i){t[i].originalColor=e}))}},{key:"setColor",value:function(e){var t=this;[s["ViewType"].MAIN,s["ViewType"].TOP,s["ViewType"].SIDE,s["ViewType"].FRONT].forEach((function(i){t[i].material.color.set(e)}))}},{key:"setOpacity",value:function(e){var t=this;[s["ViewType"].MAIN,s["ViewType"].TOP,s["ViewType"].SIDE,s["ViewType"].FRONT].forEach((function(i){t[i].material.opacity=e/100}))}},{key:"setOtherVisible",value:function(e){var t=new Array(3).fill(e),i=c(t,3);this.top.visible=i[0],this.front.visible=i[1],this.side.visible=i[2]}},{key:"getReferenceCoordinates",value:function(e){var t=this[e].getObjectByName(o["default"].CAMERA_REFERENCE).matrixWorld.elements;return new a["Vector3"](t[12],t[13],t[14])}}]),e}();function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16777215,i=new a["EdgesGeometry"](e.geometry),r=new a["LineSegments"](i,new a["LineBasicMaterial"]({color:t,linewidth:3}));return r.name=o["default"].CUBOID_EDGE_NAME,e.add(r),r}function S(e){var t=new a["SphereGeometry"](.1),i=new a["MeshBasicMaterial"]({color:"#ffffff",opacity:1});e.geometry.deleteAttribute("normal"),e.geometry.deleteAttribute("uv"),e.geometry=Object(r["a"])(e.geometry);for(var s=[],o=e.geometry.getAttribute("position"),n=0;n<o.count;n+=1){var c=new a["Vector3"];c.fromBufferAttribute(o,n),s.push(c)}for(var l=[],h=0;h<s.length;h+=1)l[h]=new a["Mesh"](t.clone(),i.clone()),l[h].position.set(s[h].x,s[h].y,s[h].z),l[h].up.set(0,0,1),l[h].name="resizeHelper",e.add(l[h]),l[h].scale.set(1/e.scale.x,1/e.scale.y,1/e.scale.z);e.userData=p(p({},e.userData),{},{resizeHelpers:l})}function V(e,t){var i=new a["SphereGeometry"](.1),r=new a["MeshBasicMaterial"]({color:"#ffffff",opacity:1}),n=new a["Mesh"](i,r);switch(n.name=o["default"].ROTATION_HELPER,t){case s["ViewType"].TOP:n.position.set(e.geometry.parameters.height/2+o["default"].ROTATION_HELPER_OFFSET,e.position.y,e.position.z),e.add(n.clone()),e.userData=p(p({},e.userData),{},{rotationHelpers:n.clone()});break;case s["ViewType"].SIDE:case s["ViewType"].FRONT:n.position.set(e.position.x,e.position.y,e.geometry.parameters.depth/2+o["default"].ROTATION_HELPER_OFFSET),e.add(n.clone()),e.userData=p(p({},e.userData),{},{rotationHelpers:n.clone()});break;default:break}}var C=function(e){var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/t},x=function(e,t){var i=document.createElement("canvas"),a=i.getContext("2d"),r=C(a);return i.width=80*r,i.height=30*r,a.scale(r,r),a.fillStyle=t,a.fillRect(1,1,78,28),a.fillStyle="white",a.font="normal 14px verdana",a.fillText(e,5,20),i};function R(e){var t=e.getObjectByName("mainLabel");t&&e.remove(t);var i=e.userData.labelInfo,r=new a["Texture"](x(i.name,i.color));r.needsUpdate=!0;var s=new a["SpriteMaterial"]({map:r}),o=new a["Sprite"](s);o.scale.set(.3,.15,.3);var n=e.geometry.attributes.position;o.position.set(n.getX(7),n.getY(7),n.getZ(7)+o.scale.y/2),e.add(o)}}}]);