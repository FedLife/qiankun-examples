(window["webpackJsonp_dubhe_web"]=window["webpackJsonp_dubhe_web"]||[]).push([["tadl-detail-components-runParameter"],{"20ae":function(e,t,a){"use strict";a("f549")},"5e83":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"rel app-content-section run-parameter-card"},[a("div",{staticClass:"app-content-title mb-20"},[e._v("当前阶段运行参数")]),e._v(" "),a("el-form",{ref:"form",attrs:{model:e.state.model,"label-position":"top"}},[a("el-row",{staticClass:"mb-50",attrs:{gutter:16}},[a("div",{staticClass:"flex flex-between"},[a("div",[e._v("持续时间")]),e._v(" "),a("div",[e._v("当前阶段最长持续时间")])]),e._v(" "),a("div",{staticClass:"flex flex-between"},[a("div",{staticClass:"el-form-item-explain"},[a("span",{staticClass:"primary"},[e._v(e._s(e.duration))]),e._v(" / "+e._s(e.maxExecDurationStr)+"\n        ")]),e._v(" "),a("div",[a("span",[e._v(e._s(e.maxExecDurationStr))]),e._v(" "),a("Edit",{staticClass:"edit-icon",attrs:{row:e.state.rawModel,valueBy:"maxExecDuration",title:"修改最长持续时间",rules:"required|validInteger",label:"时间",beforeChange:e.validateParam},on:{handleOk:e.handleMaxExecDurationChange}},[a("el-select",{attrs:{slot:"append",placeholder:"请选择"},slot:"append",model:{value:e.state.rawModel.maxExecDurationUnit,callback:function(t){e.$set(e.state.rawModel,"maxExecDurationUnit",t)},expression:"state.rawModel.maxExecDurationUnit"}},e._l(e.timeFmts,(function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})})),1)],1)],1)]),e._v(" "),a("el-progress",{attrs:{percentage:e.execDurPercent,"show-text":!1}})],1),e._v(" "),a("el-row",{staticClass:"mb-50",attrs:{gutter:16}},[a("div",{staticClass:"flex flex-between"},[a("div",[e._v("Trial数量")]),e._v(" "),a("div",[e._v("当前阶段最大Trial数量")])]),e._v(" "),a("div",{staticClass:"flex flex-between"},[a("div",{staticClass:"el-form-item-explain"},[a("span",{staticClass:"primary"},[e._v(e._s(e.state.model.trialNum))]),e._v(" /\n          "+e._s(e.state.model.maxTrialNum)+"\n        ")]),e._v(" "),a("div",[a("span",[e._v(e._s(e.state.model.maxTrialNum))]),e._v(" "),a("Edit",{staticClass:"edit-icon",attrs:{row:e.state.model,disabled:e.isOneTrial,valueBy:"maxTrialNum",title:"修改最大 Trial 数量",rules:"required|validInteger",label:"Trial 数量",beforeChange:e.validateParam},on:{handleOk:e.handleMaxTrialNumChange}})],1)]),e._v(" "),a("el-progress",{attrs:{percentage:e.trialPercent,"show-text":!1}})],1),e._v(" "),a("el-row",{attrs:{gutter:16}},[a("div",{staticClass:"flex flex-between"},[a("div"),e._v(" "),a("div",[e._v("Trial并发数")])]),e._v(" "),a("div",{staticClass:"flex flex-end"},[a("span",[e._v(e._s(e.state.model.trialConcurrentNum))]),e._v(" "),a("Edit",{staticClass:"edit-icon",attrs:{row:e.state.model,disabled:e.isOneTrial,valueBy:"trialConcurrentNum",title:"修改 Trial 并发数",rules:"required|validInteger",label:"最大 Trial 数量",beforeChange:e.validateParam},on:{handleOk:e.handleConcurrentNumChange}})],1)])],1)],1)},n=[],i=a("ed09"),l=a("5c96"),o=a("2ef0"),u=a("e3a3"),s=a("ed08"),c=a("92b4"),m=a("7f9b");function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){b(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e,t,a){return t=p(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function p(e){var t=x(e,"string");return"symbol"===d(t)?t:String(t)}function x(e,t){if("object"!==d(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var O={name:"ExpRunParameter",components:{Edit:u["a"]},props:{param:Object,isOneTrial:Boolean,experimentId:String,stage:String,refresh:Function},setup:function(e){var t=Object(i["a"])((function(){return Object(m["getStageOrder"])(e.stage)})),a=function(e){return Object(o["pick"])(e,["maxExecDurationUnit","maxExecDuration","maxTrialNum","trialConcurrentNum"])},r=Object(i["n"])({model:e.param,rawModel:a(e.param)}),n=Object(i["a"])((function(){var e=r.model.maxExecDuration+r.model.maxExecDurationUnit;return e})),u=Object(i["a"])((function(){return Object(m["parseRunTime"])(r.model.maxExecDuration,r.model.maxExecDurationUnit)})),d=Object(i["a"])((function(){return Object(m["runTimeFormatter"])(r.model.runTime)||0})),v=Object(i["a"])((function(){return Math.min(100,Object(s["Qb"])(r.model.runTime/u.value,2,0))})),p=Object(i["a"])((function(){return Math.min(100,Object(s["Qb"])(r.model.trialNum/r.model.maxTrialNum,2,0))})),x=function(e,t,a){var n=a.valueBy,i=[];if("maxExecDuration"===n){var l=Object(m["parseRunTime"])(e,t.maxExecDurationUnit),o=r.model.runTime;l<=o&&i.push("修改后时间不能小于当前运行时间")}else"maxTrialNum"===n?e<r.model.trialNum&&i.push("修改后最大 trial 数量不能小于当前运行中数量"):"trialConcurrentNum"===n&&e>r.model.maxTrialNum&&i.push("修改后 trial 并发数量不能大于总的 trial 数量");return i},O=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=x(e,t,r);return new Promise((function(e,t){a.value.applyResult({errors:n,valid:!1,failedRules:{}}),0===n.length?e(!0):t(n)}))},g=function(e,t,n){var i=n.valueBy,l=f(f(f({},r.model),t),b({},i,e));Object.assign(r,{model:l,rawModel:a(l)})},y=function(a,r,n){var i=n.valueBy;Object(c["v"])(e.experimentId,t.value,a).then((function(){l["Message"].success("修改运行参数成功"),g(a,r,{valueBy:i}),e.refresh()}))},h=function(a,r,n){var i=n.valueBy;Object(c["y"])(e.experimentId,t.value,a).then((function(){l["Message"].success("修改运行参数成功"),g(a,r,{valueBy:i})})),e.refresh()},_=function(a,r,n){var i=n.valueBy;Object(c["x"])(e.experimentId,t.value,a,r.maxExecDurationUnit).then((function(){l["Message"].success("修改运行参数成功"),g(a,r,{valueBy:i})}))};return Object(i["r"])((function(){return e.param}),(function(e){e&&Object.assign(r,{model:e,rawModel:a(e)})})),{state:r,maxExecDurationStr:n,maxExecDuration:u,duration:d,execDurPercent:v,trialPercent:p,timeFmts:m["timeFmts"],handleConcurrentNumChange:y,handleMaxTrialNumChange:h,handleMaxExecDurationChange:_,validateParam:O}}},g=O,y=(a("20ae"),a("b198"),a("2877")),h=Object(y["a"])(g,r,n,!1,null,"78ba11be",null);t["default"]=h.exports},b198:function(e,t,a){"use strict";a("d559")},d559:function(e,t,a){},f549:function(e,t,a){}}]);