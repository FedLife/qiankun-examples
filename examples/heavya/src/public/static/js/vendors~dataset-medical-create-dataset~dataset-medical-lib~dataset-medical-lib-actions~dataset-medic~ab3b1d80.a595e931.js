(window["webpackJsonp_dubhe_web"]=window["webpackJsonp_dubhe_web"]||[]).push([["vendors~dataset-medical-create-dataset~dataset-medical-lib~dataset-medical-lib-actions~dataset-medic~ab3b1d80"],{acd4:function(e,t,r){(function(t,a){/*! dicom-parser - 1.8.12 - 2023-02-20 | (c) 2017 Chris Hafey | https://github.com/cornerstonejs/dicomParser */
!function(t,a){e.exports=a(r(17))}(0,(function(e){return n=[function(t,r){t.exports=e},function(e,r,n){"use strict";n.r(r),n.d(r,"isStringVr",(function(){return o})),n.d(r,"isPrivateTag",(function(){return s})),n.d(r,"parsePN",(function(){return d})),n.d(r,"parseTM",(function(){return c})),n.d(r,"parseDA",(function(){return u})),n.d(r,"explicitElementToString",(function(){return l})),n.d(r,"explicitDataSetToJS",(function(){return p})),n.d(r,"createJPEGBasicOffsetTable",(function(){return g})),n.d(r,"parseDicomDataSetExplicit",(function(){return k})),n.d(r,"parseDicomDataSetImplicit",(function(){return M})),n.d(r,"readFixedString",(function(){return w})),n.d(r,"alloc",(function(){return R})),n.d(r,"version",(function(){return G})),n.d(r,"bigEndianByteArrayParser",(function(){return L})),n.d(r,"ByteStream",(function(){return j})),n.d(r,"sharedCopy",(function(){return B})),n.d(r,"DataSet",(function(){return D})),n.d(r,"findAndSetUNElementLength",(function(){return b})),n.d(r,"findEndOfEncapsulatedElement",(function(){return v})),n.d(r,"findItemDelimitationItemAndSetElementLength",(function(){return E})),n.d(r,"littleEndianByteArrayParser",(function(){return N})),n.d(r,"parseDicom",(function(){return W})),n.d(r,"readDicomElementExplicit",(function(){return F})),n.d(r,"readDicomElementImplicit",(function(){return x})),n.d(r,"readEncapsulatedImageFrame",(function(){return X})),n.d(r,"readEncapsulatedPixelData",(function(){return Y})),n.d(r,"readEncapsulatedPixelDataFromFragments",(function(){return Q})),n.d(r,"readPart10Header",(function(){return V})),n.d(r,"readSequenceItemsExplicit",(function(){return _})),n.d(r,"readSequenceItemsImplicit",(function(){return O})),n.d(r,"readSequenceItem",(function(){return A})),n.d(r,"readTag",(function(){return y}));var i={AE:!0,AS:!0,AT:!1,CS:!0,DA:!0,DS:!0,DT:!0,FL:!1,FD:!1,IS:!0,LO:!0,LT:!0,OB:!1,OD:!1,OF:!1,OW:!1,PN:!0,SH:!0,SL:!1,SQ:!1,SS:!1,ST:!0,TM:!0,UI:!0,UL:!1,UN:void 0,UR:!0,US:!1,UT:!0},o=function(e){return i[e]},s=function(e){if(e=parseInt(e[4],16),isNaN(e))throw"dicomParser.isPrivateTag: cannot parse last character of group";return e%2==1},d=function(e){if(void 0!==e)return e=e.split("^"),{familyName:e[0],givenName:e[1],middleName:e[2],prefix:e[3],suffix:e[4]}};function c(e,t){if(2<=e.length){var r=parseInt(e.substring(0,2),10),a=4<=e.length?parseInt(e.substring(2,4),10):void 0,n=6<=e.length?parseInt(e.substring(4,6),10):void 0,i=8<=e.length?e.substring(7,13):void 0;i=i?parseInt(i,10)*Math.pow(10,6-i.length):void 0;if(t&&(isNaN(r)||void 0!==a&&isNaN(a)||void 0!==n&&isNaN(n)||void 0!==i&&isNaN(i)||r<0||23<r||a&&(a<0||59<a)||n&&(n<0||59<n)||i&&(i<0||999999<i)))throw"invalid TM '".concat(e,"'");return{hours:r,minutes:a,seconds:n,fractionalSeconds:i}}if(t)throw"invalid TM '".concat(e,"'")}function f(e,t,r){return!isNaN(r)&&0<t&&t<=12&&0<e&&e<=function(e,t){switch(e){case 2:return t%4==0&&t%100||t%400==0?29:28;case 9:case 4:case 6:case 11:return 30;default:return 31}}(t,r)}function u(e,t){if(e&&8===e.length){var r=parseInt(e.substring(0,4),10),a=parseInt(e.substring(4,6),10),n=parseInt(e.substring(6,8),10);if(t&&!0!==f(n,a,r))throw"invalid DA '".concat(e,"'");return{year:r,month:a,day:n}}if(t)throw"invalid DA '".concat(e,"'")}function l(e,t){if(void 0===e||void 0===t)throw"dicomParser.explicitElementToString: missing required parameters";if(void 0===t.vr)throw"dicomParser.explicitElementToString: cannot convert implicit element to string";var r,a=t.vr,n=t.tag;function i(t,r){for(var a="",i=0;i<t;i++)0!==i&&(a+="/"),a+=r.call(e,n,i).toString();return a}if(!0===o(a))r=e.string(n);else{if("AT"===a){var s=e.uint32(n);return void 0===s?void 0:"x".concat((s=s<0?4294967295+s+1:s).toString(16).toUpperCase())}"US"===a?r=i(t.length/2,e.uint16):"SS"===a?r=i(t.length/2,e.int16):"UL"===a?r=i(t.length/4,e.uint32):"SL"===a?r=i(t.length/4,e.int32):"FD"===a?r=i(t.length/8,e.double):"FL"===a&&(r=i(t.length/4,e.float))}return r}function p(e,t){if(void 0===e)throw"dicomParser.explicitDataSetToJS: missing required parameter dataSet";t=t||{omitPrivateAttibutes:!0,maxElementLength:128};var r,a={};for(r in e.elements){var n=e.elements[r];if(!0!==t.omitPrivateAttibutes||!s(r))if(n.items){for(var i=[],o=0;o<n.items.length;o++)i.push(p(n.items[o].dataSet,t));a[r]=i}else{var d=void 0;n.length<t.maxElementLength&&(d=l(e,n)),a[r]=void 0!==d?d:{dataOffset:n.dataOffset,length:n.length}}}return a}function h(e,t){return 255===e.byteArray[t]&&217===e.byteArray[t+1]}function m(e,t,r){for(var a,n,i=r;i<t.fragments.length;i++)if(a=e,n=i,n=t.fragments[n],h(a,n.position+n.length-2)||h(a,n.position+n.length-3))return i}function g(e,t,r){if(void 0===e)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter dataSet";if(void 0===t)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter pixelDataElement";if("x7fe00010"!==t.tag)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(!0!==t.encapsulatedPixelData)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.basicOffsetTable)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.fragments)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(t.fragments.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(r&&r.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'fragments' must not be zero length";r=r||t.fragments;for(var a=[],n=0;;){a.push(t.fragments[n].offset);var i=m(e,t,n);if(void 0===i||i===t.fragments.length-1)return a;n=i+1}}function y(e){if(void 0===e)throw"dicomParser.readTag: missing required parameter 'byteStream'";var t=256*e.readUint16()*256;e=e.readUint16();return"x".concat("00000000".concat((t+e).toString(16)).substr(-8))}function v(e,t,r){if(void 0===e)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'element'";if(t.encapsulatedPixelData=!0,t.basicOffsetTable=[],t.fragments=[],"xfffee000"!==y(e))throw"dicomParser.findEndOfEncapsulatedElement: basic offset table not found";for(var a=e.readUint32()/4,n=0;n<a;n++){var i=e.readUint32();t.basicOffsetTable.push(i)}for(var o=e.position;e.position<e.byteArray.length;){var s=y(e),d=e.readUint32();if("xfffee0dd"===s)return e.seek(d),void(t.length=e.position-t.dataOffset);if("xfffee000"!==s)return r&&r.push("unexpected tag ".concat(s," while searching for end of pixel data element with undefined length")),d>e.byteArray.length-e.position&&(d=e.byteArray.length-e.position),t.fragments.push({offset:e.position-o-8,position:e.position,length:d}),e.seek(d),void(t.length=e.position-t.dataOffset);t.fragments.push({offset:e.position-o-8,position:e.position,length:d}),e.seek(d)}r&&r.push("pixel data element ".concat(t.tag," missing sequence delimiter tag xfffee0dd"))}function b(e,t){if(void 0===e)throw"dicomParser.findAndSetUNElementLength: missing required parameter 'byteStream'";for(var r=e.byteArray.length-8;e.position<=r;)if(65534===e.readUint16()){var a=e.readUint16();if(57565===a)return 0!==e.readUint32()&&e.warnings("encountered non zero length following item delimiter at position ".concat(e.position-4," while reading element of undefined length with tag ").concat(t.tag)),void(t.length=e.position-t.dataOffset)}t.length=e.byteArray.length-t.dataOffset,e.seek(e.byteArray.length-e.position)}function w(e,t,r){if(r<0)throw"dicomParser.readFixedString - length cannot be less than 0";if(t+r>e.length)throw"dicomParser.readFixedString: attempt to read past end of buffer";for(var a,n="",i=0;i<r;i++){if(0===(a=e[t+i]))return t+=r,n;n+=String.fromCharCode(a)}return n}function I(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function P(e,t){return void 0!==e.parser?e.parser:t}var D=function(){function e(t,r,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.byteArrayParser=t,this.byteArray=r,this.elements=a}var t,r,a;return t=e,(r=[{key:"uint16",value:function(e,t){if(e=this.elements[e],t=void 0!==t?t:0,e&&0!==e.length)return P(e,this.byteArrayParser).readUint16(this.byteArray,e.dataOffset+2*t)}},{key:"int16",value:function(e,t){if(e=this.elements[e],t=void 0!==t?t:0,e&&0!==e.length)return P(e,this.byteArrayParser).readInt16(this.byteArray,e.dataOffset+2*t)}},{key:"uint32",value:function(e,t){if(e=this.elements[e],t=void 0!==t?t:0,e&&0!==e.length)return P(e,this.byteArrayParser).readUint32(this.byteArray,e.dataOffset+4*t)}},{key:"int32",value:function(e,t){if(e=this.elements[e],t=void 0!==t?t:0,e&&0!==e.length)return P(e,this.byteArrayParser).readInt32(this.byteArray,e.dataOffset+4*t)}},{key:"float",value:function(e,t){if(e=this.elements[e],t=void 0!==t?t:0,e&&0!==e.length)return P(e,this.byteArrayParser).readFloat(this.byteArray,e.dataOffset+4*t)}},{key:"double",value:function(e,t){if(e=this.elements[e],t=void 0!==t?t:0,e&&0!==e.length)return P(e,this.byteArrayParser).readDouble(this.byteArray,e.dataOffset+8*t)}},{key:"numStringValues",value:function(e){if(e=this.elements[e],e&&0<e.length)return e=w(this.byteArray,e.dataOffset,e.length).match(/\\/g),null===e?1:e.length+1}},{key:"string",value:function(e,t){return e=this.elements[e],e&&e.Value?e.Value:e&&0<e.length?(e=w(this.byteArray,e.dataOffset,e.length),0<=t?e.split("\\")[t].trim():e.trim()):void 0}},{key:"text",value:function(e,t){if(e=this.elements[e],e&&0<e.length)return e=w(this.byteArray,e.dataOffset,e.length),0<=t?e.split("\\")[t].replace(/ +$/,""):e.replace(/ +$/,"")}},{key:"floatString",value:function(e,t){var r=this.elements[e];if(r&&0<r.length&&(t=this.string(e,t=void 0!==t?t:0),void 0!==t))return parseFloat(t)}},{key:"intString",value:function(e,t){var r=this.elements[e];if(r&&0<r.length&&(t=this.string(e,t=void 0!==t?t:0),void 0!==t))return parseInt(t)}},{key:"attributeTag",value:function(e){var t=this.elements[e];if(t&&4===t.length){var r=P(t,this.byteArrayParser).readUint16;e=this.byteArray,t=t.dataOffset;return"x".concat("00000000".concat((256*r(e,t)*256+r(e,t+2)).toString(16)).substr(-8))}}}])&&I(t.prototype,r),a&&I(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();function E(e,t){if(void 0===e)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";for(var r=e.byteArray.length-8;e.position<=r;)if(65534===e.readUint16()){var a=e.readUint16();if(57357===a)return 0!==e.readUint32()&&e.warnings("encountered non zero length following item delimiter at position ".concat(e.position-4," while reading element of undefined length with tag ").concat(t.tag)),void(t.length=e.position-t.dataOffset)}t.length=e.byteArray.length-t.dataOffset,e.seek(e.byteArray.length-e.position)}var U=function(e,t){return void 0!==e.vr?"SQ"===e.vr:t.position+4<=t.byteArray.length?(e=y(t),t.seek(-4),"xfffee000"===e||"xfffee0dd"===e):(t.warnings.push("eof encountered before finding sequence item tag or sequence delimiter tag in peeking to determine VR"),!1)};function x(e,t,r){if(void 0===e)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";var a=y(e);a={tag:a,vr:void 0!==r?r(a):void 0,length:e.readUint32(),dataOffset:e.position};return 4294967295===a.length&&(a.hadUndefinedLength=!0),a.tag===t||(!U(a,e)||s(a.tag)&&!a.hadUndefinedLength?a.hadUndefinedLength?E(e,a):e.seek(a.length):(O(e,a,r),s(a.tag)&&(a.items=void 0))),a}function A(e){if(void 0===e)throw"dicomParser.readSequenceItem: missing required parameter 'byteStream'";var t={tag:y(e),length:e.readUint32(),dataOffset:e.position};if("xfffee000"!==t.tag)throw"dicomParser.readSequenceItem: item tag (FFFE,E000) not found at offset ".concat(e.position);return t}function S(e,t){var r=A(e);return 4294967295===r.length?(r.hadUndefinedLength=!0,r.dataSet=function(e,t){for(var r={};e.position<e.byteArray.length;){var a=x(e,void 0,t);if("xfffee00d"===(r[a.tag]=a).tag)return new D(e.byteArrayParser,e.byteArray,r)}return e.warnings.push("eof encountered before finding sequence item delimiter in sequence item of undefined length"),new D(e.byteArrayParser,e.byteArray,r)}(e,t),r.length=e.position-r.dataOffset):(r.dataSet=new D(e.byteArrayParser,e.byteArray,{}),M(r.dataSet,e,e.position+r.length,{vrCallback:t})),r}function O(e,t,r){if(void 0===e)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'element'";t.items=[],(4294967295===t.length?function(e,t,r){for(;e.position+4<=e.byteArray.length;){var a=y(e);if(e.seek(-4),"xfffee0dd"===a)return t.length=e.position-t.dataOffset,e.seek(8);a=S(e,r),t.items.push(a)}e.warnings.push("eof encountered before finding sequence delimiter in sequence of undefined length"),t.length=e.byteArray.length-t.dataOffset}:function(e,t,r){for(var a=t.dataOffset+t.length;e.position<a;){var n=S(e,r);t.items.push(n)}})(e,t,r)}function T(e,t){var r=A(e);return 4294967295===r.length?(r.hadUndefinedLength=!0,r.dataSet=function(e,t){for(var r={};e.position<e.byteArray.length;){var a=F(e,t);if("xfffee00d"===(r[a.tag]=a).tag)return new D(e.byteArrayParser,e.byteArray,r)}return t.push("eof encountered before finding item delimiter tag while reading sequence item of undefined length"),new D(e.byteArrayParser,e.byteArray,r)}(e,t),r.length=e.position-r.dataOffset):(r.dataSet=new D(e.byteArrayParser,e.byteArray,{}),k(r.dataSet,e,e.position+r.length)),r}function _(e,t,r){if(void 0===e)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'element'";t.items=[],(4294967295===t.length?function(e,t,r){for(;e.position+4<=e.byteArray.length;){var a=y(e);if(e.seek(-4),"xfffee0dd"===a)return t.length=e.position-t.dataOffset,e.seek(8);a=T(e,r),t.items.push(a)}r.push("eof encountered before finding sequence delimitation tag while reading sequence of undefined length"),t.length=e.position-t.dataOffset}:function(e,t,r){for(var a=t.dataOffset+t.length;e.position<a;){var n=T(e,r);t.items.push(n)}})(e,t,r)}var q=function(e){return"OB"===e||"OD"===e||"OL"===e||"OW"===e||"SQ"===e||"OF"===e||"UC"===e||"UR"===e||"UT"===e||"UN"===e?4:2};function F(e,t,r){if(void 0===e)throw"dicomParser.readDicomElementExplicit: missing required parameter 'byteStream'";var a={tag:y(e),vr:e.readFixedString(2)};return 2===q(a.vr)?a.length=e.readUint16():(e.seek(2),a.length=e.readUint32()),a.dataOffset=e.position,4294967295===a.length&&(a.hadUndefinedLength=!0),a.tag===r||("SQ"===a.vr?_(e,a,t):4294967295===a.length?"x7fe00010"===a.tag?v(e,a,t):("UN"===a.vr?O:E)(e,a):e.seek(a.length)),a}function k(e,t,r){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};if(r=void 0===r?t.byteArray.length:r,void 0===t)throw"dicomParser.parseDicomDataSetExplicit: missing required parameter 'byteStream'";if(r<t.position||r>t.byteArray.length)throw"dicomParser.parseDicomDataSetExplicit: invalid value for parameter 'maxP osition'";for(var n=e.elements;t.position<r;){var i=F(t,e.warnings,a.untilTag);if((n[i.tag]=i).tag===a.untilTag)return}if(t.position>r)throw"dicomParser:parseDicomDataSetExplicit: buffer overrun"}function M(e,t,r){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};if(r=void 0===r?e.byteArray.length:r,void 0===t)throw"dicomParser.parseDicomDataSetImplicit: missing required parameter 'byteStream'";if(r<t.position||r>t.byteArray.length)throw"dicomParser.parseDicomDataSetImplicit: invalid value for parameter 'maxPosition'";for(var n=e.elements;t.position<r;){var i=x(t,a.untilTag,a.vrCallback);if((n[i.tag]=i).tag===a.untilTag)return}}function R(e,r){if("undefined"!=typeof t&&e instanceof t)return t.alloc(r);if(e instanceof Uint8Array)return new Uint8Array(r);throw"dicomParser.alloc: unknown type for byteArray"}var G="1.8.12",L={readUint16:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readUint16: position cannot be less than 0";if(t+2>e.length)throw"bigEndianByteArrayParser.readUint16: attempt to read past end of buffer";return(e[t]<<8)+e[t+1]},readInt16:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readInt16: position cannot be less than 0";if(t+2>e.length)throw"bigEndianByteArrayParser.readInt16: attempt to read past end of buffer";return t=(e[t]<<8)+e[t+1],32768&t?t-65535-1:t},readUint32:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readUint32: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readUint32: attempt to read past end of buffer";return 256*(256*(256*e[t]+e[t+1])+e[t+2])+e[t+3]},readInt32:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readInt32: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readInt32: attempt to read past end of buffer";return(e[t]<<24)+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3]},readFloat:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readFloat: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readFloat: attempt to read past end of buffer";var r=new Uint8Array(4);return r[3]=e[t],r[2]=e[t+1],r[1]=e[t+2],r[0]=e[t+3],new Float32Array(r.buffer)[0]},readDouble:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readDouble: position cannot be less than 0";if(t+8>e.length)throw"bigEndianByteArrayParser.readDouble: attempt to read past end of buffer";var r=new Uint8Array(8);return r[7]=e[t],r[6]=e[t+1],r[5]=e[t+2],r[4]=e[t+3],r[3]=e[t+4],r[2]=e[t+5],r[1]=e[t+6],r[0]=e[t+7],new Float64Array(r.buffer)[0]}};function B(e,r,a){if("undefined"!=typeof t&&e instanceof t)return e.slice(r,r+a);if(e instanceof Uint8Array)return new Uint8Array(e.buffer,e.byteOffset+r,a);throw"dicomParser.from: unknown type for byteArray"}function C(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var j=function(){function e(r,a,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),void 0===r)throw"dicomParser.ByteStream: missing required parameter 'byteArrayParser'";if(void 0===a)throw"dicomParser.ByteStream: missing required parameter 'byteArray'";if(a instanceof Uint8Array==0&&("undefined"==typeof t||a instanceof t==0))throw"dicomParser.ByteStream: parameter byteArray is not of type Uint8Array or Buffer";if(n<0)throw"dicomParser.ByteStream: parameter 'position' cannot be less than 0";if(n>=a.length)throw"dicomParser.ByteStream: parameter 'position' cannot be greater than or equal to 'byteArray' length";this.byteArrayParser=r,this.byteArray=a,this.position=n||0,this.warnings=[]}var r,a,n;return r=e,(a=[{key:"seek",value:function(e){if(this.position+e<0)throw"dicomParser.ByteStream.prototype.seek: cannot seek to position < 0";this.position+=e}},{key:"readByteStream",value:function(t){if(this.position+t>this.byteArray.length)throw"dicomParser.ByteStream.prototype.readByteStream: readByteStream - buffer overread";var r=B(this.byteArray,this.position,t);return this.position+=t,new e(this.byteArrayParser,r)}},{key:"getSize",value:function(){return this.byteArray.length}},{key:"readUint16",value:function(){var e=this.byteArrayParser.readUint16(this.byteArray,this.position);return this.position+=2,e}},{key:"readUint32",value:function(){var e=this.byteArrayParser.readUint32(this.byteArray,this.position);return this.position+=4,e}},{key:"readFixedString",value:function(e){var t=w(this.byteArray,this.position,e);return this.position+=e,t}}])&&C(r.prototype,a),n&&C(r,n),Object.defineProperty(r,"prototype",{writable:!1}),e}(),N={readUint16:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readUint16: position cannot be less than 0";if(t+2>e.length)throw"littleEndianByteArrayParser.readUint16: attempt to read past end of buffer";return e[t]+256*e[t+1]},readInt16:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readInt16: position cannot be less than 0";if(t+2>e.length)throw"littleEndianByteArrayParser.readInt16: attempt to read past end of buffer";return t=e[t]+(e[t+1]<<8),32768&t?t-65535-1:t},readUint32:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readUint32: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readUint32: attempt to read past end of buffer";return e[t]+256*e[t+1]+256*e[t+2]*256+256*e[t+3]*256*256},readInt32:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readInt32: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readInt32: attempt to read past end of buffer";return e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24)},readFloat:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readFloat: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readFloat: attempt to read past end of buffer";var r=new Uint8Array(4);return r[0]=e[t],r[1]=e[t+1],r[2]=e[t+2],r[3]=e[t+3],new Float32Array(r.buffer)[0]},readDouble:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readDouble: position cannot be less than 0";if(t+8>e.length)throw"littleEndianByteArrayParser.readDouble: attempt to read past end of buffer";var r=new Uint8Array(8);return r[0]=e[t],r[1]=e[t+1],r[2]=e[t+2],r[3]=e[t+3],r[4]=e[t+4],r[5]=e[t+5],r[6]=e[t+6],r[7]=e[t+7],new Float64Array(r.buffer)[0]}};function V(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(void 0===e)throw"dicomParser.readPart10Header: missing required parameter 'byteArray'";var r=t.TransferSyntaxUID,a=new j(N,e);return function(){var e=function(){if(a.getSize()<=132&&r)return!1;if(a.seek(128),"DICM"===a.readFixedString(4))return!0;if(!(t||{}).TransferSyntaxUID)throw"dicomParser.readPart10Header: DICM prefix not found at location 132 - this is not a valid DICOM P10 file.";return a.seek(0),!1}(),n=[],i={};if(!e)return a.position=0,{elements:{x00020010:{tag:"x00020010",vr:"UI",Value:r}},warnings:n};for(;a.position<a.byteArray.length;){var o=a.position,s=F(a,n);if("x0002ffff"<s.tag){a.position=o;break}s.parser=N,i[s.tag]=s}return(e=new D(a.byteArrayParser,a.byteArray,i)).warnings=a.warnings,e.position=a.position,e}()}var J="1.2.840.10008.1.2.2";function W(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(void 0===e)throw new Error("dicomParser.parseDicom: missing required parameter 'byteArray'");var r,i=function(t){if(void 0===t.elements.x00020010)throw new Error("dicomParser.parseDicom: missing required meta header attribute 0002,0010");return t=t.elements.x00020010,t&&t.Value||w(e,t.dataOffset,t.length)};function o(r){var o=i(r),s="1.2.840.10008.1.2"!==o;o=function(r,i){var o="[object process]"===Object.prototype.toString.call("undefined"!=typeof a?a:0);if("1.2.840.10008.1.2.1.99"!==r)return new j(r===J?L:N,e,i);if(t&&t.inflater)return r=t.inflater(e,i),new j(N,r,0);if(1==o){var s=n(0),d=B(e,i,e.length-i);s=s.inflateRawSync(d),d=R(e,s.length+i);return e.copy(d,0,0,i),s.copy(d,i),new j(N,d,0)}if("undefined"==typeof pako)throw"dicomParser.parseDicom: no inflater available to handle deflate transfer syntax";return s=e.slice(i),d=pako.inflateRaw(s),(s=R(e,d.length+i)).set(e.slice(0,i),0),s.set(d,i),new j(N,s,0)}(o,r.position),r=new D(o.byteArrayParser,o.byteArray,{});r.warnings=o.warnings;try{(s?k:M)(r,o,o.byteArray.length,t)}catch(o){throw{exception:o,dataSet:r}}return r}return function(e,t){for(var r in e.elements)e.elements.hasOwnProperty(r)&&(t.elements[r]=e.elements[r]);return void 0!==e.warnings&&(t.warnings=e.warnings.concat(t.warnings)),t}(r=V(e,t),o(r))}var H=function(e,t,r){for(var a=0,n=t;n<t+r;n++)a+=e[n].length;return a};function Q(e,t,r,a,n){if(n=n||t.fragments,void 0===e)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'dataSet'";if(void 0===t)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'pixelDataElement'";if(void 0===r)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'startFragmentIndex'";if(void 0===(a=a||1))throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'numFragments'";if("x7fe00010"!==t.tag)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010";if(!0!==t.encapsulatedPixelData)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.basicOffsetTable)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.fragments)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(t.fragments.length<=0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(r<0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be >= 0";if(r>=t.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be < number of fragments";if(a<1)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'numFragments' must be > 0";if(r+a>t.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragment' + 'numFragments' < number of fragments";var i=new j(e.byteArrayParser,e.byteArray,t.dataOffset);t=A(i);if("xfffee000"!==t.tag)throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";i.seek(t.length);var o=i.position;if(1===a)return B(i.byteArray,o+n[r].offset+8,n[r].length);t=H(n,r,a);for(var s=R(i.byteArray,t),d=0,c=r;c<r+a;c++)for(var f=o+n[c].offset+8,u=0;u<n[c].length;u++)s[d++]=i.byteArray[f++];return s}var z=function(e,t){for(var r=0;r<e.length;r++)if(e[r].offset===t)return r},$=function(e,t,r,a){if(e===t.length-1)return r.length-a;for(var n=t[e+1],i=a+1;i<r.length;i++)if(r[i].offset===n)return i-a;throw"dicomParser.calculateNumberOfFragmentsForFrame: could not find fragment with offset matching basic offset table"};function X(e,t,r,a,n){if(a=a||t.basicOffsetTable,n=n||t.fragments,void 0===e)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'dataSet'";if(void 0===t)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'pixelDataElement'";if(void 0===r)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'frameIndex'";if(void 0===a)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' does not have basicOffsetTable";if("x7fe00010"!==t.tag)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010)";if(!0!==t.encapsulatedPixelData)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have undefined length";if(void 0===t.fragments)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have fragments";if(0===a.length)throw"dicomParser.readEncapsulatedImageFrame: basicOffsetTable has zero entries";if(r<0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be >= 0";if(r>=a.length)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be < basicOffsetTable.length";var i=a[r];i=z(n,i);if(void 0===i)throw"dicomParser.readEncapsulatedImageFrame: unable to find fragment that matches basic offset table entry";return Q(e,t,i,$(r,a,n,i),n)}var K=!1;function Y(e,t,r){if(K||(K=!0,console&&console.log&&console.log("WARNING: dicomParser.readEncapsulatedPixelData() has been deprecated")),void 0===e)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'dataSet'";if(void 0===t)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'element'";if(void 0===r)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'frame'";if("x7fe00010"!==t.tag)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to non pixel data tag (expected tag = x7fe00010)";if(!0!==t.encapsulatedPixelData)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.basicOffsetTable)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(void 0===t.fragments)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(r<0)throw"dicomParser.readEncapsulatedPixelData: parameter 'frame' must be >= 0";return 0!==t.basicOffsetTable.length?X(e,t,r):Q(e,t,0,t.fragments.length)}r.default={isStringVr:o,isPrivateTag:s,parsePN:d,parseTM:c,parseDA:u,explicitElementToString:l,explicitDataSetToJS:p,createJPEGBasicOffsetTable:g,parseDicomDataSetExplicit:k,parseDicomDataSetImplicit:M,readFixedString:w,alloc:R,version:G,bigEndianByteArrayParser:L,ByteStream:j,sharedCopy:B,DataSet:D,findAndSetUNElementLength:b,findEndOfEncapsulatedElement:v,findItemDelimitationItemAndSetElementLength:E,littleEndianByteArrayParser:N,parseDicom:W,readDicomElementExplicit:F,readDicomElementImplicit:x,readEncapsulatedImageFrame:X,readEncapsulatedPixelData:Y,readEncapsulatedPixelDataFromFragments:Q,readPart10Header:V,readSequenceItemsExplicit:_,readSequenceItemsImplicit:O,readSequenceItem:A,readTag:y,LEI:"1.2.840.10008.1.2",LEE:"1.2.840.10008.1.2.1"}}],i={},r.m=n,r.c=i,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1);function r(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}var n,i}))}).call(this,r("b639").Buffer,r("4362"))},df03:function(e,t,r){"use strict";function a(e){return a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function s(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,a=r||e.length-t,n="",i=t;i<t+a;i++)n+=String.fromCharCode(e[i]);return n}function d(e){for(var t=new Uint8Array(e.length),r=0,a=e.length;r<a;r++)t[r]=e.charCodeAt(r);return t}function c(e){for(var t=e.split("\r\n"),r=0;r<t.length;r++)if("--"===t[r].substr(0,2))return t[r];return null}function f(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(r+t.length>e.length)return!1;for(var a=r,n=0;n<t.length;n++){if(t[n]!==e[a])return!1;a+=1}return!0}function u(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,n=e.length;a&&(n=Math.min(r+a,e.length));for(var i=r;i<n;i++)if(e[i]===t[0]&&f(e,t,i))return i;return-1}function l(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"".concat(e()+e(),"-").concat(e(),"-").concat(e(),"-").concat(e(),"-").concat(e()).concat(e()).concat(e())}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/dicom",a="Content-Type: ".concat(r),n="\r\n--".concat(t,"\r\n").concat(a,"\r\n\r\n"),i="\r\n--".concat(t,"--"),o=d(n),s=d(i),c=o.length,f=s.length,u=0,p=e.map((function(e){var t=new Uint8Array(e),r=t.length;return u+=c+r+f,t})),h=new Uint8Array(u);h.set(o,0);var m=0;return p.forEach((function(e){h.set(o,m),h.set(e,m+c),m+=c+e.length})),h.set(s,m),{data:h.buffer,boundary:t}}function h(e){var t=new Uint8Array(e),r=1e3,a=d("\r\n\r\n"),n=u(t,a,0,r);if(-1===n)throw new Error("Response message has no multipart mime header");var i=s(t,0,n),o=c(i);if(!o)throw new Error("Header of response message does not specify boundary");var f,l=d(o),p=l.length,h=[],m=p;while(-1!==f){if(f=u(t,l,m),-1===f)break;var g=u(t,a,m,r);if(-1===g)throw new Error("Response message part has no mime header");m=g+a.length;var y=2,v=e.slice(m,f-y);h.push(v),m=f+p}return h}function m(e){return"object"===a(e)&&null!==e}function g(e){return 0===Object.keys(e).length&&e.constructor===Object}r.d(t,"a",(function(){return I}));var y=function(e){return e[0]},v=function(e){return e.length>1?e:e[0]},b={DICOM:"application/dicom",DICOM_JSON:"application/dicom+json",OCTET_STREAM:"application/octet-stream",PDF:"application/pdf",JPEG:"image/jpeg",PNG:"image/png"},w=function(){function e(t){n(this,e),this.baseURL=t.url,this.baseURL||console.error("no DICOMweb base url provided - calls will fail"),"username"in t&&(this.username=t.username,"password"in t||console.error("no password provided to authenticate with DICOMweb service"),this.password=t.password),"qidoURLPrefix"in t?(console.log("use URL prefix for QIDO-RS: ".concat(t.qidoURLPrefix)),this.qidoURL="".concat(this.baseURL,"/").concat(t.qidoURLPrefix)):this.qidoURL=this.baseURL,"wadoURLPrefix"in t?(console.log("use URL prefix for WADO-RS: ".concat(t.wadoURLPrefix)),this.wadoURL="".concat(this.baseURL,"/").concat(t.wadoURLPrefix)):this.wadoURL=this.baseURL,"stowURLPrefix"in t?(console.log("use URL prefix for STOW-RS: ".concat(t.stowURLPrefix)),this.stowURL="".concat(this.baseURL,"/").concat(t.stowURLPrefix)):this.stowURL=this.baseURL,this.headers=t.headers||{},this.errorInterceptor=t.errorInterceptor||function(){}}return o(e,[{key:"_httpRequest",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=this.errorInterceptor;return new Promise((function(s,d){var c=new XMLHttpRequest;c.open(t,e,!0),"responseType"in i&&(c.responseType=i.responseType),"object"===a(r)&&Object.keys(r).forEach((function(e){c.setRequestHeader(e,r[e])}));var f=n.headers;Object.keys(f).forEach((function(e){c.setRequestHeader(e,f[e])})),c.onloadstart=function(){},c.onloadend=function(){},c.onreadystatechange=function(){if(4===c.readyState)if(200===c.status)s(c.response);else if(202===c.status)console.warn("some resources already existed: ",c),s(c.response);else if(204===c.status)console.warn("empty response for request: ",c),s([]);else{console.error("request failed: ",c);var e=new Error("request failed");e.request=c,e.response=c.response,e.status=c.status,console.error(e),console.error(e.response),o(e),d(e)}},"progressCallback"in i&&"function"===typeof i.progressCallback&&(c.onprogress=i.progressCallback),"data"in i?c.send(i.data):c.send()}))}},{key:"_httpGet",value:function(e,t,r,a){return this._httpRequest(e,"get",t,{responseType:r,progressCallback:a})}},{key:"_httpGetApplicationJson",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=t;"object"===a(r)&&(g(r)||(i+=e._parseQueryParameters(r)));var o={Accept:b.DICOM_JSON},s="json";return this._httpGet(i,o,s,n)}},{key:"_httpGetApplicationPdf",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=t;"object"===a(r)&&(g(r)||(i+=e._parseQueryParameters(r)));var o={Accept:b.PDF},s="json";return this._httpGet(i,o,s,n)}},{key:"_httpGetImage",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0,o=t;"object"===a(n)&&(g(n)||(o+=e._parseQueryParameters(n)));var s=["image/","image/*","image/jpeg","image/jp2","image/gif","image/png"],d=e._buildAcceptHeaderFieldValue(r,s),c={Accept:d},f="arraybuffer";return this._httpGet(o,c,f,i)}},{key:"_httpGetText",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0,o=t;"object"===a(n)&&(g(n)||(o+=e._parseQueryParameters(n)));var s=["text/","text/*","text/html","text/plain","text/rtf","text/xml"],d=e._buildAcceptHeaderFieldValue(r,s),c={Accept:d},f="arraybuffer";return this._httpGet(o,c,f,i)}},{key:"_httpGetVideo",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0,o=t;"object"===a(n)&&(g(n)||(o+=e._parseQueryParameters(n)));var s=["video/","video/*","video/mpeg","video/mp4","video/H265"],d=e._buildAcceptHeaderFieldValue(r,s),c={Accept:d},f="arraybuffer";return this._httpGet(o,c,f,i)}},{key:"_httpGetMultipartImage",value:function(t,r,a,n){var i,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0,d={};return o?i=["image/jpeg","image/gif","image/png","image/jp2"]:(i={"1.2.840.10008.1.2.5":["image/x-dicom-rle"],"1.2.840.10008.1.2.4.50":["image/jpeg"],"1.2.840.10008.1.2.4.51":["image/jpeg"],"1.2.840.10008.1.2.4.57":["image/jpeg"],"1.2.840.10008.1.2.4.70":["image/jpeg"],"1.2.840.10008.1.2.4.80":["image/x-jls","image/jls"],"1.2.840.10008.1.2.4.81":["image/x-jls","image/jls"],"1.2.840.10008.1.2.4.90":["image/jp2"],"1.2.840.10008.1.2.4.91":["image/jp2"],"1.2.840.10008.1.2.4.92":["image/jpx"],"1.2.840.10008.1.2.4.93":["image/jpx"]},a&&(d.Range=e._buildRangeHeaderFieldValue(a))),d.Accept=e._buildMultipartAcceptHeaderFieldValue(r,i),this._httpGet(t,d,"arraybuffer",s).then(h)}},{key:"_httpGetMultipartVideo",value:function(t,r,a,n){var i,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0,d={};return o?i=["video/","video/*","video/mpeg2","video/mp4","video/H265"]:(i={"1.2.840.10008.1.2.4.100":["video/mpeg2"],"1.2.840.10008.1.2.4.101":["video/mpeg2"],"1.2.840.10008.1.2.4.102":["video/mp4"],"1.2.840.10008.1.2.4.103":["video/mp4"],"1.2.840.10008.1.2.4.104":["video/mp4"],"1.2.840.10008.1.2.4.105":["video/mp4"],"1.2.840.10008.1.2.4.106":["video/mp4"]},a&&(d.Range=e._buildRangeHeaderFieldValue(a))),d.Accept=e._buildMultipartAcceptHeaderFieldValue(r,i),this._httpGet(t,d,"arraybuffer",s).then(h)}},{key:"_httpGetMultipartApplicationDicom",value:function(t,r,a,n){var i={},o="application/dicom",s={"1.2.840.10008.1.2.1":[o],"1.2.840.10008.1.2.5":[o],"1.2.840.10008.1.2.4.50":[o],"1.2.840.10008.1.2.4.51":[o],"1.2.840.10008.1.2.4.57":[o],"1.2.840.10008.1.2.4.70":[o],"1.2.840.10008.1.2.4.80":[o],"1.2.840.10008.1.2.4.81":[o],"1.2.840.10008.1.2.4.90":[o],"1.2.840.10008.1.2.4.91":[o],"1.2.840.10008.1.2.4.92":[o],"1.2.840.10008.1.2.4.93":[o],"1.2.840.10008.1.2.4.100":[o],"1.2.840.10008.1.2.4.101":[o],"1.2.840.10008.1.2.4.102":[o],"1.2.840.10008.1.2.4.103":[o],"1.2.840.10008.1.2.4.104":[o],"1.2.840.10008.1.2.4.105":[o],"1.2.840.10008.1.2.4.106":[o]},d=r;return r||(d=[{mediaType:o}]),i.Accept=e._buildMultipartAcceptHeaderFieldValue(d,s),this._httpGet(t,i,"arraybuffer",n).then(h)}},{key:"_httpGetMultipartApplicationOctetStream",value:function(t,r,a,n,i){var o={},s="application/octet-stream",d={"1.2.840.10008.1.2.1":[s]},c=r;return r||(c=[{mediaType:s}]),a&&(o.Range=e._buildRangeHeaderFieldValue(a)),o.Accept=e._buildMultipartAcceptHeaderFieldValue(c,d),this._httpGet(t,o,"arraybuffer",i).then(h)}},{key:"_httpPost",value:function(e,t,r,a){return this._httpRequest(e,"post",t,{data:r,progressCallback:a})}},{key:"_httpPostApplicationJson",value:function(e,t,r){var a={"Content-Type":b.DICOM_JSON};return this._httpPost(e,a,t,r)}},{key:"searchForStudies",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("search for studies");var r="".concat(this.qidoURL,"/studies");return"queryParams"in t&&(r+=e._parseQueryParameters(t.queryParams)),this._httpGetApplicationJson(r)}},{key:"retrieveStudyMetadata",value:function(e){if(!("studyInstanceUID"in e))throw new Error("Study Instance UID is required for retrieval of study metadata");console.log("retrieve metadata of study ".concat(e.studyInstanceUID));var t="".concat(this.wadoURL,"/studies/").concat(e.studyInstanceUID,"/metadata");return this._httpGetApplicationJson(t)}},{key:"searchForSeries",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.qidoURL;return"studyInstanceUID"in t&&(console.log("search series of study ".concat(t.studyInstanceUID)),r+="/studies/".concat(t.studyInstanceUID)),r+="/series","queryParams"in t&&(r+=e._parseQueryParameters(t.queryParams)),this._httpGetApplicationJson(r)}},{key:"retrieveSeriesMetadata",value:function(e){if(!("studyInstanceUID"in e))throw new Error("Study Instance UID is required for retrieval of series metadata");if(!("seriesInstanceUID"in e))throw new Error("Series Instance UID is required for retrieval of series metadata");console.log("retrieve metadata of series ".concat(e.seriesInstanceUID));var t="".concat(this.wadoURL,"/studies/").concat(e.studyInstanceUID,"/series/").concat(e.seriesInstanceUID,"/metadata");return this._httpGetApplicationJson(t)}},{key:"searchForInstances",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.qidoURL;return"studyInstanceUID"in t?(r+="/studies/".concat(t.studyInstanceUID),"seriesInstanceUID"in t?(console.log("search for instances of series ".concat(t.seriesInstanceUID)),r+="/series/".concat(t.seriesInstanceUID)):console.log("search for instances of study ".concat(t.studyInstanceUID))):console.log("search for instances"),r+="/instances","queryParams"in t&&(r+=e._parseQueryParameters(t.queryParams)),this._httpGetApplicationJson(r)}},{key:"buildInstanceWadoURIUrl",value:function(e){if(!("studyInstanceUID"in e))throw new Error("Study Instance UID is required.");if(!("seriesInstanceUID"in e))throw new Error("Series Instance UID is required.");if(!("sopInstanceUID"in e))throw new Error("SOP Instance UID is required.");var t=e.contentType||b.DICOM,r=e.transferSyntax||"*",a=[];a.push("requestType=WADO"),a.push("studyUID=".concat(e.studyInstanceUID)),a.push("seriesUID=".concat(e.seriesInstanceUID)),a.push("objectUID=".concat(e.sopInstanceUID)),a.push("contentType=".concat(t)),a.push("transferSyntax=".concat(r));var n=a.join("&");return"".concat(this.wadoURL,"?").concat(n)}},{key:"retrieveInstanceMetadata",value:function(e){if(!("studyInstanceUID"in e))throw new Error("Study Instance UID is required for retrieval of instance metadata");if(!("seriesInstanceUID"in e))throw new Error("Series Instance UID is required for retrieval of instance metadata");if(!("sopInstanceUID"in e))throw new Error("SOP Instance UID is required for retrieval of instance metadata");console.log("retrieve metadata of instance ".concat(e.sopInstanceUID));var t="".concat(this.wadoURL,"/studies/").concat(e.studyInstanceUID,"/series/").concat(e.seriesInstanceUID,"/instances/").concat(e.sopInstanceUID,"/metadata");return this._httpGetApplicationJson(t)}},{key:"retrieveInstanceFrames",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required for retrieval of instance frames");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required for retrieval of instance frames");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required for retrieval of instance frames");if(!("frameNumbers"in t))throw new Error("frame numbers are required for retrieval of instance frames");console.log("retrieve frames ".concat(t.frameNumbers.toString()," of instance ").concat(t.sopInstanceUID));var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID,"/frames/").concat(t.frameNumbers.toString()),a=t.mediaTypes;if(!a)return this._httpGetMultipartApplicationOctetStream(r);var n=e._getCommonMediaType(a);if(n===b.OCTET_STREAM)return this._httpGetMultipartApplicationOctetStream(r,a);if(n.startsWith("image"))return this._httpGetMultipartImage(r,a);if(n.startsWith("video"))return this._httpGetMultipartVideo(r,a);throw new Error("Media type ".concat(n," is not supported for retrieval of frames."))}},{key:"retrieveInstanceRendered",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required for retrieval of rendered instance");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required for retrieval of rendered instance");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required for retrieval of rendered instance");var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID,"/rendered"),a=t.mediaTypes,n=t.params,i={};if(!a){var o="arraybuffer";return this._httpGet(r,i,o)}var s=e._getCommonMediaType(a);if(s.startsWith("image"))return this._httpGetImage(r,a,n);if(s.startsWith("video"))return this._httpGetVideo(r,a,n);if(s.startsWith("text"))return this._httpGetText(r,a,n);if(s===b.PDF)return this._httpGetApplicationPdf(r,n);throw new Error("Media type ".concat(s," is not supported for retrieval of rendered instance."))}},{key:"retrieveInstanceFramesRendered",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required for retrieval of rendered instance frames");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required for retrieval of rendered instance frames");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required for retrieval of rendered instance frames");if(!("frameNumbers"in t))throw new Error("frame numbers are required for retrieval of rendered instance frames");console.debug("retrieve rendered frames ".concat(t.frameNumbers.toString()," of instance ").concat(t.sopInstanceUID));var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID,"/frames/").concat(t.frameNumbers.toString(),"/rendered"),a=t.mediaTypes,n={};if(!a){var i="arraybuffer";return this._httpGet(r,n,i)}var o=e._getCommonMediaType(a);if(o.startsWith("image"))return this._httpGetImage(r,a);if(o.startsWith("video"))return this._httpGetVideo(r,a);throw new Error("Media type ".concat(o," is not supported for retrieval of rendered frame."))}},{key:"retrieveInstance",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required");if(!("sopInstanceUID"in t))throw new Error("SOP Instance UID is required");var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID,"/instances/").concat(t.sopInstanceUID),a=t.mediaTypes;if(!a)return this._httpGetMultipartApplicationDicom(r).then(y);var n=e._getCommonMediaType(a);if(n===b.DICOM)return this._httpGetMultipartApplicationDicom(r,a).then(y);if(n===b.OCTET_STREAM)return this._httpGetMultipartApplicationOctetStream(r,a).then(y);if(n.startsWith("image"))return this._httpGetMultipartImage(r,a).then(v);if(n.startsWith("video"))return this._httpGetMultipartVideo(r,a).then(v);throw new Error("Media type ".concat(n," is not supported for retrieval of instance."))}},{key:"retrieveSeries",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required");if(!("seriesInstanceUID"in t))throw new Error("Series Instance UID is required");var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID,"/series/").concat(t.seriesInstanceUID),a=t.mediaTypes;if(!a)return this._httpGetMultipartApplicationDicom(r);var n=e._getCommonMediaType(a);if(n===b.DICOM)return this._httpGetMultipartApplicationDicom(r,a);if(n===b.OCTET_STREAM)return this._httpGetMultipartApplicationOctetStream(r,a);if(n.startsWith("image"))return this._httpGetMultipartImage(r,a);if(n.startsWith("video"))return this._httpGetMultipartVideo(r,a);throw new Error("Media type ".concat(n," is not supported for retrieval of series."))}},{key:"retrieveStudy",value:function(t){if(!("studyInstanceUID"in t))throw new Error("Study Instance UID is required");var r="".concat(this.wadoURL,"/studies/").concat(t.studyInstanceUID),a=t.mediaTypes;if(!a)return this._httpGetMultipartApplicationDicom(r);var n=e._getCommonMediaType(a);if(n===b.DICOM)return this._httpGetMultipartApplicationDicom(r,a);if(n===b.OCTET_STREAM)return this._httpGetMultipartApplicationOctetStream(r,a);if(n.startsWith("image"))return this._httpGetMultipartImage(r,a);if(n.startsWith("video"))return this._httpGetMultipartVideo(r,a);throw new Error("Media type ".concat(n," is not supported for retrieval of study."))}},{key:"retrieveBulkData",value:function(t){if(!("BulkDataURI"in t))throw new Error("BulkDataURI is required.");var r=t.BulkDataURI,a=t.mediaTypes,n=t.byteRange;if(!a)return this._httpGetMultipartApplicationOctetStream(r,a,n);var i=e._getCommonMediaType(a);if(i===b.OCTET_STREAM)return this._httpGetMultipartApplicationOctetStream(r,a,n);if(i.startsWith("image"))return this._httpGetMultipartImage(r,a,n);throw new Error("Media type ".concat(i," is not supported for retrieval of bulk data."))}},{key:"storeInstances",value:function(e){if(!("datasets"in e))throw new Error("datasets are required for storing");var t="".concat(this.stowURL,"/studies");"studyInstanceUID"in e&&(t+="/".concat(e.studyInstanceUID));var r=p(e.datasets),a=r.data,n=r.boundary,i={"Content-Type":"multipart/related; type=application/dicom; boundary=".concat(n)};return this._httpPost(t,i,a,e.progressCallback)}}],[{key:"_parseQueryParameters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="?";return Object.keys(e).forEach((function(r,a){0!==a&&(t+="&"),t+="".concat(r,"=").concat(encodeURIComponent(e[r]))})),t}},{key:"_assertMediaTypeIsValid",value:function(e){if(!e)throw new Error("Not a valid media type: ".concat(e));var t=e.indexOf("/");if(-1===t)throw new Error("Not a valid media type: ".concat(e));var r=e.slice(0,t),a=["application","image","text","video"];if(!a.includes(r))throw new Error("Not a valid media type: ".concat(e));if(e.slice(t+1).includes("/"))throw new Error("Not a valid media type: ".concat(e))}},{key:"_parseMediaType",value:function(t){return e._assertMediaTypeIsValid(t),t.split("/")}},{key:"_buildAcceptHeaderFieldValue",value:function(t,r){if(!Array.isArray(t))throw new Error("Acceptable media types must be provided as an Array");var a=t.map((function(t){var a=t.mediaType;if(e._assertMediaTypeIsValid(a),!r.includes(a))throw new Error("Media type ".concat(a," is not supported for requested resource"));return a}));return a.join(", ")}},{key:"_buildMultipartAcceptHeaderFieldValue",value:function(t,r){if(!Array.isArray(t))throw new Error("Acceptable media types must be provided as an Array");if(!Array.isArray(r)&&!m(r))throw new Error("Supported media types must be provided as an Array or an Object");var a=[];return t.forEach((function(t){var n=t.transferSyntaxUID,i=t.mediaType;e._assertMediaTypeIsValid(i);var o='multipart/related; type="'.concat(i,'"');if(m(r)){if(!Object.values(r).flat(1).includes(i)&&(!i.endsWith("/*")||!i.endsWith("/")))throw new Error("Media type ".concat(i," is not supported for requested resource"));if(n){if("*"!==n){if(!Object.keys(r).includes(n))throw new Error("Transfer syntax ".concat(n," is not supported for requested resource"));var s=r[n];if(!s.includes(i)){var d=e._parseMediaType(i)[0];s.map((function(t){var r=e._parseMediaType(t)[0],a=d===r;if(!a||!i.endsWith("/*")&&!i.endsWith("/"))throw new Error("Transfer syntax ".concat(n," is not supported for requested resource"))}))}}o+="; transfer-syntax=".concat(n)}}else if(Array.isArray(r)&&!r.includes(i))throw new Error("Media type ".concat(i," is not supported for requested resource"));a.push(o)})),a.join(", ")}},{key:"_buildRangeHeaderFieldValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 1===e.length?"bytes=".concat(e[0],"-"):2===e.length?"bytes=".concat(e[0],"-").concat(e[1]):"bytes=0-"}},{key:"_getCommonMediaType",value:function(t){if(!t||!t.length)throw new Error("No acceptable media types provided");var r=new Set;if(t.forEach((function(t){var a=t.mediaType;if(a.startsWith("application"))r.add(a);else{var n=e._parseMediaType(a)[0];r.add("".concat(n,"/"))}})),0===r.size)throw new Error("No common acceptable media type could be identified.");if(r.size>1)throw new Error("Acceptable media types must have the same type.");return Array.from(r)[0]}}]),e}();var I={DICOMwebClient:w}}}]);