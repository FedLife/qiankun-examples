(window["webpackJsonp_dubhe_web"]=window["webpackJsonp_dubhe_web"]||[]).push([["modelOptimize-components-quickUploadPopover"],{"1ebe":function(e,t,o){"use strict";o.r(t);var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-popover",{attrs:{title:"您可以在这里上传所需文件",trigger:"click",offset:e.popoverOffset,width:e.popoverWidth},on:{hide:e.onHide},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[o("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:e.formLabel,prop:"name"}},[o("el-input",{staticStyle:{width:"250px"},attrs:{type:"text"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),o("el-form-item",{ref:"filesPath",attrs:{label:"文件路径",prop:"path"}},[e.visible?o("upload-inline",{ref:"upload",attrs:{action:"fakeApi",accept:e.fileType,"list-type":"text",acceptSize:e.fileSize,acceptSizeFormat:e.uploadSizeFomatter,params:e.uploadParams,"show-file-count":!1,"auto-upload":!0,filters:e.uploadFilters,limit:1,"on-remove":e.onFileRemove},on:{uploadStart:e.uploadStart,uploadSuccess:e.uploadSuccess,uploadError:e.uploadError}}):e._e(),e._v(" "),e.uploading?o("upload-progress",{attrs:{progress:e.progress,color:e.customColors,status:e.status,size:e.size},on:{onSetProgress:e.onSetProgress}}):e._e()],1)],1),e._v(" "),o("div",{staticStyle:{margin:"0","text-align":"right"}},[o("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.onCancel}},[e._v("取消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",loading:e.submitting},on:{click:e.onFilesUpload}},[e._v("上传")])],1),e._v(" "),o("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v("上传")])],1)},a=[],r=o("ed08"),s=o("6e3b"),l=o("7f969"),n={name:"QuickUploadPopover",components:{UploadInline:l["a"],UploadProgress:s["a"]},props:{formLabel:{type:String,default:"模型上传"},uploadApi:{type:Function,required:!0},fileType:{type:String,default:".zip"},fileSize:{type:Number,default:0},popoverOffset:{type:Number,default:5},popoverWidth:{type:[String,Number],default:500}},data:function(){return{form:{name:null,path:null},rules:{name:[{required:!0,message:"请输入名称",trigger:"change"},{max:32,message:"长度在 32 个字符以内",trigger:"blur"},{validator:r["ac"],trigger:["blur","change"]}],path:[{required:!0,message:"请输入文件路径",trigger:["blur","manual"]}]},uploadParams:{objectPath:null},progress:0,size:0,customColors:[{color:"#909399",percentage:40},{color:"#e6a23c",percentage:80},{color:"#67c23a",percentage:100}],uploadFilters:[r["ib"]],uploading:!1,submitting:!1,visible:!1}},computed:{user:function(){return this.$store.getters.user},status:function(){return 100===this.progress?"success":null}},mounted:function(){this.updatePath()},methods:{onFileRemove:function(){this.form.path=null,this.uploading=!1,this.$refs.filesPath.validate("manual")},uploadStart:function(e){this.updatePath();var t=[!0,e.size,0];this.uploading=t[0],this.size=t[1],this.progress=t[2]},onSetProgress:function(e){this.progress+=e},uploadSuccess:function(e){var t=this;this.progress=100,setTimeout((function(){t.uploading=!1}),1e3),this.form.path=e[0].data.objectName,this.$refs.filesPath.validate("manual")},uploadError:function(){this.$message({message:"上传文件失败",type:"error"}),this.uploading=!1},updatePath:function(){this.uploadParams.objectPath="upload-temp/".concat(this.user.id,"/").concat(Object(r["ab"])())},onFilesUpload:function(){var e=this;this.submitting||this.$refs.form.validate((function(t){t&&(e.submitting=!0,e.uploadApi(e.form).then((function(t){e.$emit("success",t),e.visible=!1})).finally((function(){e.submitting=!1})))}))},onCancel:function(){this.visible=!1},onHide:function(){this.reset()},reset:function(){var e=this;this.form.name=this.form.path=null,setTimeout((function(){e.$refs.form.clearValidate()}),0),this.uploading=this.submitting=!1},uploadSizeFomatter:r["Ub"]}},u=n,p=o("2877"),c=Object(p["a"])(u,i,a,!1,null,null,null);t["default"]=c.exports}}]);