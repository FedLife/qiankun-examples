(window["webpackJsonp_dubhe_web"]=window["webpackJsonp_dubhe_web"]||[]).push([["dataset-annotate-workSpaceContainer-segmentation-selection","dataset-annotate-workSpaceContainer-segmentation-polygon","dataset-annotate-workSpaceContainer-segmentation-polyline","dataset-annotate-workSpaceContainer-segmentation-vertice"],{"7e60":function(t,e,n){"use strict";n.r(e),n.d(e,"MIN_POINT_DISTANCE",(function(){return x}));var r=n("2638"),a=n.n(r),i=n("2b0e"),o=n("5698"),s=n("ed09"),u=n("df78"),l=n("ed08"),d=n("b3f5"),c=n("d2a9");function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function h(t,e,n){return e=y(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y(t){var e=v(t,"string");return"symbol"===f(e)?e:String(e)}function v(t,e){if("object"!==f(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function b(t,e){return j(t)||S(t,e)||O(t,e)||m()}function m(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function O(t,e){if(t){if("string"===typeof t)return D(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(t,e):void 0}}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function S(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,s=[],u=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);u=!0);}catch(d){l=!0,a=d}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}function j(t){if(Array.isArray(t))return t}var x=20;e["default"]={name:"PolygonRender",components:{PolylineRender:d["default"],Vertice:c["default"]},props:{guides:Array,stageWidth:Number,stageHeight:Number,currentAnnotationId:String,handleChange:Function,draw:Object,transformer:Object,scale:Number,offset:Function,getZoom:Function,bounds:Object,shape:Object,onDragStart:Function,onDragMove:Function,onDragEnd:Function,setTransformer:Function},setup:function(t){var e=t.onDragStart,n=t.onDragMove,r=t.onDragEnd,a=t.getZoom,o=t.setTransformer,u=Object(s["n"])({drag:void 0}),d=function(t,e){var n=t(u);i["default"].nextTick((function(){Object.assign(u,n),"function"===typeof e&&e(u)}))},c=function(t){var e=t.map((function(e,n){return[e,t[(n+1)%t.length],n]})).filter((function(t){var e=b(t,2),n=e[0],r=e[1];return Object(l["v"])(n,r)>2*x}));return e},f=function(n){var r={x:n.x+n.dx,y:n.y+n.dy},a=p({},r),i={start:r,end:a};"function"===typeof e&&e(i,t.shape)},g=function(e){var r=a(),i=r.zoom;d((function(n){var r=i*t.scale,a=Object(l["W"])(t.shape.data.points),o=a.x0,s=a.x1,u=a.y0,d=a.y1,c=e.dx>0?Math.min(e.dx/r,t.bounds.width-s):Math.max(e.dx/r,-o),f=e.dy>0?Math.min(e.dy/r,t.bounds.height-d):Math.max(e.dy/r,-u);return p(p({},n),{},{drag:p(p({},e),{},{validDx:c,validDy:f})})}),(function(e){"function"===typeof n&&n(e,t.shape)}))},h=function(e,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=a.prevState;o({isDragging:!1,id:t.shape.id,x:e.x,y:e.y,dx:0,dy:0}),i.isMoving&&d((function(t){return p(p({},t),{},{drag:p(p({},t.drag),e)})}),(function(e){"function"===typeof r&&r(e,t.shape)}))};return{state:u,updateState:d,renderMidPoints:c,selectionDragStart:f,selectionDragMove:g,selectionDragEnd:h}},render:function(){var t,e=this,n=arguments[0],r=this.shape,i=void 0===r?{}:r,s=this.transformer,f=void 0===s?{}:s,g=this.renderMidPoints,p=this.handleChange,h=this.draw,y=this.stageWidth,v=this.stageHeight,m=this.offset,O=null;i.id===f.id&&(O={translate:"translate(".concat(f.dx,", ").concat(f.dy,")"),isDragging:f.isDragging});var D={pointerEvents:h.isDrawing||null!==(t=O)&&void 0!==t&&t.isDragging?"none":"all"},S={props:{resetOnStart:!0,width:y,height:v,onDragStart:this.selectionDragStart,onDragMove:this.selectionDragMove,onDragEnd:this.selectionDragEnd}},j=i.id===this.currentAnnotationId;return n(u["a"],a()([{},S,{key:i.id}]),[function(t){var r;return n("g",[t.state.isDragging&&n("rect",{attrs:{width:y,height:v,fill:"transparent"},on:{mouseup:t.dragEnd,mousemove:t.dragMove,mouseleave:function(e){Object(l["gb"])(e,e.target)||t.dragEnd()}},style:{cursor:"move"}}),j&&e.guides.map((function(t,e){return n(d["default"],{key:e,attrs:{points:t,offset:m,fill:i.data.color,"stroke-opacity":.7,"stroke-dasharray":"5"}})})),n("g",{attrs:{transform:null===(r=O)||void 0===r?void 0:r.translate},style:D},[n(d["default"],{key:i.id,attrs:{points:i.data.points,fill:i.data.color,"stroke-dasharray":j?"10":void 0,"fill-opacity":j?.4:.1,curve:o["k"],offset:m},on:{mousedown:t.dragStart,mousemove:t.dragMove,mouseup:t.dragEnd}}),j&&[i.data.points.map((function(t,e){var r={props:{handlePointClick:function(){return p("REMOVE_POINT",{index:e,shape:i})},fill:i.data.color}};return n(c["default"],a()([{key:e,attrs:{index:e,position:t,shape:i,offset:m,draggable:!0,stageWidth:y,stageHeight:v,handleChange:p}},r]))})),g(i.data.points).map((function(t){var e=b(t,3),r=e[0],o=e[1],s=e[2],u={props:{handlePointClick:function(){return p("ADD_POINT",{point:Object(l["ub"])(r,o),index:s+1,shape:i})}}};return n(c["default"],a()([{key:"".concat(s,"-mid"),attrs:{index:s,position:Object(l["ub"])(r,o),shape:i,offset:m,innerRadius:3,outerRadius:8,fill:"#fff",fillOpacity:.6,className:"add-point"}},u]))}))]])])}])}}},"9f0e":function(t,e,n){"use strict";n.r(e);var r=n("2638"),a=n.n(r),i=n("ed09"),o=n("4d26"),s=n.n(o),u=n("2ef0"),l=n("ed08"),d=n("df78"),c=n("d2a9"),f=n("b3f5"),g=n("7e60");e["default"]={name:"SegmentationSelection",components:{Vertice:c["default"],PolylineRender:f["default"]},props:{stageWidth:Number,stageHeight:Number,className:String,state:{type:Object,default:function(){return{}}},draw:Object,handlePointClick:Function,handleChange:Function,transformZoom:Function},setup:function(t){var e=t.handleChange,n=t.transformZoom,r=Object(i["n"])({lastPoint:null}),a=function(){Object.assign(r,{lastPoint:null})},o=function(t){var a=n({x:t.x,y:t.y});Object.assign(r,{lastPoint:a}),e("DRAW_START",{point:a})},s=function(t,a){var i=n({x:t.x+t.dx,y:t.y+t.dy});e("DRAW_MOVE",{point:i}),a.shiftKey&&r.lastPoint&&Object(l["v"])(i,r.lastPoint)>g["MIN_POINT_DISTANCE"]&&(e("DRAW_POINT",{point:i}),Object.assign(r,{lastPoint:i}))},u=function(){a()},d=function(t,e){return 0===e?"#fff":void 0};return Object(i["r"])((function(){return t.state.status}),(function(t){"FINISHED"!==t&&""!==t||a()})),{drag:r,getFill:d,handleDragStart:o,handleDragMove:s,handleDragEnd:u}},render:function(){var t=arguments[0],e=this.stageWidth,n=this.stageHeight,r=this.className,i=this.handlePointClick,o=this.draw,l=this.getFill,g=this.state,p=g.unfinishedShape,h=void 0===p?{}:p,y=g.guides,v=h.points,b=void 0===v?[]:v,m={pointerEvents:o.isDrawing?"none":"all"},O={props:{width:e,height:n,resetOnStart:!0,onDragStart:this.handleDragStart,onDragMove:this.handleDragMove,onDragEnd:this.handleDragEnd}};return t("g",{attrs:{className:s()("db-brush",r)}},[t(d["a"],a()([{},O]),[function(r){return t("rect",{attrs:{className:"selection-overlay",fill:"transparent",x:0,y:0,width:e,height:n},style:{cursor:"crosshair"},on:{mousedown:r.dragStart,mousemove:r.dragMove,mouseup:r.dragEnd}})}]),!Object(u["isEmpty"])(b)&&t("g",[t(f["default"],{attrs:{points:y,"fill-opacity":"1","stroke-dasharray":"5"},style:m}),t(f["default"],{attrs:{points:b,"fill-opacity":"0.2"},style:m}),b.map((function(e,n){return t(c["default"],{key:n,attrs:{index:n,position:e,shape:h,handlePointClick:i,fill:l(e,n)}})}))])])}}},b3f5:function(t,e,n){"use strict";n.r(e);var r=n("2638"),a=n.n(r),i=n("2ef0"),o=n("5698"),s=n("3da5");e["default"]={name:"PolylineRender",functional:!0,props:{points:Array,curve:Function,fill:String,offset:Function},render:function(t,e){var n=e.props,r=n.fill,u=n.points,l=void 0===u?[]:u,d=n.offset;if(Object(i["isNil"])(l))return null;var c=e.data.style,f=Object(o["y"])().x((function(t){return t.x})).y((function(t){return t.y}));n.curve&&f.curve(n.curve);var g=r||s["defaultColor"],p={attrs:e.data.attrs,on:e.data.on},h=Object(i["isFunction"])(d)?l.map(d):l;return t("path",a()([{class:"interactive",attrs:{d:f(h),stroke:g,fill:g,"stroke-width":2}},p,{style:c}]))}}},d2a9:function(t,e,n){"use strict";n.r(e);var r=n("2638"),a=n.n(r),i=n("4d26"),o=n.n(i),s=n("2ef0"),u=n("ed08"),l=n("df78"),d=n("3da5");e["default"]={name:"Vertice",components:{Drag:l["a"]},props:{shape:Object,index:Number,position:Object,className:String,handlePointClick:{type:Function,default:u["xb"]},handleChange:Function,draggable:{type:Boolean,default:!1},outerRadius:{type:Number,default:10},innerRadius:{type:Number,default:4},fill:{type:String,default:d["defaultColor"]},fillOpacity:{type:Number,default:1},stageHeight:Number,stageWidth:Number,offset:Function},setup:function(t){var e=t.handleChange,n=function(n,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=a.prevState;!i.isMoving||0===i.dx&&0===i.dy||e("UPDATE_POINT",{drag:n,index:t.index,shape:t.shape})},r=function(n){e("MOVE_POINT",{drag:n,index:t.index,shape:t.shape})};return{dragEnd:n,dragMove:r}},render:function(){var t=this,e=arguments[0],n=this.stageWidth,r=this.stageHeight,i=this.className,d=this.draggable,c=this.position,f=void 0===c?{}:c,g=this.outerRadius,p=this.innerRadius,h=this.fill,y=this.fillOpacity,v=this.handlePointClick,b=this.offset,m=function(e){e.stopPropagation(),e.preventDefault(),v(t.index,t.shape,e)},O={props:{onDragMove:this.dragMove,onDragEnd:this.dragEnd,resetOnStart:!0,width:n,height:r}},D=Object(s["isFunction"])(b)?b(f):f;return e("g",{class:o()("vertice-group cp",i)},[e("circle",{attrs:{r:p,cx:D.x,cy:D.y,"fill-rule":"evenodd","fill-opacity":y,fill:h}}),e(l["a"],a()([{},O]),[function(t){return e("circle",{attrs:{r:g,cx:D.x,cy:D.y,"fill-opacity":0,opacity:0},on:{click:m,mousedown:d?t.dragStart:u["xb"],mousemove:d?t.dragMove:u["xb"],mouseup:d?t.dragEnd:u["xb"]}})}])])}}}}]);