(window["webpackJsonp_dubhe_web"]=window["webpackJsonp_dubhe_web"]||[]).push([["labelGroup-dynamicField"],{bc46:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"formRef",attrs:{model:e.formData,"label-width":"100px"}},e._l(e.keys,(function(t,l){return a("el-form-item",{key:t,staticClass:"mb-10",attrs:{label:"自定义标签"+(t+1),prop:"labels."+l,rules:e.rules}},[e.addable?a("div",{staticClass:"flex"},[e.isVisual?a("div",[a("InfoSelect",{style:{width:"200px",marginRight:"10px"},attrs:{value:e.formData.labels[l].id||e.formData.labels[l].name,placeholder:"选择或新建标签",dataSource:e.labelOptions,valueKey:"id",labelKey:"name","default-first-option":"",filterable:"","allow-create":"",disabled:!e.editable(e.formData.labels[l])},on:{change:function(a){return e.handleChange(t,a)}}}),e._v(" "),a("el-input",{staticClass:"dn",attrs:{disabled:!e.editable(e.formData.labels[l])},model:{value:e.formData.labels[l].name,callback:function(t){e.$set(e.formData.labels[l],"name",t)},expression:"formData.labels[index].name"}})],1):a("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"请输入标签名称",disabled:!e.editable(e.formData.labels[l])},model:{value:e.formData.labels[l].name,callback:function(t){e.$set(e.formData.labels[l],"name",t)},expression:"formData.labels[index].name"}}),e._v(" "),a("el-color-picker",{attrs:{disabled:!e.editable(e.formData.labels[l]),size:"small"},model:{value:e.formData.labels[l].color,callback:function(t){e.$set(e.formData.labels[l],"color",t)},expression:"formData.labels[index].color"}}),e._v(" "),a("span",{staticStyle:{width:"50px","margin-left":"10px","line-height":"32px"}},[e.keys.length>1&&e.addable?a("i",{staticClass:"el-icon-remove-outline vm cp",class:e.editable(e.formData.labels[l])?"":"disabled",staticStyle:{"font-size":"20px"},on:{click:function(a){return a.preventDefault(),e.removeLabel(t)}}}):e._e(),e._v(" "),l===e.keys.length-1&&e.addable?a("i",{staticClass:"el-icon-circle-plus-outline vm cp",class:e.addable?"":"disabled",staticStyle:{"font-size":"20px"},on:{click:e.addLabel}}):e._e()])],1):a("div",{staticClass:"flex"},[a("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{disabled:!e.editable(e.formData.labels[l])},model:{value:e.formData.labels[l].name,callback:function(t){e.$set(e.formData.labels[l],"name",t)},expression:"formData.labels[index].name"}}),e._v(" "),a("el-color-picker",{attrs:{disabled:"",size:"small"},model:{value:e.formData.labels[l].color,callback:function(t){e.$set(e.formData.labels[l],"color",t)},expression:"formData.labels[index].color"}})],1)])})),1)},r=[],n=a("2b0e"),i=a("ed09"),o=a("2ef0"),c=a("ba8f"),u=a("3da5"),s=a("ed08"),b=a("61f7");function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){m(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function m(e,t,a){return t=v(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function v(e){var t=y(e,"string");return"symbol"===f(t)?t:String(t)}function y(e,t){if("object"!==f(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var l=a.call(e,t||"default");if("object"!==f(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var g="#FFFFFF",O={name:"DynamicField",components:{InfoSelect:c["a"]},props:{data:{type:Object,default:function(){return{}}},labelGroupType:{type:Number,default:void 0},originList:{type:Array,deafault:function(){return[]}},activeLabels:{type:Array,deafault:function(){return[]}},actionType:String},setup:function(e){var t=Object(i["o"])(null),a=Object(i["o"])({labels:[{name:"",color:g},{name:"",color:"#000000"}]}),l=Object(i["a"])((function(){return a.value.labels.map((function(e,t){return t}))})),r=Object(i["a"])((function(){return e.labelGroupType===u["labelGroupTypeMap"].VISUAL.value})),c=function(e,t,l){var r=Object(s["H"])(a.value.labels,(function(e){return!!t.id&&e.id===t.id}));r?l(new Error("标签不能重复")):l()},f=[{validator:b["n"],trigger:["change","blur"]},{validator:c,trigger:["change","blur"]}],d=Object(i["o"])([]),m=function(e){return l.value.findIndex((function(t){return t===e}))},v=["create","edit"].includes(e.actionType),y=function(t){return e.originList.findIndex((function(e){return e.id===t.id}))>-1},O=function(t){return!!v&&("create"===e.actionType||!y(t))},h=function(e,t){var l=m(e);n["default"].set(a.value.labels,l,p({},t))},D=function(e,t){var l=m(e);a.value.labels[l].name=t},x=function(a,l){var r=t.value.fields.filter((function(e){return"error"===e.validateState})).map((function(e){return e.prop}));t.value.validateField(r);var n=e.activeLabels.find((function(e){return e.id===l}));n?h(a,Object(o["pick"])(n,["name","id","color"])):D(a,l)},j=function(){a.value.labels.push({name:"",color:g})},w=function(e){if(1!==l.value.length){var t=m(e);a.value.labels=Object(s["Ib"])(a.value.labels,t)}};return Object(i["r"])((function(){return e.activeLabels}),(function(t){d.value=t.map((function(t){return p(p({},t),{},{disabled:e.originList.findIndex((function(e){return e.id===t.id}))>-1})}))})),Object(i["r"])((function(){return Object(o["cloneDeep"])(e.data)}),(function(e){a.value=e})),{formRef:t,formData:a,keys:l,isVisual:r,rules:f,editable:O,addable:v,labelOptions:d,handleChange:x,removeLabel:w,addLabel:j}}},h=O,D=a("2877"),x=Object(D["a"])(h,l,r,!1,null,null,null);t["default"]=x.exports}}]);