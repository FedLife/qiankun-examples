(window["webpackJsonp_dubhe_web"]=window["webpackJsonp_dubhe_web"]||[]).push([["dataset-tableImport","dataset-tableImport-previewer","dataset-tableImport-result","dataset-tableImport-uploader","dataset-util-tableReader"],{18:function(t,e){},19:function(t,e){},20:function(t,e){},4066:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticStyle:{width:"600px"}},[r("el-form-item",{attrs:{label:"文件类型",prop:"fileType"}},[r("div",{staticClass:"image-select flex flex-wrap"},t._l(t.fileTypeList,(function(e){return r("div",{key:e.name,class:t.getImageKlass(e.name),on:{click:function(r){return t.selectFileType(e.name)}}},[r("div",{staticClass:"image-title"},[t._v(t._s(e.name))]),t._v(" "),r("IconFont",{staticClass:"fileIcon",attrs:{type:e.icon}}),t._v(" "),r("span",[r("i",{staticClass:"check-icon"})])],1)})),0),t._v(" "),r("el-input",{staticClass:"dn",attrs:{value:t.state.form.fileType}}),t._v(" "),r("div",{staticClass:"el-form-item__tip"},[r("el-link",{attrs:{target:"_blank",href:(t.__IN_CLOUD__?"/annotation-web":"")+"/template-10dbac08a9f37fd8b9641944af77b74f.zip"}},[t._v("没有数据？查看并下载预置模板")])],1)],1),t._v(" "),r("el-form-item",{attrs:{label:"上传文件",prop:"file"}},[r("upload-inline",t._b({key:t.state.form.fileType,ref:"fileUploadForm",attrs:{action:"fakeApi","on-remove":t.fileRemove},on:{fileChange:t.fileChange}},"upload-inline",t.uploadOptions,!1))],1),t._v(" "),r("div",{staticStyle:{margin:"25px 0 0 100px"}},[r("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.preview}},[t._v("\n      下一步\n    ")])],1)],1)},o=[],a=r("2b0e"),i=r("ed09"),c=r("4d26"),u=r.n(c),l=r("7f969"),s=r("3da5");function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function p(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function h(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?p(Object(r),!0).forEach((function(e){d(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function d(t,e,r){return e=v(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v(t){var e=y(t,"string");return"symbol"===f(e)?e:String(e)}function y(t,e){if("object"!==f(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var m={name:"UploaderTable",components:{UploadInline:l["a"]},props:{fileTypeList:Array,state:Object,setState:Function,setForm:Function,tableForm:Object,validateField:Function,loading:Boolean},setup:function(t,e){var r=t.setForm,n=t.validateField,o=Object(i["o"])(null),c=function(e){return u()("image-select-item item-".concat(e),{"is-active":e===t.state.form.fileType})},l=function(e){e!==t.state.form.fileType&&r({fileType:e,file:null})},f=function(){t.tableForm.validate((function(r){r&&e.emit("preview",t.state.form.file.raw,t.state.form.fileType)}))},p=function(t){r({file:t}),a["default"].nextTick((function(){n("file")}))},d=function(){r({file:null})},v=Object(i["a"])((function(){var e="csv"===t.state.form.fileType?".csv":".xlsx";return h(h({},s["tableUploadProps"]),{},{accept:e,hash:!0})}));return{uploadOptions:v,getImageKlass:c,selectFileType:l,preview:f,fileChange:p,fileRemove:d,fileUploadForm:o}}},g=m,b=r("2877"),w=Object(b["a"])(g,n,o,!1,null,null,null);e["default"]=w.exports},4781:function(t,e,r){"use strict";r("99df")},"4ca8":function(t,e,r){"use strict";r.r(e),r.d(e,"csvReader",(function(){return c})),r.d(e,"xlsReader",(function(){return l}));var n=r("369b"),o=r.n(n),a=r("1146"),i=r("ed08"),c=function(t){return Object(i["Db"])(t,"utf-8").then((function(t){var e=o.a.parse(t),r=e.data,n=r[0],a=r.slice(1);return{data:a,columns:n}}))};function u(t){for(var e=[],r=a["utils"].decode_range(t["!ref"]),n=r.s.r,o=r.s.c;o<=r.e.c;o+=1){var i=t[a["utils"].encode_cell({c:o,r:n})];if(i&&i.t){var c=a["utils"].format_cell(i);e.push(c)}}return e}var l=function(t){var e=new FileReader;return new Promise((function(r,n){e.onload=function(t){var e=t.target.result,n=Object(a["read"])(e,{type:"binary"}),o=n.SheetNames[0],i=n.Sheets[o],c=a["utils"].sheet_to_json(i,{header:1}),l=u(i);r({data:c.slice(1),columns:l})},e.onerror=function(t){n(new Error(t))},e.readAsBinaryString(t)}))}},5208:function(t,e,r){t.exports={menuBg:"#f3f7ff",menuText:"#666",menuActiveText:"#1890ff"}},"71a3":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"tc"},[r("i",{class:t.klass,staticStyle:{"font-size":"72px"}}),t._v(" "),r("h3",[t._v(t._s(t.state.loading?"表格导入成功，执行转换中":"文件转换完成"))]),t._v(" "),r("div",{staticStyle:{"margin-top":"40px"}},[r("el-button",{attrs:{type:"primary"},on:{click:t.backToList}},[t._v("返回列表")]),t._v(" "),r("el-button",{attrs:{type:"default",loading:t.state.loading},on:{click:t.directTo}},[t._v(t._s(t.state.loading?"文件处理中":"查看详情"))])],1),t._v(" "),t._m(0)])},o=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-result-content"},[r("i",{staticClass:"mr-10 primary el-icon-timer"}),t._v(" "),r("span",[t._v("文件上传完毕后，需要对文件进行解析、转换，请耐心等待")])])}],a=r("ed09"),i=r("4d26"),c=r.n(i),u=r("141b"),l=r("3da5");function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function f(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */f=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(T){u=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var a=e&&e.prototype instanceof d?e:d,i=Object.create(a.prototype),c=new E(o||[]);return n(i,"_invoke",{value:j(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(T){return{type:"throw",arg:T}}}t.wrap=l;var h={};function d(){}function v(){}function y(){}var m={};u(m,a,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(S([])));b&&b!==e&&r.call(b,a)&&(m=b);var w=y.prototype=d.prototype=Object.create(m);function O(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function o(n,a,i,c){var u=p(t[n],t,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==s(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,i,c)}),(function(t){o("throw",t,i,c)})):e.resolve(f).then((function(t){l.value=t,i(l)}),(function(t){return o("throw",t,i,c)}))}c(u.arg)}var a;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return a=a?a.then(n,n):n()}})}function j(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return P()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var c=_(i,r);if(c){if(c===h)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=p(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function _(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var o=p(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,h;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function S(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return v.prototype=y,n(w,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:v,configurable:!0}),v.displayName=u(y,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},O(x.prototype),u(x.prototype,i,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new x(l(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},O(w),u(w,c,"Generator"),u(w,a,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=S,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),k(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;k(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:S(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function p(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(l){return void r(l)}c.done?e(u):Promise.resolve(u).then(n,o)}function h(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){p(a,n,o,i,c,"next",t)}function c(t){p(a,n,o,i,c,"throw",t)}i(void 0)}))}}var d={name:"ImportTableResult",props:{directTo:Function,datasetId:[String,Number]},setup:function(t,e){var r=t.datasetId,n=e.root.$router,o=Object(a["n"])({datasetInfo:{},loading:!1}),i=function(){n.push({path:"/data/datasets"})},s=function(){var t=h(f().mark((function t(){var e;return f().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["g"])(r);case 2:e=t.sent,Object.assign(o,{datasetInfo:e});case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),p=Object(a["a"])((function(){return c()("success",{"el-icon-time":!0===o.loading,"el-icon-el-icon-circle-check":!1===o.loading})}));return Object(a["k"])((function(){Object.assign(o,{loading:!0}),s()})),Object(a["r"])((function(){return o.datasetInfo}),(function(t){Object(l["isStatus"])(t,"IMPORTING")?setTimeout(s,3e3):(Object.assign(o,{loading:!1}),e.emit("finish",t))})),{backToList:i,klass:p,state:o}}},v=d,y=r("2877"),m=Object(y["a"])(v,n,o,!1,null,null,null);e["default"]=m.exports},"99df":function(t,e,r){},c623:function(t,e,r){"use strict";r.d(e,"e",(function(){return v})),r.d(e,"b",(function(){return y})),r.d(e,"f",(function(){return m})),r.d(e,"g",(function(){return g})),r.d(e,"h",(function(){return b})),r.d(e,"c",(function(){return w})),r.d(e,"d",(function(){return O}));var n=r("b775"),o=r("f121"),a=r("88be");function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function c(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */c=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(T){s=function(t,e,r){return t[e]=r}}function f(t,e,r,o){var a=e&&e.prototype instanceof d?e:d,i=Object.create(a.prototype),c=new E(o||[]);return n(i,"_invoke",{value:j(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(T){return{type:"throw",arg:T}}}t.wrap=f;var h={};function d(){}function v(){}function y(){}var m={};s(m,a,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(S([])));b&&b!==e&&r.call(b,a)&&(m=b);var w=y.prototype=d.prototype=Object.create(m);function O(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function o(n,a,c,u){var l=p(t[n],t,a);if("throw"!==l.type){var s=l.arg,f=s.value;return f&&"object"==i(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,c,u)}),(function(t){o("throw",t,c,u)})):e.resolve(f).then((function(t){s.value=t,c(s)}),(function(t){return o("throw",t,c,u)}))}u(l.arg)}var a;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return a=a?a.then(n,n):n()}})}function j(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return P()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var c=_(i,r);if(c){if(c===h)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=p(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function _(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var o=p(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,h;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function S(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return v.prototype=y,n(w,"constructor",{value:y,configurable:!0}),n(y,"constructor",{value:v,configurable:!0}),v.displayName=s(y,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,s(t,l,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},O(x.prototype),s(x.prototype,u,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new x(f(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},O(w),s(w,l,"Generator"),s(w,a,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=S,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),k(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;k(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:S(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e,r){return e=f(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(t){var e=p(t,"string");return"symbol"===i(e)?e:String(e)}function p(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function h(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(l){return void r(l)}c.done?e(u):Promise.resolve(u).then(n,o)}function d(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){h(a,n,o,i,c,"next",t)}function c(t){h(a,n,o,i,c,"throw",t)}i(void 0)}))}}function v(t){var e=t.datasetId;return delete t.datasetId,Object(n["a"])({url:"/".concat(o["a"].DATA,"/datasets/").concat(e,"/files"),method:"get",params:t}).then(function(){var t=d(c().mark((function t(e){return c().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=l,t.t1=l({},e),t.t2={},t.next=5,Promise.all(e.result.map(function(){var t=d(c().mark((function t(e){return c().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=l,t.t1=l({},e),t.t2={},t.next=5,window.minioClient.presignedGetObject(e.url.replace(a["b"].bucketName+"/",""));case 5:return t.t3=t.sent,t.t4={url:t.t3},t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t4));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 5:return t.t3=t.sent,t.t4={result:t.t3},t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t4));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}function y(t){var e=t.datasetIds;return delete t.datasetIds,t.datasetIds=[e],Object(n["a"])({url:"/".concat(o["a"].DATA,"/datasets/files"),method:"delete",data:t})}function m(t,e){return Object(n["a"])({url:"/".concat(o["a"].DATA,"/datasets/").concat(t,"/files"),method:"post",data:{files:e}})}function g(t,e){return Object(n["a"])({url:"/".concat(o["a"].DATA,"/datasets/").concat(t,"/video"),method:"post",data:e})}function b(t){return Object(n["a"])({url:"/".concat(o["a"].DATA,"/datasets/tableImport"),method:"post",data:t})}function w(t){var e=t.datasetId;return Object(n["a"])({url:"/".concat(o["a"].DATA,"/datasets/").concat(e,"/files/audio"),method:"get",params:t}).then(function(){var t=d(c().mark((function t(e){return c().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=l,t.t1=l({},e),t.t2={},t.next=5,Promise.all(e.result.map(function(){var t=d(c().mark((function t(e){return c().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=l,t.t1=l({},e),t.t2={},t.next=5,window.minioClient.presignedGetObject(e.url.replace(a["b"].bucketName+"/",""));case 5:return t.t3=t.sent,t.t4={url:t.t3},t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t4));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 5:return t.t3=t.sent,t.t4={result:t.t3},t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t4));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}function O(t){var e=t.datasetId;return Object(n["a"])({url:"/".concat(o["a"].DATA,"/datasets/").concat(e,"/files/filePage"),method:"post",data:l({},t)})}e["a"]={list:v,del:y}},d302:function(t,e,r){"use strict";r("5208")},d309:function(t,e,r){"use strict";r("fc51")},e148:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"previewer"},[r("div",{staticClass:"extraRow flex flex-between mb-10"},[r("el-checkbox",{model:{value:t.form.excludeHeader,callback:function(e){t.$set(t.form,"excludeHeader",e)},expression:"form.excludeHeader"}},[t._v("不展示表头")]),t._v(" "),t.showFilter?r("SearchBox",{ref:"searchBox",attrs:{formItems:t.filterItems,initialValue:t.state.initialValue,handleFilter:t.handleFilter,"label-width":"0px",klass:"dataset-columnFilter",popperAttrs:t.popperAttrs},on:{change:t.handleChange}},[r("el-button",{staticClass:"mr-40 fr",attrs:{slot:"trigger",type:"text"},slot:"trigger"},[t._v("\n        选择列"),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})])],1):t._e()],1),t._v(" "),t.showFilter?t._e():r("div",{staticClass:"checkRow"},[r("el-checkbox-group",{staticClass:"flex",on:{change:t.handleCheckChange},model:{value:t.state.checkList,callback:function(e){t.$set(t.state,"checkList",e)},expression:"state.checkList"}},t._l(t.formItems,(function(e){return r("el-checkbox",{key:e.value,staticClass:"f1",attrs:{label:e.value}},[t._v("\n        选择该列\n      ")])})),1)],1),t._v(" "),r("BaseTable",{attrs:{columns:t.columns,data:t.data,"span-method":t.span,border:"","header-row-class-name":"previewerHeaderRow","cell-class-name":t.getCellClass}}),t._v(" "),r("div",{staticClass:"tc",staticStyle:{"margin-top":"25px"}},[r("el-button",{attrs:{type:"default"},on:{click:t.prev}},[t._v("\n      上一步\n    ")]),t._v(" "),r("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.onOk}},[t._v("\n      下一步\n    ")])],1),t._v(" "),r("el-divider"),t._v(" "),t._m(0)],1)},o=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-page-form-steps-desc"},[r("h3",[t._v("说明")]),t._v(" "),r("h4",[t._v("不展示表头")]),t._v(" "),r("p",[t._v("\n      程序默认读取表格首行信息作为表头，在转存为文本过程中默认过滤表头信息，如果需要保留表头，可以取消勾选\n    ")])])}],a=r("ed09"),i=r("c0ee"),c=r("739c"),u={name:"PreviewerTable",components:{BaseTable:i["a"],SearchBox:c["a"]},inheritAttrs:!1,props:{data:Array,columns:Array,checkList:Array,prev:Function,onOk:Function,loading:Boolean,form:Object,showFilter:Boolean,setState:Function},setup:function(t,e){var r=t.setState,n=Object(a["n"])({checkList:t.checkList||[],initialValue:{columns:[]}}),o={placement:"left-end"},i=t.columns.map((function(t){return{label:t.label,value:t.prop}})),c=[{prop:"columns",type:"checkboxGroup",options:i}],u=function(t){r({checkList:t.columns})},l=function(t){var e=t.column;return n.checkList.includes(e.label)?"highlight":""},s=function(e){var r=e.rowIndex,n=e.columnIndex;if(r===Math.min(10,t.data.length-1))return 0===n?[1,t.columns.length]:[0,0]},f=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=e[0];r({checkList:o})},p=function(t){e.emit("change",t)};return Object(a["r"])((function(){return t.checkList}),(function(t){n.checkList=t})),{state:n,getCellClass:l,popperAttrs:o,formItems:i,filterItems:c,span:s,handleCheckChange:p,handleFilter:u,handleChange:f}}},l=u,s=(r("d309"),r("2877")),f=Object(s["a"])(l,n,o,!1,null,"d4f08614",null);e["default"]=f.exports},fc51:function(t,e,r){},fe74:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-container greyBg"},[r("div",{staticClass:"wrapper fixed"},[t._m(0),t._v(" "),r("div",{staticClass:"app-page-container-content"},[r("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[r("el-steps",{attrs:{active:t.state.active,"finish-status":"success","align-center":""}},[r("el-step",{attrs:{title:"上传文件"}}),t._v(" "),r("el-step",{attrs:{title:"文件预览"}}),t._v(" "),r("el-step",{attrs:{title:"文件转换"}})],1),t._v(" "),r("el-form",{ref:"tableForm",staticClass:"stepForm",attrs:{model:t.state.form,rules:t.rules,"label-width":"100px"}},[0===t.state.active?r("Uploader",{attrs:{fileTypeList:t.fileTypeList,state:t.state,setForm:t.setForm,setState:t.setState,tableForm:t.tableForm,validateField:t.validateField,loading:t.state.loading},on:{preview:t.handlePreview}}):t._e(),t._v(" "),1===t.state.active?r("div",[r("Previewer",{attrs:{data:t.tableData,columns:t.columns,checkList:t.state.checkList,form:t.state.form,showFilter:t.showFilter,setState:t.setState,prev:t.prev,loading:t.state.loading,onOk:t.uploadFile},on:{change:t.handleCheckChange}}),t._v(" "),r("UploadInline",{ref:"uploadRef",staticClass:"dn",attrs:{hash:"",action:"fakeApi",params:t.uploadParams},on:{uploadSuccess:t.uploadSuccess,uploadError:t.uploadError}})],1):t._e(),t._v(" "),2===t.state.active?r("div",[r("Result",{attrs:{directTo:t.directTo,datasetId:t.datasetId},on:{finish:t.finish}})],1):t._e()],1)],1)],1)])])},o=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-page-header"},[r("div",{staticClass:"app-page-header-title"},[t._v("导入表格")]),t._v(" "),r("div",{staticClass:"app-page-header-content"},[r("div",[t._v("支持 csv/xlsx 文件格式导入，文件大小不能超过 5M")]),t._v(" "),r("div",[t._v("文件预览时间和大小、网络相关，请耐心等待")]),t._v(" "),r("div",[t._v("表格上传完毕，需要进一步对表格进行解析、转换，请耐心等待")])])])}],a=r("ed09"),i=r("2ef0"),c=r("5c96"),u=r("7f969"),l=r("4ca8"),s=r("141b"),f=r("3da5"),p=r("c623"),h=r("4066"),d=r("e148"),v=r("71a3");function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function m(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */m=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(T){u=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var a=e&&e.prototype instanceof p?e:p,i=Object.create(a.prototype),c=new E(o||[]);return n(i,"_invoke",{value:j(t,r,c)}),i}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(T){return{type:"throw",arg:T}}}t.wrap=l;var f={};function p(){}function h(){}function d(){}var v={};u(v,a,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(S([])));b&&b!==e&&r.call(b,a)&&(v=b);var w=d.prototype=p.prototype=Object.create(v);function O(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function o(n,a,i,c){var u=s(t[n],t,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==y(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,i,c)}),(function(t){o("throw",t,i,c)})):e.resolve(f).then((function(t){l.value=t,i(l)}),(function(t){return o("throw",t,i,c)}))}c(u.arg)}var a;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return a=a?a.then(n,n):n()}})}function j(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return P()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var c=_(i,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function _(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function S(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=d,n(w,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:h,configurable:!0}),h.displayName=u(d,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},O(x.prototype),u(x.prototype,i,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new x(l(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},O(w),u(w,c,"Generator"),u(w,a,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=S,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;k(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:S(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function g(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(l){return void r(l)}c.done?e(u):Promise.resolve(u).then(n,o)}function b(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){g(a,n,o,i,c,"next",t)}function c(t){g(a,n,o,i,c,"throw",t)}i(void 0)}))}}function w(t){return _(t)||j(t)||x(t)||O()}function O(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(t,e){if(t){if("string"===typeof t)return L(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(t,e):void 0}}function j(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _(t){if(Array.isArray(t))return L(t)}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function k(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function E(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?k(Object(r),!0).forEach((function(e){S(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function S(t,e,r){return e=P(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function P(t){var e=T(t,"string");return"symbol"===y(e)?e:String(e)}function T(t,e){if("object"!==y(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var I=Object(f["annotationBy"])("code"),F=r("df7c"),C=12,A={name:"TableImport",components:{Uploader:h["default"],Previewer:d["default"],UploadInline:u["a"],Result:v["default"]},setup:function(t,e){var r=e.root,n=r.$route,o=r.$router,u=n.params,h=void 0===u?{}:u,d=h.datasetId,v=h.annotateType,y=Object(a["o"])(null),g=Object(a["o"])(null),O=[{name:"csv",icon:"dataset-csv"},{name:"xlsx",icon:"dataset-xlsx"}],x=[{fileType:{required:!0,message:"请选择文件类型",trigger:"change"},file:{required:!0,message:"请选择文件",trigger:"change"}}],j=Object(a["n"])({active:0,form:{fileType:"csv",file:null,excludeHeader:!0},columns:[],data:[],checkList:[],loading:!1,error:null,datasetInfo:{}}),_=Object(a["a"])((function(){return x[j.active]})),L=Object(a["a"])((function(){return j.columns.length>C})),k=Object(a["a"])((function(){return{objectPath:"dataset/".concat(d,"/origin")}})),S=function(t){return Object.assign(j,t)},P=function(t){return S({form:E(E({},j.form),t)})},T=function(t){y.value.validateField(t)},A=function(){P({file:null}),S({active:0,data:[],columns:[]})},N=function(){0!==j.checkList.length?(S({loading:!0}),g.value.uploadByFile(j.form.file)):c["Message"].warning("至少选择一列")},G=function(t){var e=Object(f["getFileFromMinIO"])(t)[0].url,r={datasetId:d,fileName:F.basename(e.slice(0,e.indexOf("?")>-1?e.indexOf("?"):e.length)),filePath:e,excludeHeader:j.form.excludeHeader,mergeColumn:j.checkList.map((function(t){return j.columns.findIndex((function(e){return e===t}))}))};Object(p["h"])(r).then((function(){S({active:2})})).finally((function(){S({loading:!1})}))},D=function(t){S({loading:!1}),c["Message"].error(t.message||"上传文件失败")},R=function(t){S({checkList:t})},B=function(t,e){S({loading:!0});var r="csv"===e?l["csvReader"]:l["xlsReader"];r(t).then((function(t){var e=t.data,r=t.columns;S({active:1,columns:r,data:e})})).finally((function(){S({loading:!1})}))},$=function(){var t=I(v,"urlPrefix");o.replace({path:"/data/datasets/".concat(t,"/").concat(d)})},U=function(t){S({datasetInfo:t})},M=Object(a["a"])((function(){return Object(i["uniq"])(j.columns).map((function(t){return{prop:t,label:t}}))})),H=Object(a["a"])((function(){return 2!==j.active||Object(f["isStatus"])(j.datasetInfo,"IMPORTING")?"process":"success"})),Y=Object(a["a"])((function(){var t=j.data.slice(0,10).map((function(t){return Object(i["zipObject"])(j.columns,t)})),e=Object(i["zipObject"])(j.columns,["预览数 ".concat(Math.min(j.data.length,10)," / 总行数 ").concat(j.data.length)]);return[].concat(w(t),[e])}));return Object(a["k"])(b(m().mark((function t(){var e;return m().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(d){t.next=3;break}throw o.push({path:"/data/datasets"}),new Error("数据不合法");case 3:return t.prev=3,t.next=6,Object(s["g"])(d);case 6:e=t.sent,Object.assign(j,{datasetInfo:e}),t.next=14;break;case 10:return t.prev=10,t.t0=t["catch"](3),Object.assign(j,{error:new Error("当前数据集不存在，请重新输入"),pageLoading:!1}),t.abrupt("return");case 14:if(j.datasetInfo.dataType===f["dataTypeCodeMap"].TABLE){t.next=17;break}throw o.push({path:"/data/datasets"}),new Error("不支持该标注类型");case 17:case"end":return t.stop()}}),t,null,[[3,10]])})))),{state:j,rules:_,prev:A,uploadFile:N,uploadParams:k,uploadSuccess:G,uploadError:D,handleCheckChange:R,datasetId:d,fileTypeList:O,validateField:T,setForm:P,setState:S,handlePreview:B,tableForm:y,columns:M,tableData:Y,uploadRef:g,processStatus:H,directTo:$,showFilter:L,finish:U}}},N=A,G=(r("d302"),r("4781"),r("2877")),D=Object(G["a"])(N,n,o,!1,null,"4d2816ef",null);e["default"]=D.exports}}]);