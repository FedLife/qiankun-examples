(window["webpackJsonp_dubhe_web"]=window["webpackJsonp_dubhe_web"]||[]).push([["cloudServing-components-forms-batchUploadDialog"],{5346:function(e,t,n){"use strict";n("986a")},"986a":function(e,t,n){},c83b:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("BaseModal",{staticClass:"upload-dialog",attrs:{title:"上传文件",visible:e.visible,width:"600px"},on:{"update:visible":function(t){e.visible=t},close:e.onClose},scopedSlots:e._u([{key:"footer",fn:function(){return[n("div",[n("el-button",{on:{click:e.onClickCancel}},[e._v("取消")]),e._v(" "),n("el-button",{attrs:{type:"primary",loading:e.uploading},on:{click:e.onClickConfirm}},[e._v(e._s(e.confirmText))])],1)]},proxy:!0}])},[n("el-steps",{attrs:{active:e.activeStep,"align-center":"","finish-status":"success"}},[n("el-step",{attrs:{title:"选择文件"}}),e._v(" "),n("el-step",{attrs:{title:"上传文件",status:e.uploadStatus}})],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:0===e.activeStep,expression:"activeStep === 0"}]},[n("UploadInline",e._b({ref:"upload",attrs:{"before-remove":e.onBeforeRemove},on:{fileChange:e.onFileChange,uploadError:e.onUploadError}},"UploadInline",e.$attrs,!1))],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:1===e.activeStep,expression:"activeStep === 1"}]},[n("el-progress",{staticClass:"progress",attrs:{type:"circle",status:e.uploadStatus,percentage:e.uploadPercent}})],1)],1)},i=[],r=n("5c96"),a=n("ed09"),l=n("ed08"),c=n("f109"),s=n("7f969");function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t=v(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){var t=d(e,"string");return"symbol"===u(t)?t:String(t)}function d(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==u(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var m={name:"BatchUploadDialog",components:{BaseModal:c["a"],UploadInline:s["a"]},setup:function(e,t){var n={activeStep:0,uploadPercent:0,uploadStatus:void 0,uploading:!1,visible:!1,fileList:[],errFileList:[]},o=Object(a["n"])(f({},n)),i=Object(a["o"])(null),c=function(e,t){o.fileList=t},s=function(){r["Message"].error("上传失败"),o.uploading=!1},u=function(e,t){return t.includes(e)},p=function(){o.visible=!1,i.value.formRef.cancelUpload()},b=0,v=0,d=function(){if(v===o.fileList.length)return o.uploadStatus="success",r["Message"].success("上传成功"),o.uploading=!1,void t.emit("upload-success");o.errFileList.length&&o.errFileList.length+v===o.fileList.length&&(o.uploadStatus="exception",r["Message"].error("文件 ".concat(o.errFileList.map((function(e){return e.name})).join("、")," 上传错误")),o.uploading=!1)},m=function(){var e=b;switch(o.activeStep){case 0:v=0,o.errFileList=[],i.value.uploadSubmit((function(t,n){if(e===b){v=t;var i=Object(l["Qb"])(t/n.length);o.uploadPercent=i>100?100:i,d()}}),(function(t){e===b&&(o.errFileList.push(t),d())})),o.activeStep=1,o.uploading=!0;break;case 1:default:o.visible=!1;break}},g=Object(a["a"])((function(){return 0===o.activeStep?"下一步":"完成"})),y=function(){i.value.formRef.reset(),setTimeout((function(){Object.assign(o,Object(a["n"])(f({},n))),b+=1}))},h=function(){t.emit("close"),y()},S=function(){o.visible=!1},w=function(){o.visible=!0};return f(f({},Object(a["q"])(o)),{},{upload:i,onFileChange:c,onUploadError:s,onBeforeRemove:u,onClickCancel:p,onClickConfirm:m,confirmText:g,onClose:h,onCancel:S,show:w})}},g=m,y=(n("5346"),n("2877")),h=Object(y["a"])(g,o,i,!1,null,"df52fbbc",null);t["default"]=h.exports}}]);