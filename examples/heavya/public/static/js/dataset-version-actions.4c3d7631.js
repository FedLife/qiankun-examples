(window["webpackJsonp_dubhe_web"]=window["webpackJsonp_dubhe_web"]||[]).push([["dataset-version-actions"],{"16ad":function(t,e,n){"use strict";n("27de")},"27de":function(t,e,n){},"84a9":function(t,e,n){"use strict";n("ed59")},b55a:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"info-table-action-cell"},[t.isCurrent?t._e():n("el-button",{attrs:{type:"text"},on:{click:t.setCurrent}},[t._v("设置为当前版本")]),t._v(" "),n("el-popover",{attrs:{placement:"top",width:"200",trigger:"click"}},[n("div",[n("TableTooltip",{attrs:{keys:t.labels,title:t.title,data:t.list,keyAccessor:t.keyAccessor,valueAccessor:t.valueAccessor}})],1),t._v(" "),n("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("详情")])],1),t._v(" "),t.isCurrent&&!t.publishing?n("el-button",{attrs:{type:"text"},on:{click:t.gotoDetail}},[t._v("\n    "+t._s(t.isCustom?"查看文件":"查看标注")+"\n  ")]):t._e(),t._v(" "),n("el-dropdown",{attrs:{placement:"bottom"}},[n("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text"},on:{click:function(t){t.stopPropagation()}}},[t._v("\n      更多"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.isCurrent?t._e():n("el-dropdown-item",{nativeOn:{click:function(e){return t.deleteItem(e)}}},[n("el-button",{attrs:{type:"text"}},[t._v("删除")])],1),t._v(" "),n("el-dropdown-item",{directives:[{name:"click-once",rawName:"v-click-once"}],attrs:{disabled:t.publishing},nativeOn:{click:function(e){return t.download(t.row)}}},[t.publishing?n("el-tooltip",{attrs:{content:"文件生成中，请稍后",placement:"top","open-delay":400}},[n("el-button",{staticClass:"disabled-button",attrs:{type:"text"}},[t._v("\n            导出\n          ")])],1):n("el-button",{attrs:{type:"text"}},[t._v("\n          导出\n        ")])],1)],1)],1)],1)},a=[],r=n("ed09"),s=n("5c96"),c=n("ed08"),i=n("3da5"),u=n("141b"),l=n("d294"),d=Object(i["annotationBy"])("code"),f={name:"Actions",components:{TableTooltip:l["b"]},props:{row:{type:Object,default:function(){return{}}},actions:Object,showConvert:Function},setup:function(t,e){var n=t.actions,o=t.showConvert,a=e.root.$router,l=Object(r["a"])((function(){return Object(i["isPublishDataset"])(t.row)})),f=Object(r["a"])((function(){return!!t.row.isCurrent})),p=Object(r["a"])((function(){return t.row.presetFlag&&t.row.dataType!==i["dataTypeCodeMap"].CUSTOM})),b=Object(r["a"])((function(){return["NOT_CONVERTED","CONVERT_FAILED"].includes(i["conversionStateMap"][t.row.dataConversion])})),v=Object(r["a"])((function(){return t.row.isOfRecord&&"CONVERTING"===i["conversionStateMap"][t.row.dataConversion]})),w=Object(r["a"])((function(){return Object(i["isCustomDataset"])(t.row)})),O=Object(r["a"])((function(){return"".concat(t.row.name,"(").concat(t.row.versionName,")")})),m=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.finished,n=t.unfinished,o=t.autoFinished,a=t.finishAutoTrack,r=e+o+a;if(0===r)return 0;var s=r+n;return"".concat(Object(c["Qb"])(r/s),"%")},h=t.row.progressVO?m(t.row.progressVO):"--",C={status:{label:"状       态",value:i["datasetStatusMap"][t.row.status].name},fileCount:{label:"文件数量",value:t.row.fileCount},progressVO:{label:"标注进度",value:h}},_=function(){var e=t.row.annotateType;if(Object(i["isCustomDataset"])(t.row)){var n=d(i["annotationMap"].Custom.code,"urlPrefix");return a.push({path:"/data/datasets/".concat(n,"/").concat(t.row.datasetId)}),!1}var o=d(e,"urlPrefix");return a.push({path:"/data/datasets/".concat(o,"/").concat(t.row.datasetId)}),!1},g=function(){Object(u["A"])({datasetId:t.row.datasetId,versionName:t.row.versionName}).then((function(){n.refresh(),s["Message"].success("切换版本成功")}))},j=function(){s["MessageBox"].confirm("是否要删除此版本?","请确认",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){Object(u["f"])({datasetId:t.row.datasetId,versionName:t.row.versionName}).then((function(){n.refresh(),s["Message"].success("删除版本成功")}))}))},y=function(t){var e="dataset/".concat(t.datasetId,"/versionFile/").concat(t.versionName);return Object(c["G"])(e,"".concat(t.datasetId,"_").concat(t.versionName,".zip"),{fileName:function(t){return t.name.replace("".concat(e,"/"),"")},filter:function(n){return Object(i["isCustomDataset"])(t)?n:["COCO","YOLO"].includes(t.format)?n.filter((function(n){return n.name.startsWith("".concat(e,"/").concat(t.format))})):n.filter((function(t){return["annotation","origin"].some((function(n){return t.name.startsWith("".concat(e,"/").concat(n))}))}))}})},N=function(t){return o(t)},k=function(){Object(u["j"])({datasetId:t.row.datasetId,versionName:t.row.versionName}).then((function(){n.refresh(),s["Message"].success("开始生成OFRecord")}))},I=function(){Object(u["y"])(t.row.datasetId,t.row.versionName).then((function(){n.refresh(),s["Message"].success("已停止OFRecord转换")}))},T=function(t,e,n){return n[t].value||"--"},x=function(t,e,n){return n[t].label};return{publishing:l,isCurrent:f,isPreset:p,isCustom:w,canGenerate:b,isGenerating:v,title:O,labels:Object.keys(C),list:C,gotoDetail:_,deleteItem:j,setCurrent:g,convert:N,keyAccessor:x,valueAccessor:T,download:y,onGenerateOfRecord:k,stopGenerateOfRecord:I,showOfRecord:i["showOfRecord"]}}},p=f,b=(n("16ad"),n("84a9"),n("2877")),v=Object(b["a"])(p,o,a,!1,null,"70abd514",null);e["default"]=v.exports},ed59:function(t,e,n){}}]);